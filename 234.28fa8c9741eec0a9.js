"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[234,775],{29117:(e,n,t)=>{t.d(n,{Z:()=>w});var a=t(31461),o=t(47746),s=t(86432),l=t(92794),i=t(66198),r=t(79536),c=t(82799),u=t(10618),p=t(26578),d=t(29432),h=t(52903);const Z=["value","totals","onChange"],g=(0,u.X)([...c.yd]);function w(e){let{value:n,totals:t,onChange:u}=e,w=(0,a.Z)(e,Z);const f=(0,o.Z)(),m=!(0,s.Z)(f.breakpoints.up("sm"));return(0,h.tZ)(d.Z,Object.assign({exclusive:!0,value:n},w,{children:c.yd.map((e=>{var a;return(0,h.BX)(l.Z,{value:e,sx:{p:m?1:void 0,minWidth:m?0:"7em",display:"flex",gap:m?0:1},onClick:()=>u(g(n,e)),children:[(0,h.tZ)(p.Z,{src:null==(a=r.Z.weaponTypes)?void 0:a[e],size:2,sideMargin:!0}),(0,h.tZ)(i.Z,{label:t[e],size:"small"})]},e)}))}))}},61523:(e,n,t)=>{t.r(n),t.d(n,{default:()=>M});var a=t(82799),o=t(92252),s=t(67550),l=t(7671),i=t(30609),r=t(5896),c=t(79906),u=t(83249),p=t(41075),d=t(62197),h=t(2784),Z=t(61877),g=t(21548),w=t(87985),f=t(46026),m=t(62978),y=t(29117),x=t(51077),v=t(25870),b=t(36617),W=t(82716),C=t(1661),I=t(40775),k=t(41015),S=t(77712),P=t(64120),E=t(3694),T=t(52903);const X=h.lazy((()=>t.e(592).then(t.bind(t,89431)))),B=(0,h.lazy)((()=>Promise.all([t.e(878),t.e(334)]).then(t.bind(t,15878)))),$={xs:1,sm:2,md:3,lg:3,xl:4},z={xs:10,sm:12,md:24,lg:24,xl:24},j=Object.keys(S.gd);function M(){const{t:e}=(0,g.$G)(["page_weapon","ui","weaponNames_gen"]),{database:n}=(0,h.useContext)(v.t),[t,d]=(0,h.useState)(n.displayWeapon.get());(0,h.useEffect)((()=>n.displayWeapon.follow(((e,n)=>d(n)))),[n]);const[M,O]=(0,h.useState)(!1),[D,_]=(0,b.Z)(),G=(0,h.useRef)(null),[A,H]=(0,h.useState)(0);(0,h.useEffect)((()=>(Z.ZP.send({hitType:"pageview",page:"/weapon"}),n.weapons.followAny(((e,n)=>("new"===n||"remove"===n)&&_())))),[_,n]);const K=(0,W.Z)(),L=z[K],V=(0,h.useCallback)((async a=>{const o=n.weapons.get(a);if(!o)return;const s=e(`weaponNames_gen:${o.key}`);window.confirm(e("removeWeapon",{value:s}))&&(n.weapons.remove(a),t.editWeaponId===a&&n.displayWeapon.set({editWeaponId:""}))}),[t.editWeaponId,n,e]),q=(0,h.useCallback)((e=>{n.displayWeapon.set({editWeaponId:e})}),[n]),F=(0,h.useCallback)((e=>{q(n.weapons.new((0,P.xg)(e)))}),[n,q]),[R,J]=(0,h.useState)(""),Q=(0,h.useDeferredValue)(R),{sortType:U,ascending:Y,weaponType:ee,rarity:ne}=t,{weaponIdList:te,totalWeaponNum:ae}=(0,h.useMemo)((()=>{var e;const t=n.weapons.values,a=t.length,o=t.filter((0,C.C)({weaponType:ee,rarity:ne,name:Q},(0,S.Xg)())).sort((0,C.e)(null!=(e=S.gd[U])?e:[],Y,(0,S.Sn)())).map((e=>e.id));return D&&{weaponIdList:o,totalWeaponNum:a}}),[D,n,U,Y,ne,ee,Q]),{weaponIdsToShow:oe,numPages:se,currentPageIndex:le}=(0,h.useMemo)((()=>{const e=Math.ceil(te.length/L),n=(0,k.uZ)(A,0,e-1);return{weaponIdsToShow:te.slice(n*L,(n+1)*L),numPages:e,currentPageIndex:n}}),[te,A,L]),ie=te.length!==ae?`${te.length}/${ae}`:`${ae}`,re=(0,h.useCallback)(((e,n)=>{var t;null==(t=G.current)||t.scrollIntoView({behavior:"smooth"}),H(n-1)}),[H,G]),ce=(0,h.useCallback)((()=>n.displayWeapon.set({editWeaponId:""})),[n]),{editWeaponId:ue}=t;(0,h.useEffect)((()=>{ue&&(n.weapons.get(ue)||ce())}),[n,ue,ce]);const pe=(0,h.useMemo)((()=>(0,I.W)(a.yd,(e=>Object.entries(n.weapons.data).forEach((([n,t])=>{const a=(0,x.ub)(t.key).weaponType;e[a].total++,te.includes(n)&&e[a].current++}))))),[n,te]),de=(0,h.useMemo)((()=>(0,I.W)(a.wC,(e=>Object.entries(n.weapons.data).forEach((([n,t])=>{const a=(0,x.ub)(t.key).rarity;e[a].total++,te.includes(n)&&e[a].current++}))))),[n,te]);return(0,T.BX)(s.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,T.tZ)(h.Suspense,{fallback:!1,children:(0,T.tZ)(X,{show:M,onHide:()=>O(!1),onSelect:F})}),(0,T.tZ)(h.Suspense,{fallback:!1,children:(0,T.tZ)(B,{weaponId:ue,footer:!0,onClose:ce})}),(0,T.tZ)(w.Z,{ref:G,children:(0,T.BX)(l.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,T.BX)(s.Z,{display:"flex",flexWrap:"wrap",gap:1,alignItems:"stretch",children:[(0,T.tZ)(y.Z,{onChange:e=>n.displayWeapon.set({weaponType:e}),value:ee,totals:pe,size:"small"}),(0,T.tZ)(m.Z,{sx:{height:"100%"},onChange:e=>n.displayWeapon.set({rarity:e}),value:ne,totals:de,size:"small"}),(0,T.tZ)(s.Z,{flexGrow:1}),(0,T.tZ)(i.Z,{autoFocus:!0,size:"small",value:R,onChange:e=>J(e.target.value),label:e("weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})]}),(0,T.BX)(s.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:[(0,T.tZ)(r.Z,{count:se,page:le+1,onChange:re}),(0,T.tZ)(N,{numShowing:oe.length,total:ie,t:e}),(0,T.tZ)(f.Z,{sx:{height:"100%"},sortKeys:j,value:U,onChange:e=>n.displayWeapon.set({sortType:e}),ascending:Y,onChangeAsc:e=>n.displayWeapon.set({ascending:e})})]})]})}),(0,T.BX)(h.Suspense,{fallback:(0,T.tZ)(c.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:500}}),children:[(0,T.tZ)(u.Z,{fullWidth:!0,onClick:()=>O(!0),color:"info",startIcon:(0,T.tZ)(o.Z,{}),children:e("page_weapon:addWeapon")}),(0,T.tZ)(p.ZP,{container:!0,spacing:1,columns:$,children:oe.map((e=>(0,T.tZ)(p.ZP,{item:!0,xs:1,children:(0,T.tZ)(E.Z,{weaponId:e,onDelete:V,onEdit:q,canEquip:!0})},e)))})]}),se>1&&(0,T.tZ)(w.Z,{children:(0,T.tZ)(l.Z,{children:(0,T.BX)(p.ZP,{container:!0,alignItems:"flex-end",children:[(0,T.tZ)(p.ZP,{item:!0,flexGrow:1,children:(0,T.tZ)(r.Z,{count:se,page:le+1,onChange:re})}),(0,T.tZ)(p.ZP,{item:!0,children:(0,T.tZ)(N,{numShowing:oe.length,total:ie,t:e})})]})})})]})}function N({numShowing:e,total:n,t}){return(0,T.tZ)(d.Z,{color:"text.secondary",children:(0,T.BX)(g.cC,{t,i18nKey:"showingNum",count:e,value:n,children:["Showing ",(0,T.tZ)("b",{children:{count:e}})," out of ",{value:n}," Weapons"]})})}},94758:(e,n,t)=>{t.d(n,{Z:()=>s});var a=t(2784),o=t(25870);function s(e=""){const{database:n}=(0,a.useContext)(o.t),[t,s]=(0,a.useState)(n.weapons.get(e));return(0,a.useEffect)((()=>s(n.weapons.get(e))),[n,e]),(0,a.useEffect)((()=>e?n.weapons.follow(e,((e,n,t)=>"update"===n&&s(t))):void 0),[e,s,n]),t}},40775:(e,n,t)=>{t.d(n,{W:()=>o});var a=t(41015);function o(e,n){const t=function(e){return Object.fromEntries(e.map((e=>[e,{total:0,current:0}])))}(e);return n(t),o=t,(0,a.xh)(o,(({total:e,current:n})=>n===e?`${e}`:`${n}/${e}`));var o}}}]);