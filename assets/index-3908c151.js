import{Q as K,e as i,n as a,J as n,p as t,T as w,B as A,t as C,C as m,D as R,U as P,V as Y,r as Z,i as tt,j as et,u as _,b as j,N as k,_ as W,W as xt,s as rt,X as it,K as L,Y as At,Z as wt,$ as vt,M as kt,R as at}from"./index-050b8351.js";import{u as Dt,f as St,s as Ct,a as _t,S as It}from"./StarDisplay-24c36f84.js";import{d as nt,A as ot,a as Et,b as Pt,p as Tt,c as Ft,e as X}from"./ArtifactSort-b3b6e5a4.js";import{S as Mt,A as $t}from"./StatEditorList-20060650.js";import{d as Rt}from"./InfoTooltip-ad718e9f.js";import{C as O}from"./CloseButton-37f39a56.js";import{T as jt}from"./index-b6f77b95.js";import{u as st}from"./useDisplayArtifact-633cae52.js";import{d as qt,a as Ut}from"./LockOpen-b2aad357.js";import{S as $}from"./SqBadge-95817798.js";import{C as Kt}from"./ColoredText-e9daa927.js";import{A as Lt}from"./ConditionalWrapper-1a66eb87.js";import"./DropdownButton-112cbcd0.js";import"./BootstrapTooltip-34cc7f5b.js";import"./SlotIcon-0d56b383.js";import"./index-0adaa94b.js";import"./Artifact-d1888bee.js";import"./CardActionArea-7a036940.js";import"./Link-29d41022.js";const Ot=r=>r[Math.floor(Math.random()*r.length)];function Wt({pageKey:r,text:e="",modalTitle:o="",children:u}){const[f,h,c]=K(localStorage.getItem(`infoShown_${r}`)!=="true"),[d]=i.useState(Array.isArray(e)?Ot(e):e),y=i.useCallback(()=>{c(),localStorage.setItem(`infoShown_${r}`,"true")},[c,r]);return a(C,{children:[a(n,{container:!0,children:[t(n,{item:!0,flexGrow:1,children:t(w,{variant:"caption",pl:1,children:d})}),t(n,{item:!0,xs:"auto",children:t(A,{size:"small",color:"info",variant:"contained",onClick:h,startIcon:t(Rt,{}),children:t(jt,{ns:"ui",key18:"info"})})})]}),t(Y,{containerProps:{maxWidth:"xl"},open:f,onClose:y,children:a(C,{children:[t(m,{sx:{py:1},children:a(n,{container:!0,children:[t(n,{item:!0,flexGrow:1,children:t(w,{variant:"h6",children:o})}),t(n,{item:!0,children:t(O,{onClick:y})})]})}),t(R,{}),t(m,{children:t(i.Suspense,{fallback:t(P,{variant:"rectangular",width:"100%",height:500}),children:u})}),t(R,{}),t(m,{sx:{py:1},children:t(O,{large:!0,onClick:y})})]})})]})}var B={},Bt=tt;Object.defineProperty(B,"__esModule",{value:!0});var lt=B.default=void 0,Vt=Bt(Z()),zt=et,Gt=(0,Vt.default)((0,zt.jsx)("path",{d:"M8.65 5.82C9.36 4.72 10.6 4 12 4c2.21 0 4 1.79 4 4 0 1.4-.72 2.64-1.82 3.35L8.65 5.82zM20 17.17c-.02-1.1-.63-2.11-1.61-2.62-.54-.28-1.13-.54-1.77-.76L20 17.17zm1.19 4.02L2.81 2.81 1.39 4.22l8.89 8.89c-1.81.23-3.39.79-4.67 1.45-1 .51-1.61 1.54-1.61 2.66V20h13.17l2.61 2.61 1.41-1.42z"}),"PersonOff");lt=B.default=Gt;var V={},Ht=tt;Object.defineProperty(V,"__esModule",{value:!0});var ct=V.default=void 0,Nt=Ht(Z()),Qt=et,Xt=(0,Nt.default)((0,Qt.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");ct=V.default=Xt;const Jt=i.lazy(()=>W(()=>import("./ArtifactFilterDisplay-d2f8670b.js").then(r=>r.b),["./ArtifactFilterDisplay-d2f8670b.js","./index-050b8351.js","./index-d7411632.css","./LockOpen-b2aad357.js","./useDisplayArtifact-633cae52.js","./SolidToggleButtonGroup-9906ee1b.js","./totalUtils-5d7bb2b1.js","./BootstrapTooltip-34cc7f5b.js","./StarDisplay-24c36f84.js","./DropdownButton-112cbcd0.js","./ColoredText-e9daa927.js","./index-b6f77b95.js","./SqBadge-95817798.js","./ArtifactStatKeyDisplay-0f2c808b.js","./Artifact-d1888bee.js","./ConditionalWrapper-1a66eb87.js","./index-0adaa94b.js","./SlotIcon-0d56b383.js"],import.meta.url));function Yt({numShowing:r,total:e,artifactIds:o}){const{t:u}=_(["artifact","ui"]),f=j(),{filterOption:h}=st(),c=i.useCallback(d=>f.displayArtifact.set({filterOption:{...h,...d}}),[f,h]);return t(i.Suspense,{fallback:t(P,{variant:"rectangular",width:"100%",height:300}),children:t(C,{children:a(m,{children:[a(n,{container:!0,children:[t(n,{item:!0,children:t(w,{variant:"h6",children:t(k,{t:u,i18nKey:"artifactFilter",children:"Artifact Filter"})})}),t(n,{item:!0,flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",children:r!==e&&a(w,{children:["Filtered ",t("strong",{children:r})," / ",e]})}),t(n,{item:!0,children:t(A,{size:"small",color:"error",onClick:()=>f.displayArtifact.set({action:"reset"}),startIcon:t(ct,{}),children:t(k,{t:u,i18nKey:"ui:reset"})})})]}),t(i.Suspense,{fallback:t(P,{variant:"rectangular",width:"100%",height:200}),children:t(Jt,{filterOption:h,filterOptionDispatch:c,filteredIds:o})})]})})})}function Zt({artifactIds:r}){const{t:e}=_(["artifact","ui"]),o=j(),{numDelete:u,numUnequip:f,numUnlock:h,numLock:c}=i.useMemo(()=>{const l=r.map(x=>o.arts.get(x)),p=l.reduce((x,S)=>x+(S.lock?0:1),0),b=l.length-p,v=p,q=l.reduce((x,S)=>x+(S.location?1:0),0);return{numDelete:v,numUnequip:q,numUnlock:p,numLock:b}},[r,o]);return a(n,{container:!0,spacing:1,alignItems:"center",children:[t(n,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!f,onClick:()=>window.confirm(`Are you sure you want to unequip ${f} artifacts currently equipped on characters?`)&&r.map(l=>o.arts.set(l,{location:""})),startIcon:t(lt,{}),children:[t(k,{t:e,i18nKey:"button.unequipArtifacts",children:"Unequip Artifacts"}),t($,{sx:{ml:1},color:f?"success":"secondary",children:f})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!u,onClick:()=>window.confirm(`Are you sure you want to delete ${u} artifacts?`)&&r.map(l=>{var p;return!((p=o.arts.get(l))!=null&&p.lock)&&o.arts.remove(l)}),startIcon:t(xt,{}),children:[t(k,{t:e,i18nKey:"button.deleteArtifacts",children:"Delete Artifacts"}),t($,{sx:{ml:1},color:u?"success":"secondary",children:u})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!c,onClick:()=>window.confirm(`Are you sure you want to unlock ${c} artifacts?`)&&r.map(l=>o.arts.set(l,{lock:!1})),startIcon:t(qt,{}),children:[t(k,{t:e,i18nKey:"button.unlockrtifacts",children:"Unlock Artifacts"}),t($,{sx:{ml:1},color:c?"success":"secondary",children:c})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!h,onClick:()=>window.confirm(`Are you sure you want to lock ${h} artifacts?`)&&r.map(l=>o.arts.set(l,{lock:!0})),startIcon:t(Ut,{}),children:[t(k,{t:e,i18nKey:"button.lockArtifacts",children:"Lock Artifacts"}),t($,{sx:{ml:1},color:h?"success":"secondary",children:h})]})}),t(n,{item:!0,xs:12,display:"flex",justifyContent:"space-around",children:t(w,{variant:"caption",color:"text.secondary",children:a(k,{t:e,i18nKey:"buttonHint",children:["Note: the red buttons above only apply to",t("b",{children:"currently filtered artifacts"})]})})})]})}function te({show:r,onHide:e}){const{t:o}=_("artifact");return t(Y,{open:r,onClose:e,children:a(rt,{children:[a(m,{sx:{display:"flex",alignItems:"center"},children:[a(w,{variant:"h6",flexGrow:1,children:[t(nt,{sx:{verticalAlign:"text-top",mr:1}}),o`showDup`]}),t(O,{onClick:e})]}),t(R,{}),t(m,{children:t(ee,{})})]})})}function ee(){const{t:r}=_("artifact"),e=j(),[o,u]=it();i.useEffect(()=>e.arts.followAny(u),[u,e]);const f=i.useMemo(()=>{const c=o&&[];let d=e.arts.keys;for(;d.length!==0;){const y=d.shift();if(!y)continue;const I=e.arts.get(y);if(!I)continue;const{duplicated:D}=e.arts.findDups(I,d);if(!D.length)continue;const l=D.map(p=>p.id);c.push([y,...l].sort(p=>{var b;return((b=e.arts.get(p))==null?void 0:b.location)??""?-1:1})),d=d.filter(p=>!l.includes(p))}return c},[e,o]),h=i.useMemo(()=>({}),[]);return a(wt,{spacing:2,children:[f.map(c=>t(C,{sx:{overflowX:"scroll"},children:t(m,{sx:{display:"flex",gap:1},children:c.map(d=>t(L,{sx:{minWidth:300},children:t(ot,{artifactId:d,canEquip:!0,onDelete:()=>e.arts.remove(d),editorProps:h})},d))})},c.join())),!f.length&&t(At,{variant:"filled",severity:"success",children:r`noDupAlert`})]})}const re=[...vt];function ie({probabilityFilter:r={},setProbabilityFilter:e,disabled:o=!1}){const{t:u}=_("artifact");return a(C,{children:[t(m,{sx:{py:1},children:t(w,{variant:"h6",children:"Roll Probability Calculator"})}),t(R,{}),t(m,{children:a(n,{container:!0,spacing:1,children:[t(n,{item:!0,xs:12,md:6,children:t(rt,{children:t(m,{children:a(w,{children:['This UI only pops up when "Sort by"',t("strong",{children:"Probability"}),". In conjunction with the Artifact Filters above, this UI allows you to set a criteria for substats values, and it will sort the artifacts by those with the highest probability to roll into those criteria values.",a(Kt,{color:"warning",children:[" ","Artifacts that already reach the criteria(100%) or are at 0% are hidden."]})]})})})}),t(n,{item:!0,xs:12,md:6,spacing:1,sx:{display:"flex",flexDirection:"column",gap:1},children:t(Mt,{statKeys:re,statFilters:r,setStatFilters:e,disabled:o,label:u("probabilityFilter.label")})})]})})]})}const ae=at.lazy(()=>W(()=>import("./ArtifactEditor-7013307e.js"),["./ArtifactEditor-7013307e.js","./index-050b8351.js","./index-d7411632.css","./ArtifactRarityDropdown-df851135.js","./index-0adaa94b.js","./index-b6f77b95.js","./ColoredText-e9daa927.js","./SqBadge-95817798.js","./ConditionalWrapper-1a66eb87.js","./StarDisplay-24c36f84.js","./DropdownButton-112cbcd0.js","./ArtifactStatKeyDisplay-0f2c808b.js","./Artifact-d1888bee.js","./InfoTooltip-ad718e9f.js","./BootstrapTooltip-34cc7f5b.js","./LockOpen-b2aad357.js","./SlotIcon-0d56b383.js","./CloseButton-37f39a56.js","./ArtifactSort-b3b6e5a4.js","./CardActionArea-7a036940.js","./TextButton-b044b056.js","./CardHeader-52f5a768.js","./ChevronRight-0f0ca745.js"],import.meta.url)),ne=at.lazy(()=>W(()=>import("./index-3c77dec7.js"),["./index-3c77dec7.js","./index-050b8351.js","./index-d7411632.css","./Settings-5bc004a6.js","./StarDisplay-24c36f84.js","./DropdownButton-112cbcd0.js","./ColoredText-e9daa927.js","./index-b6f77b95.js","./SqBadge-95817798.js","./ImgFullwidth-16fdb883.js","./ArtifactSort-b3b6e5a4.js","./ConditionalWrapper-1a66eb87.js","./BootstrapTooltip-34cc7f5b.js","./SlotIcon-0d56b383.js","./InfoTooltip-ad718e9f.js","./index-0adaa94b.js","./Artifact-d1888bee.js","./CardActionArea-7a036940.js","./Link-29d41022.js"],import.meta.url)),J={xs:1,sm:2,md:3,lg:3,xl:4},oe={xs:5,sm:6,md:12,lg:12,xl:12};function _e(){const{t:r}=_(["artifact","ui"]),e=j(),o=st(),[u,f,h]=K(!1),[c,d,y]=K(!1),I=Dt(),{sortType:D,effFilter:l,ascending:p,probabilityFilter:b}=o,v=D==="probability",[q,x]=it(),S=i.useDeferredValue(q),E=i.useMemo(()=>new Set(l),[l]),ut=i.useCallback(s=>e.arts.remove(s),[e]);i.useEffect(()=>(kt.send({hitType:"pageview",page:"/artifact"}),e.arts.followAny(()=>x())),[e,x]);const dt=i.useCallback(s=>e.displayArtifact.set({probabilityFilter:s}),[e]),ft=i.useMemo(()=>!e.arts.values.length,[e]),z=i.useMemo(()=>Et(E,b),[E,b]),G=i.useMemo(()=>Pt(E),[E]),H=i.useDeferredValue(o),N=i.useDeferredValue(b);i.useEffect(()=>{if(v)return e.arts.values.forEach(s=>e.arts.setProbability(s.id,Tt(s,N))),()=>e.arts.values.forEach(s=>e.arts.setProbability(s.id,-1))},[e,v,N]);const{artifactIds:g,totalArtNum:T}=i.useMemo(()=>{const{sortType:s=X[0],ascending:bt=!1,filterOption:gt}=H;let F=e.arts.values;return v&&(F=F.filter(M=>M.probability&&M.probability!==1)),{artifactIds:F.filter(St(gt,G)).sort(Ct(Ft[s]??[],bt,z)).map(M=>M.id),totalArtNum:F.length,...S}},[H,S,e,z,G,v]),{numShow:Q,setTriggerElement:ht}=_t(oe[I],g.length),U=i.useMemo(()=>g.slice(0,Q),[g,Q]),pt=g.length!==T?`${g.length}/${T}`:`${T}`,mt={numShowing:U.length,total:pt,t:r,namespace:"artifact"},yt={sortKeys:[...X],value:D,onChange:s=>e.displayArtifact.set({sortType:s}),ascending:p,onChangeAsc:s=>e.displayArtifact.set({ascending:s})};return a(L,{display:"flex",flexDirection:"column",gap:1,my:1,children:[t(i.Suspense,{fallback:!1,children:t(ae,{artifactIdToEdit:u?"new":"",cancelEdit:h,allowUpload:!0,allowEmpty:!0})}),t(i.Suspense,{fallback:!1,children:t(te,{show:c,onHide:y})}),t(Wt,{pageKey:"artifactPage",modalTitle:r`info.title`,text:r("tipsOfTheDay",{returnObjects:!0}),children:t(ne,{})}),ft&&t($t,{}),t(Yt,{numShowing:g.length,total:T,artifactIds:g}),t(C,{children:a(m,{children:[t(L,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(It,{showingTextProps:mt,sortByButtonProps:yt})}),t(Zt,{artifactIds:g})]})}),v&&t(ie,{probabilityFilter:b,setProbabilityFilter:dt}),a(n,{container:!0,columns:J,spacing:1,children:[t(n,{item:!0,xs:!0,children:t(A,{fullWidth:!0,onClick:f,color:"info",startIcon:t(Lt,{}),children:r`addNew`})}),t(n,{item:!0,xs:1,children:t(A,{fullWidth:!0,onClick:d,color:"info",startIcon:t(nt,{}),children:r`showDup`})})]}),a(i.Suspense,{fallback:t(P,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:[t(n,{container:!0,spacing:1,columns:J,children:U.map(s=>t(n,{item:!0,xs:1,children:t(ot,{artifactId:s,effFilter:E,onDelete:ut,editorProps:{},canEquip:!0})},s))}),g.length!==U.length&&t(P,{ref:s=>{s&&ht(s)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})]})}export{_e as default};
