import{r as p,x as E,d as e,e as n,ae as se,ay as Fe,a as W,y as F,bQ as ce,f as h,G as o,h as w,cn as Ne,co as Ke,c3 as ze,cp as Pe,W as be,cq as qe,bI as $e,as as he,Z as Ge,cr as ue,cs as Ve,ct as re,L as _,am as ie,an as Q,M as B,N as k,T as A,cu as He,c0 as R,cm as z,I as P,o as Z,cv as ve,aa as Je,cw as Ue,aj as M,at as le,ao as oe,ah as Te,cx as Qe,cy as Ze,P as Ye,cz as pe,cA as Xe,cB as et,az as tt,aN as Y,cC as at,cD as nt,bN as we,ch as rt,t as Ie,v as Se,w as Me,g as De,s as $,bJ as de,bK as st,b0 as ke,cj as ct,cE as me,cF as it,cG as lt,D as Ee,bZ as ge,z as ot,H as dt,cH as ht,cI as fe,bM as ut,S as q,i as pt,l as mt,cJ as gt,ca as ft,cK as xt,a6 as yt,aG as Ct,ac as bt,aw as vt,cL as Tt,aI as wt,aJ as It,b6 as ne,aK as St,cM as Mt,ba as Dt,cN as kt,cO as Et,bm as jt,aM as Wt,cP as Bt,cQ as At,cR as Lt,cS as je,F as Ot,E as Rt,b as _t,A as Ft,cT as Nt}from"./index-C49FwScc.js";import{u as Kt,B as We,a as Be,L as zt,b as Pt,T as qt,c as $t,C as Gt,d as Vt,e as Ht,f as Jt,E as Ut,g as xe}from"./LoadoutInfoAlert-B2yE2VUD.js";import{T as Ae}from"./TeamCard-B03jHRM8.js";import{u as Qt}from"./useTeamChar-BnvL0TJg.js";import{O as Zt,L as Yt}from"./TeamDelModal-BCSAu8BK.js";import"./artifactSortUtil-D560LMNv.js";function Xt(){const t=p.useRef(!0),r=t.current;return r&&(t.current=!1),r}function ea(){const{t}=E("page_character");return e(Fe,{severity:"warning",children:n(se,{t,i18nKey:"noLoadout",children:["Looks like you haven't added any loadout/Teams with this character yet. You need to create a loadout+team with this character to"," ",e("strong",{children:"create builds"}),", ",e("strong",{children:"theorycraft"}),", or"," ",e("strong",{children:"optimize"}),"."]})})}function ta(){const t=W(),r=F();return p.useCallback(a=>{t.chars.get(a)||t.chars.getWithInitWeapon(a),r(`/characters/${a}`)},[r,t])}function aa({buildId:t,characterKey:r}){const{name:s,description:a,weaponId:c,artifactIds:u}=Kt(t),d=ce(r).weaponType;return e(We,{name:s,description:a,hideFooter:!0,children:e(h,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch"},children:n(o,{container:!0,spacing:1,columns:{xs:2,sm:2,md:2,lg:3,xl:3},children:[e(o,{item:!0,xs:1,children:e(w,{sx:{height:"100%",maxHeight:"8em"},children:e(Ne,{weaponId:c,weaponTypeKey:d})})}),Object.entries(u).map(([g,y])=>e(o,{item:!0,xs:1,children:e(w,{sx:{height:"100%",maxHeight:"8em"},children:e(Ke,{artifactId:y,slotKey:g})})},y||g))]})})})}function na({buildTcId:t}){const r=Be(t),{name:s,description:a}=r;return e(We,{name:s,description:a,hideFooter:!0,children:e(ra,{buildTcId:t})})}function ra({buildTcId:t}){const{weapon:r,artifact:{slots:s,substats:{stats:a},sets:c}}=Be(t),u=ze(r.key),d=Object.entries(a),g=d.slice(0,5),y=d.slice(5);return e(h,{children:n(o,{container:!0,spacing:1,columns:{xs:2,sm:2,md:2,lg:2,xl:2},children:[e(o,{item:!0,xs:1,children:n(h,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(Pe,{weapon:r,weaponSheet:u}),!!Object.keys(c).length&&e(w,{sx:{flexGrow:1},children:e(h,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:Object.entries(c).map(([i,l])=>n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(be,{size:2,src:qe(i,"flower")}),e("span",{children:e($e,{setKey:i})}),n(he,{children:["x",l]})]},i))})})]})}),e(o,{item:!0,xs:1,children:e(w,{sx:{flexGrow:1,height:"100%",p:1,display:"flex",flexDirection:"column",gap:1,justifyContent:"space-between"},children:Object.entries(s).map(([i,{level:l,statKey:f}])=>n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Ge,{slotKey:i}),n(he,{children:["+",l]}),e(ue,{statKey:f})]},i))})}),[g,y].map((i,l)=>e(o,{item:!0,xs:1,children:e(w,{sx:{flexGrow:1,height:"100%"},children:e(h,{sx:{p:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",gap:1},children:i.map(([f,C])=>n(h,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[e(ue,{statKey:f}),n("span",{children:[Ve(C,re(f)),re(f)]})]},f))})})},l))]})})}function sa({show:t,onHide:r,teamCharId:s,onDelete:a,teamIds:c,conditionalCount:u}){const{t:d}=E("loadout"),g=W(),{name:y,description:i,buildIds:l,buildTcIds:f,customMultiTargets:C,bonusStats:T}=g.teamChars.get(s),I=p.useCallback(()=>{r(),a()},[a,r]);return e(oe,{open:t,onClose:r,containerProps:{maxWidth:"md"},children:n(w,{children:[e(_,{title:e("span",{children:n(se,{t:d,i18nKey:"loadoutDelModal.title",name:y,children:["Delete Loadout: ",e("strong",{children:{name:y}}),"?"]})}),action:e(ie,{onClick:r,children:e(Q,{})})}),e(B,{}),n(k,{children:[i&&e(w,{bgt:"dark",sx:{mb:2},children:e(k,{children:i})}),e(A,{children:d("loadoutDelModal.desc")}),n(He,{sx:{listStyleType:"disc",pl:4},children:[!!l.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.builds"),l.length," ",e(z,{title:e(h,{children:l.map(x=>{var v;return n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Z,{}),e("span",{children:(v=g.builds.get(x))==null?void 0:v.name})]},x)})}),children:e(P,{})})]})}),!!f.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.tcBuilds"),f.length," ",e(z,{title:e(h,{children:f.map(x=>{var v;return n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Z,{}),e("span",{children:(v=g.buildTcs.get(x))==null?void 0:v.name})]},x)})}),children:e(P,{})})]})}),!!C.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[d("loadoutDelModal.mTargets"),C.length," ",e(z,{title:e(h,{children:C.map((x,v)=>n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(ve,{}),e("span",{children:x.name})]},v))}),children:e(P,{})})]})}),!!Object.keys(T).length&&n(R,{sx:{display:"list-item"},children:[d("loadoutDelModal.bonus"),Object.keys(T).length]}),!!u&&n(R,{sx:{display:"list-item"},children:[d("loadoutDelModal.condi"),u]}),e(R,{sx:{display:"list-item"},children:d("loadoutDelModal.optConfig")}),!!c.length&&e(R,{sx:{display:"list-item"},children:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[n("span",{children:[d("loadoutDelModal.affected"),c.length]}),e(z,{title:e(h,{children:c.map(x=>{var v;return n(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(Je,{}),e("span",{children:(v=g.teams.get(x))==null?void 0:v.name})]},x)})}),children:e(P,{})})]})})]})]}),n(Ue,{sx:{float:"right"},children:[e(M,{startIcon:e(Q,{}),color:"secondary",onClick:r,children:d("loadoutDelModal.cancel")}),e(M,{startIcon:e(le,{}),color:"error",onClick:I,children:d("loadoutDelModal.delete")})]})]})})}function ca({show:t,onHide:r,teamCharId:s,teamIds:a}){const{t:c}=E("loadout"),[u,d,g]=Te(),y=F(),i=W(),{key:l,name:f,description:C,buildIds:T,buildTcIds:I,customMultiTargets:x,bonusStats:v,optConfigId:S,conditional:G}=Qt(s),{optimizationTarget:V}=Qe(S),X=()=>{r(),i.teamChars.remove(s)},ee=()=>{i.teamChars.duplicate(s)&&r()},te=b=>{const j=i.teams.new();i.teams.set(j,J=>{J.loadoutData[0]={teamCharId:b}}),y(`/teams/${j}`)},H=p.useMemo(()=>{let b=0;return Ze(G,[],j=>typeof j!="object",()=>b++),b},[G]);return e(oe,{open:t,onClose:r,containerProps:{maxWidth:"lg"},children:n(w,{children:[e(_,{title:n(h,{display:"flex",gap:1,alignItems:"center",children:[e(Ye,{}),e("strong",{children:f})]}),action:e(ie,{onClick:r,children:e(Q,{})})}),e(B,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(zt,{}),e(pe,{fullWidth:!0,label:c("loadoutEditor.label"),placeholder:c("loadoutEditor.placeholder"),value:f,onChange:b=>i.teamChars.set(s,{name:b})}),e(pe,{fullWidth:!0,label:c("loadoutEditor.desc"),value:C,onChange:b=>i.teamChars.set(s,{description:b}),multiline:!0,minRows:2}),e(h,{children:n(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:[e(o,{item:!0,xs:1,children:e(M,{color:"info",onClick:()=>ee(),fullWidth:!0,startIcon:e(Xe,{}),children:c("loadoutEditor.dupBtn")})}),n(o,{item:!0,xs:1,children:[e(sa,{show:u,onHide:g,onDelete:X,teamCharId:s,teamIds:a,conditionalCount:H}),e(M,{fullWidth:!0,startIcon:e(le,{}),color:"error",onClick:d,children:c("loadoutEditor.delBtn")})]})]})}),e(h,{children:n(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:[!!Object.keys(v).length&&e(o,{item:!0,xs:1,children:e(ia,{bonusStats:v})}),!!V&&e(o,{item:!0,xs:1,children:n(w,{bgt:"light",children:[e(_,{title:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(et,{}),e("span",{children:c("loadoutEditor.optTarget")})]})}),e(B,{}),e(k,{children:e(tt,{divider:e(B,{orientation:"vertical",flexItem:!0}),spacing:1,children:e(Zt,{optimizationTarget:V,customMultiTargets:x})})})]})}),!!x.length&&e(o,{item:!0,xs:1,children:e(la,{customMultiTargets:x})}),e(o,{item:!0,xs:1,children:e(w,{bgt:"light",children:e(k,{children:n(A,{variant:"h6",children:[c("loadoutEditor.conditionals"),e("strong",{children:H})]})})})})]})})]}),e(B,{}),e(_,{title:n(h,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(Z,{}),e("span",{children:c("loadoutEditor.builds")})]})}),e(B,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(Pt,{}),e(h,{children:e(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:T.map(b=>e(o,{item:!0,xs:1,children:e(aa,{buildId:b,characterKey:l})},b))})}),e(qt,{}),e(h,{children:e(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:I.map(b=>e(o,{item:!0,xs:1,children:e(na,{buildTcId:b})},b))})})]}),e(B,{}),e(_,{title:n(h,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(Z,{}),e("span",{children:c("loadoutEditor.teams")})]})}),e(B,{}),n(k,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e($t,{}),n(o,{container:!0,columns:{xs:1,md:2},spacing:2,children:[a.map(b=>e(o,{item:!0,xs:1,children:e(Ae,{bgt:"light",teamId:b,onClick:j=>y(`/teams/${b}${j?`/${j}`:""}`)})},b)),e(o,{item:!0,xs:1,children:e(M,{fullWidth:!0,sx:{height:"100%",backgroundColor:"contentLight.main"},variant:"outlined",onClick:()=>te(s),color:"info",startIcon:e(Y,{}),children:c("loadoutEditor.addNewTeam")})})]})]})]})})}function ia({bonusStats:t}){const{t:r}=E("loadout");return n(w,{bgt:"light",children:[e(_,{title:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(at,{}),e("span",{children:r("loadoutEditor.bonusStats")})]}),titleTypographyProps:{variant:"h6"}}),e(we,{bgt:"light",sections:[{fields:Object.entries(t).map(([s,a])=>({text:nt.getStr(s)??s,value:a,unit:re(s)}))}]})]})}function la({customMultiTargets:t}){const{t:r}=E("loadout");return n(w,{bgt:"light",children:[e(_,{title:n(h,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(ve,{}),e("span",{children:r("loadoutEditor.mltTargets")})]}),titleTypographyProps:{variant:"h6"}}),e(we,{bgt:"light",sections:[{fields:t.map(({name:s,description:a})=>({text:s,value:a?e(z,{title:a,children:e(P,{})}):void 0}))}]})]})}const oa={xs:1,md:2};function da({teamCharId:t,teamIds:r}){const{t:s}=E("page_character"),a=F(),c=W(),u=i=>{const l=c.teams.new();c.teams.set(l,f=>{f.loadoutData[0]={teamCharId:i}}),a(`/teams/${l}`)},[d,g,y]=Te();return n(rt,{children:[e(ca,{show:d,onHide:y,teamCharId:t,teamIds:r}),n(w,{bgt:"light",children:[e(M,{fullWidth:!0,onClick:g,sx:{p:0,display:"flex",borderBottomLeftRadius:0,borderBottomRightRadius:0},color:"neutral100",variant:"outlined",children:e(Yt,{teamCharId:t,showSetting:!0})}),e(k,{sx:{p:1},children:n(o,{container:!0,columns:oa,spacing:1,children:[r.map(i=>e(o,{item:!0,xs:1,children:e(Ae,{teamId:i,onClick:l=>a(`/teams/${i}${l?`/${l}`:""}`)})},i)),e(o,{item:!0,xs:1,children:e(M,{fullWidth:!0,sx:{height:"100%",backgroundColor:"contentNormal.main"},variant:"outlined",onClick:()=>u(t),color:"info",startIcon:e(Y,{}),children:s("charContentModal.addTeam")})})]})})]},t)]})}var N={},ye;function ha(){if(ye)return N;ye=1;var t=Ie();Object.defineProperty(N,"__esModule",{value:!0}),N.default=void 0;var r=t(Se()),s=Me(),a=(0,r.default)((0,s.jsx)("path",{d:"M17.5 9.5C17.5 6.46 15.04 4 12 4S6.5 6.46 6.5 9.5c0 2.7 1.94 4.93 4.5 5.4V17H9v2h2v2h2v-2h2v-2h-2v-2.1c2.56-.47 4.5-2.7 4.5-5.4zm-9 0C8.5 7.57 10.07 6 12 6s3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5z"}),"Female");return N.default=a,N}var ua=ha();const pa=De(ua);var K={},Ce;function ma(){if(Ce)return K;Ce=1;var t=Ie();Object.defineProperty(K,"__esModule",{value:!0}),K.default=void 0;var r=t(Se()),s=Me(),a=(0,r.default)((0,s.jsx)("path",{d:"M9.5 11c1.93 0 3.5 1.57 3.5 3.5S11.43 18 9.5 18 6 16.43 6 14.5 7.57 11 9.5 11zm0-2C6.46 9 4 11.46 4 14.5S6.46 20 9.5 20s5.5-2.46 5.5-5.5c0-1.16-.36-2.23-.97-3.12L18 7.42V10h2V4h-6v2h2.58l-3.97 3.97C11.73 9.36 10.66 9 9.5 9z"}),"Male");return K.default=a,K}var ga=ma();const fa=De(ga);function xa(){const{t}=E("ui"),r=W(),{character:s}=p.useContext($),{key:a}=s,{gender:c}=de(),u=p.useCallback(()=>r.dbMeta.set({gender:c==="F"?"M":"F"}),[c,r]);return a.startsWith("Traveler")?n(M,{onClick:u,startIcon:c==="F"?e(pa,{}):e(fa,{}),children:[e("strong",{children:t(`gender.${c}`)})," "]}):null}function ya({onClose:t}){const{t:r}=E(["page_character","sillyWisher_charNames","charNames_gen"]),s=F(),a=W(),{character:c,character:{key:u}}=p.useContext($),{gender:d}=de(),g=st(u,d),{silly:y}=p.useContext(ke),i=p.useCallback(async()=>{const l=r(`${y?"sillyWisher_charNames":"charNames_gen"}:${ct(u,d)}`);window.confirm(r("removeCharacter",{value:l}))&&(a.chars.remove(u),s("/characters"))},[a,s,u,d,y,r]);return n(h,{display:"flex",flexDirection:"column",gap:1,children:[n(h,{display:"flex",gap:1,children:[e(xa,{}),e(M,{color:"error",onClick:()=>i(),startIcon:e(le,{}),sx:{marginLeft:"auto"},children:r("delete")}),!!t&&e(ie,{onClick:t,children:e(Q,{})})]}),e(h,{children:n(o,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[e(o,{item:!0,xs:8,sm:5,md:4,lg:3,children:n(w,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e(Gt,{}),e(h,{sx:{px:1},children:e(Vt,{level:c.level,ascension:c.ascension,setBoth:l=>{me.includes(u)?me.forEach(f=>{a.chars.set(f,l)}):a.chars.set(u,l)}})}),e(it,{bgt:"light"}),e(A,{sx:{textAlign:"center",pb:-1},variant:"h6",children:e(lt,{characterKey:u,gender:d})}),e(h,{sx:{px:1},children:e(Ht,{setConstellation:l=>a.chars.set(u,{constellation:l})})})]})}),n(o,{item:!0,xs:12,sm:7,md:8,lg:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(h,{children:e(o,{container:!0,columns:3,spacing:1,children:["auto","skill","burst"].map(l=>{var f;return e(o,{item:!0,xs:1,children:e(Jt,{talentKey:l,dropDownButtonProps:{startIcon:e(be,{src:(f=g.getTalentOfKey(l))==null?void 0:f.img,size:1.75,sideMargin:!0})},setTalent:C=>a.chars.set(u,T=>{T.talent[l]=C})},l)},l)})})}),e(Ca,{}),e(ba,{})]})]})})]})}function Ca(){const{character:{key:t,equippedArtifacts:r}}=p.useContext($),{data:s}=p.useContext(Ee),a=W(),c=ce(t).weaponType,u=s.get(ge.weapon.id).value,d=p.useMemo(()=>ot(dt,g=>s.get(ge.art[g].id).value),[s]);return e(h,{children:e(ht.Provider,{value:"equipped",children:e(Ut,{weaponTypeKey:c,weaponId:u,artifactIds:d,setWeapon:g=>{a.weapons.set(g,{location:fe(t)})},setArtifact:(g,y)=>{y?a.arts.set(y,{location:fe(t)}):a.arts.set(r[g],{location:""})}})})})}function ba(){const{t}=E("page_character"),r=F(),{character:{key:s}}=p.useContext($),a=W(),{gender:c}=de(),u=xe(a.teamChars),d=xe(a.teams),g=p.useMemo(()=>{const i={};return[...u].sort((C,T)=>{const[,I]=C,[,x]=T;return I.name.localeCompare(x.name)}).map(([C,T])=>{T.key===s&&(i[C]||(i[C]=[]))}),[...d].sort((C,T)=>{const[,I]=C,[,x]=T;return I.name.localeCompare(x.name)}).forEach(([C,T])=>{const I=T.loadoutData.find(x=>{var v;return x&&((v=a.teamChars.get(x==null?void 0:x.teamCharId))==null?void 0:v.key)===s});I&&i[I==null?void 0:I.teamCharId].push(C)}),i},[u,d,s,a.teamChars]),y=()=>{const i=a.teams.new(),l=a.teamChars.new(s);a.teams.set(i,f=>{f.loadoutData[0]={teamCharId:l}}),r(`/teams/${i}`)};return n(h,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(A,{variant:"h6",children:n(se,{t,i18nKey:"charContentModal.loadoutsWith",children:["Team Loadouts with"," ",e(ut,{characterKey:s,gender:c})]})}),!Object.values(g).length&&e(ea,{}),Object.entries(g).map(([i,l])=>e(da,{teamCharId:i,teamIds:l},i)),e(M,{fullWidth:!0,onClick:()=>y(),color:"info",startIcon:e(Y,{}),variant:"outlined",sx:{backgroundColor:"contentLight.main"},children:t("charContentModal.addLoAndTeam")}),e(w,{bgt:"light"})]})}function va({characterKey:t,onClose:r}){return e(oe,{open:!!t,onClose:r,children:e(p.Suspense,{fallback:e(q,{variant:"rectangular",width:"100%",height:1e3}),children:t&&e(Ta,{characterKey:t,onClose:r},t)})})}function Ta({characterKey:t,onClose:r}){const s=pt(t),a=mt(t),{target:c}=(a==null?void 0:a[t])??{},u=p.useMemo(()=>{if(!(!a||!c))return{data:c,teamData:a,compareData:void 0}},[c,a]),d=p.useMemo(()=>s&&{character:s},[s]),[g,y]=p.useState(),[i,l]=p.useState(),f=p.useMemo(()=>({chartData:g,setChartData:y,graphBuilds:i,setGraphBuilds:l}),[g,i]);return p.useEffect(()=>{y(void 0),l(void 0)},[t]),e(w,{children:e(k,{sx:{display:"flex",flexDirection:"column",gap:1},children:e(p.Suspense,{fallback:e(q,{variant:"rectangular",width:"100%",height:1e3}),children:u&&d&&f?e($.Provider,{value:d,children:e(Ee.Provider,{value:u,children:e(gt.Provider,{value:f,children:e(ya,{onClose:r})})})}):e(q,{variant:"rectangular",width:"100%",height:1e3})})})})}const wa={xs:1,sm:2,md:3,lg:4,xl:4},Ia={xs:5,sm:8,md:9,lg:12,xl:12},Sa=Object.keys(je);function Ba(){const t=W(),r=F(),{params:{characterKey:s}}=ft({path:"/characters/:characterKey",end:!1})??{params:{}},a=p.useMemo(()=>s?xt(s)?(t.chars.get(s)||t.chars.getWithInitWeapon(s),s):(r("/characters"),null):null,[s,r,t]),{t:c}=E(["page_character","sillyWisher_charNames","charNames_gen"]),{silly:u}=p.useContext(ke),d=yt(t.displayCharacter),[g,y]=p.useState(""),i=p.useDeferredValue(g),l=Ct(),[f,C]=p.useState(!1);Xt()&&bt.send({hitType:"pageview",page:"/characters"});const T=vt(t.charMeta),I=ta(),x=Tt(t.chars),v=x.length,S=p.useMemo(()=>{const{element:m,weaponType:L,rarity:O,sortType:D,ascending:U}=d;return T&&x.filter(wt({element:m,weaponType:L,rarity:O,name:i},At(t,u))).sort(It(je[D]??[],U,Lt(t,u),["new","favorite"]))},[d,T,x,i,t,u]),{weaponType:G,element:V,rarity:X,sortType:ee,ascending:te}=d,H=p.useMemo(()=>ne(Rt,m=>Object.entries(t.chars.data).forEach(([L,O])=>{const D=t.weapons.get(O.equippedWeapon);if(!D)return;const U=Ot(D.key).weaponType;m[U].total++,S.includes(L)&&m[U].current++})),[t,S]),b=p.useMemo(()=>ne(Ft,m=>Object.entries(t.chars.data).forEach(([L,O])=>{const D=_t(O.key);m[D].total++,S.includes(L)&&m[D].current++})),[t,S]),j=p.useMemo(()=>ne(Nt,m=>Object.entries(t.chars.data).forEach(([L,O])=>{const D=ce(O.key).rarity;m[D].total++,S.includes(L)&&m[D].current++})),[t,S]),{numShow:J,setTriggerElement:Le}=St(Ia[l],S.length),ae=p.useMemo(()=>S.slice(0,J),[S,J]),Oe=S.length!==v?`${S.length}/${v}`:`${v}`,Re={numShowing:ae.length,total:Oe,t:c,namespace:"page_character"},_e={sortKeys:[...Sa],value:ee,onChange:m=>{m!=="new"&&t.displayCharacter.set({sortType:m})},ascending:te,onChangeAsc:m=>t.displayCharacter.set({ascending:m})};return n(h,{display:"flex",flexDirection:"column",gap:1,children:[a&&e(va,{characterKey:a,onClose:()=>r("/characters")}),e(p.Suspense,{fallback:!1,children:e(Mt,{newFirst:!0,show:f,onHide:()=>C(!1),onSelect:I})}),e(w,{children:n(k,{sx:{display:"flex",flexDirection:"column",gap:1},children:[n(o,{container:!0,spacing:1,children:[e(o,{item:!0,children:e(Dt,{sx:{height:"100%"},onChange:m=>t.displayCharacter.set({weaponType:m}),value:G,totals:H,size:"small"})}),e(o,{item:!0,children:e(kt,{sx:{height:"100%"},onChange:m=>t.displayCharacter.set({element:m}),value:V,totals:b,size:"small"})}),e(o,{item:!0,children:e(Et,{sx:{height:"100%"},onChange:m=>t.displayCharacter.set({rarity:m}),value:X,totals:j,size:"small"})}),e(o,{item:!0,flexGrow:1}),e(o,{item:!0,children:e(jt,{autoFocus:!0,value:g,onChange:m=>y(m.target.value),label:c("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),e(h,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:e(Wt,{showingTextProps:Re,sortByButtonProps:_e})})]})}),e(M,{fullWidth:!0,onClick:()=>C(!0),color:"info",startIcon:e(Y,{}),children:c("addNew")}),e(p.Suspense,{fallback:e(q,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:e(o,{container:!0,spacing:1,columns:wa,children:ae.map(m=>e(o,{item:!0,xs:1,children:e(Bt,{characterKey:m,onClick:()=>r(`${m}`),hideStats:!0})},m))})}),S.length!==ae.length&&e(q,{ref:m=>{m&&Le(m)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})}export{Ba as default};
