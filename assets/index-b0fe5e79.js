import{Q as U,e as a,U as xt,n as i,J as o,p as t,T as w,B as A,t as C,C as g,V as J,D as L,W as T,X as Y,r as Z,i as tt,j as et,u as _,b as R,N as k,_ as O,Y as At,Z as wt,$ as rt,K,a0 as vt,a1 as kt,s as Dt,a2 as St,M as Ct,R as at}from"./index-5e9c36dc.js";import{u as _t,f as It,s as Et,a as Tt,S as Pt}from"./StarDisplay-126f8310.js";import{d as it,A as nt,a as Ft,b as Mt,p as $t,c as Rt,e as Q}from"./ArtifactSort-dada7f4a.js";import{S as jt,A as qt}from"./StatEditorList-b9a3fa07.js";import{d as ot}from"./Close-0b2eee68.js";import{d as Ut}from"./InfoTooltip-c1cf7221.js";import{T as Kt}from"./index-1d67c2c2.js";import{u as st}from"./useDisplayArtifact-2fcfc62e.js";import{d as Lt,a as Ot}from"./LockOpen-1fed6a2d.js";import{S as $}from"./SqBadge-2a351105.js";import{C as Wt}from"./StatIcon-9a18f62c.js";import{C as Bt}from"./ColoredText-4a38b939.js";import{A as Vt}from"./ConditionalWrapper-b57ad33c.js";import"./DropdownButton-88e2c87a.js";import"./BootstrapTooltip-059c3a53.js";import"./SlotIcon-6388a941.js";import"./index-1052d00b.js";import"./Artifact-b5ca219f.js";import"./CardActionArea-04ae828e.js";import"./Link-315b337c.js";function zt({pageKey:r,text:e="",modalTitle:n="",children:u}){const[f,h,c]=U(localStorage.getItem(`infoShown_${r}`)!=="true"),[d]=a.useState(Array.isArray(e)?xt(e):e),m=a.useCallback(()=>{c(),localStorage.setItem(`infoShown_${r}`,"true")},[c,r]);return i(C,{children:[i(o,{container:!0,children:[t(o,{item:!0,flexGrow:1,children:t(w,{variant:"caption",pl:1,children:d})}),t(o,{item:!0,xs:"auto",children:t(A,{size:"small",color:"info",variant:"contained",onClick:h,startIcon:t(Ut,{}),children:t(Kt,{ns:"ui",key18:"info"})})})]}),t(Y,{containerProps:{maxWidth:"xl"},open:f,onClose:m,children:i(C,{children:[i(g,{sx:{py:1,display:"flex"},children:[t(w,{variant:"h6",children:n}),t(J,{onClick:m,sx:{ml:"auto"},children:t(ot,{})})]}),t(L,{}),t(g,{children:t(a.Suspense,{fallback:t(T,{variant:"rectangular",width:"100%",height:500}),children:u})})]})})]})}var W={},Ht=tt;Object.defineProperty(W,"__esModule",{value:!0});var lt=W.default=void 0,Gt=Ht(Z()),Nt=et,Qt=(0,Gt.default)((0,Nt.jsx)("path",{d:"M8.65 5.82C9.36 4.72 10.6 4 12 4c2.21 0 4 1.79 4 4 0 1.4-.72 2.64-1.82 3.35L8.65 5.82zM20 17.17c-.02-1.1-.63-2.11-1.61-2.62-.54-.28-1.13-.54-1.77-.76L20 17.17zm1.19 4.02L2.81 2.81 1.39 4.22l8.89 8.89c-1.81.23-3.39.79-4.67 1.45-1 .51-1.61 1.54-1.61 2.66V20h13.17l2.61 2.61 1.41-1.42z"}),"PersonOff");lt=W.default=Qt;var B={},Xt=tt;Object.defineProperty(B,"__esModule",{value:!0});var ct=B.default=void 0,Jt=Xt(Z()),Yt=et,Zt=(0,Jt.default)((0,Yt.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");ct=B.default=Zt;const te=a.lazy(()=>O(()=>import("./ArtifactFilterDisplay-2f92c0e7.js").then(r=>r.b),["./ArtifactFilterDisplay-2f92c0e7.js","./index-5e9c36dc.js","./index-f3ce5823.css","./LockOpen-1fed6a2d.js","./useDisplayArtifact-2fcfc62e.js","./SolidToggleButtonGroup-2f91743d.js","./totalUtils-7e03b668.js","./BootstrapTooltip-059c3a53.js","./StarDisplay-126f8310.js","./DropdownButton-88e2c87a.js","./ColoredText-4a38b939.js","./index-1d67c2c2.js","./SqBadge-2a351105.js","./ArtifactStatKeyDisplay-ed4b5e6b.js","./Artifact-b5ca219f.js","./StatIcon-9a18f62c.js","./ConditionalWrapper-b57ad33c.js","./index-1052d00b.js","./SlotIcon-6388a941.js"],import.meta.url));function ee({numShowing:r,total:e,artifactIds:n}){const{t:u}=_(["artifact","ui"]),f=R(),{filterOption:h}=st(),c=a.useCallback(d=>f.displayArtifact.set({filterOption:{...h,...d}}),[f,h]);return t(a.Suspense,{fallback:t(T,{variant:"rectangular",width:"100%",height:300}),children:t(C,{children:i(g,{children:[i(o,{container:!0,children:[t(o,{item:!0,children:t(w,{variant:"h6",children:t(k,{t:u,i18nKey:"artifactFilter",children:"Artifact Filter"})})}),t(o,{item:!0,flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",children:r!==e&&i(w,{children:["Filtered ",t("strong",{children:r})," / ",e]})}),t(o,{item:!0,children:t(A,{size:"small",color:"error",onClick:()=>f.displayArtifact.set({action:"reset"}),startIcon:t(ct,{}),children:t(k,{t:u,i18nKey:"ui:reset"})})})]}),t(a.Suspense,{fallback:t(T,{variant:"rectangular",width:"100%",height:200}),children:t(te,{filterOption:h,filterOptionDispatch:c,filteredIds:n})})]})})})}function re({artifactIds:r}){const{t:e}=_(["artifact","ui"]),n=R(),{numDelete:u,numUnequip:f,numUnlock:h,numLock:c}=a.useMemo(()=>{const l=r.map(x=>n.arts.get(x)),p=l.reduce((x,S)=>x+(S.lock?0:1),0),y=l.length-p,v=p,j=l.reduce((x,S)=>x+(S.location?1:0),0);return{numDelete:v,numUnequip:j,numUnlock:p,numLock:y}},[r,n]);return i(o,{container:!0,spacing:1,alignItems:"center",children:[t(o,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!f,onClick:()=>window.confirm(`Are you sure you want to unequip ${f} artifacts currently equipped on characters?`)&&r.map(l=>n.arts.set(l,{location:""})),startIcon:t(lt,{}),children:[t(k,{t:e,i18nKey:"button.unequipArtifacts",children:"Unequip Artifacts"}),t($,{sx:{ml:1},color:f?"success":"secondary",children:f})]})}),t(o,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!u,onClick:()=>window.confirm(`Are you sure you want to delete ${u} artifacts?`)&&r.map(l=>{var p;return!((p=n.arts.get(l))!=null&&p.lock)&&n.arts.remove(l)}),startIcon:t(At,{}),children:[t(k,{t:e,i18nKey:"button.deleteArtifacts",children:"Delete Artifacts"}),t($,{sx:{ml:1},color:u?"success":"secondary",children:u})]})}),t(o,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!c,onClick:()=>window.confirm(`Are you sure you want to unlock ${c} artifacts?`)&&r.map(l=>n.arts.set(l,{lock:!1})),startIcon:t(Lt,{}),children:[t(k,{t:e,i18nKey:"button.unlockrtifacts",children:"Unlock Artifacts"}),t($,{sx:{ml:1},color:c?"success":"secondary",children:c})]})}),t(o,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!h,onClick:()=>window.confirm(`Are you sure you want to lock ${h} artifacts?`)&&r.map(l=>n.arts.set(l,{lock:!0})),startIcon:t(Ot,{}),children:[t(k,{t:e,i18nKey:"button.lockArtifacts",children:"Lock Artifacts"}),t($,{sx:{ml:1},color:h?"success":"secondary",children:h})]})}),t(o,{item:!0,xs:12,display:"flex",justifyContent:"space-around",children:t(w,{variant:"caption",color:"text.secondary",children:i(k,{t:e,i18nKey:"buttonHint",children:["Note: the red buttons above only apply to",t("b",{children:"currently filtered artifacts"})]})})})]})}function ae({show:r,onHide:e}){const{t:n}=_("artifact");return t(Y,{open:r,onClose:e,children:i(wt,{children:[t(Wt,{title:i(w,{variant:"h6",flexGrow:1,display:"flex",alignItems:"center",children:[t(it,{sx:{verticalAlign:"text-top",mr:1}}),n`showDup`]}),action:t(J,{onClick:e,children:t(ot,{})})}),t(L,{}),t(g,{children:t(ie,{})})]})})}function ie(){const{t:r}=_("artifact"),e=R(),[n,u]=rt();a.useEffect(()=>e.arts.followAny(u),[u,e]);const f=a.useMemo(()=>{const c=n&&[];let d=e.arts.keys;for(;d.length!==0;){const m=d.shift();if(!m)continue;const I=e.arts.get(m);if(!I)continue;const{duplicated:D}=e.arts.findDups(I,d);if(!D.length)continue;const l=D.map(p=>p.id);c.push([m,...l].sort(p=>{var y;return((y=e.arts.get(p))==null?void 0:y.location)??""?-1:1})),d=d.filter(p=>!l.includes(p))}return c},[e,n]),h=a.useMemo(()=>({}),[]);return i(kt,{spacing:2,children:[f.map(c=>t(C,{sx:{overflowX:"scroll"},children:t(g,{sx:{display:"flex",gap:1},children:c.map(d=>t(K,{sx:{minWidth:300},children:t(nt,{artifactId:d,canEquip:!0,onDelete:()=>e.arts.remove(d),editorProps:h})},d))})},c.join())),!f.length&&t(vt,{variant:"filled",severity:"success",children:r`noDupAlert`})]})}const ne=[...St];function oe({probabilityFilter:r={},setProbabilityFilter:e,disabled:n=!1}){const{t:u}=_("artifact");return i(C,{children:[t(g,{sx:{py:1},children:t(w,{variant:"h6",children:"Roll Probability Calculator"})}),t(L,{}),t(g,{children:i(o,{container:!0,spacing:1,children:[t(o,{item:!0,xs:12,md:6,children:t(Dt,{children:t(g,{children:i(w,{children:['This UI only pops up when "Sort by"',t("strong",{children:"Probability"}),". In conjunction with the Artifact Filters above, this UI allows you to set a criteria for substats values, and it will sort the artifacts by those with the highest probability to roll into those criteria values.",i(Bt,{color:"warning",children:[" ","Artifacts that already reach the criteria(100%) or are at 0% are hidden."]})]})})})}),t(o,{item:!0,xs:12,md:6,spacing:1,sx:{display:"flex",flexDirection:"column",gap:1},children:t(jt,{statKeys:ne,statFilters:r,setStatFilters:e,disabled:n,label:u("probabilityFilter.label")})})]})})]})}const se=at.lazy(()=>O(()=>import("./ArtifactEditor-d911ea84.js"),["./ArtifactEditor-d911ea84.js","./index-5e9c36dc.js","./index-f3ce5823.css","./ChevronRight-b8b5b0bc.js","./index-1d67c2c2.js","./ColoredText-4a38b939.js","./SqBadge-2a351105.js","./Close-0b2eee68.js","./InfoTooltip-c1cf7221.js","./BootstrapTooltip-059c3a53.js","./LockOpen-1fed6a2d.js","./ArtifactRarityDropdown-255b2855.js","./index-1052d00b.js","./ConditionalWrapper-b57ad33c.js","./StarDisplay-126f8310.js","./DropdownButton-88e2c87a.js","./ArtifactStatKeyDisplay-ed4b5e6b.js","./Artifact-b5ca219f.js","./StatIcon-9a18f62c.js","./SlotIcon-6388a941.js","./ArtifactSort-dada7f4a.js","./CardActionArea-04ae828e.js","./TextButton-66a2f5aa.js"],import.meta.url)),le=at.lazy(()=>O(()=>import("./index-78d1656e.js"),["./index-78d1656e.js","./index-5e9c36dc.js","./index-f3ce5823.css","./Settings-04a19c08.js","./StarDisplay-126f8310.js","./DropdownButton-88e2c87a.js","./ColoredText-4a38b939.js","./index-1d67c2c2.js","./SqBadge-2a351105.js","./ImgFullwidth-b06fc4cc.js","./ArtifactSort-dada7f4a.js","./ConditionalWrapper-b57ad33c.js","./BootstrapTooltip-059c3a53.js","./SlotIcon-6388a941.js","./InfoTooltip-c1cf7221.js","./index-1052d00b.js","./Artifact-b5ca219f.js","./StatIcon-9a18f62c.js","./CardActionArea-04ae828e.js","./Link-315b337c.js"],import.meta.url)),X={xs:1,sm:2,md:3,lg:3,xl:4},ce={xs:5,sm:6,md:12,lg:12,xl:12};function Pe(){const{t:r}=_(["artifact","ui"]),e=R(),n=st(),[u,f,h]=U(!1),[c,d,m]=U(!1),I=_t(),{sortType:D,effFilter:l,ascending:p,probabilityFilter:y}=n,v=D==="probability",[j,x]=rt(),S=a.useDeferredValue(j),E=a.useMemo(()=>new Set(l),[l]),ut=a.useCallback(s=>e.arts.remove(s),[e]);a.useEffect(()=>(Ct.send({hitType:"pageview",page:"/artifact"}),e.arts.followAny(()=>x())),[e,x]);const dt=a.useCallback(s=>e.displayArtifact.set({probabilityFilter:s}),[e]),ft=a.useMemo(()=>!e.arts.values.length,[e]),V=a.useMemo(()=>Ft(E,y),[E,y]),z=a.useMemo(()=>Mt(E),[E]),H=a.useDeferredValue(n),G=a.useDeferredValue(y);a.useEffect(()=>{if(v)return e.arts.values.forEach(s=>e.arts.setProbability(s.id,$t(s,G))),()=>e.arts.values.forEach(s=>e.arts.setProbability(s.id,-1))},[e,v,G]);const{artifactIds:b,totalArtNum:P}=a.useMemo(()=>{const{sortType:s=Q[0],ascending:bt=!1,filterOption:gt}=H;let F=e.arts.values;return v&&(F=F.filter(M=>M.probability&&M.probability!==1)),{artifactIds:F.filter(It(gt,z)).sort(Et(Rt[s]??[],bt,V)).map(M=>M.id),totalArtNum:F.length,...S}},[H,S,e,V,z,v]),{numShow:N,setTriggerElement:ht}=Tt(ce[I],b.length),q=a.useMemo(()=>b.slice(0,N),[b,N]),pt=b.length!==P?`${b.length}/${P}`:`${P}`,mt={numShowing:q.length,total:pt,t:r,namespace:"artifact"},yt={sortKeys:[...Q],value:D,onChange:s=>e.displayArtifact.set({sortType:s}),ascending:p,onChangeAsc:s=>e.displayArtifact.set({ascending:s})};return i(K,{display:"flex",flexDirection:"column",gap:1,my:1,children:[t(a.Suspense,{fallback:!1,children:t(se,{artifactIdToEdit:u?"new":"",cancelEdit:h,allowUpload:!0,allowEmpty:!0})}),t(a.Suspense,{fallback:!1,children:t(ae,{show:c,onHide:m})}),t(zt,{pageKey:"artifactPage",modalTitle:r`info.title`,text:r("tipsOfTheDay",{returnObjects:!0}),children:t(le,{})}),ft&&t(qt,{}),t(ee,{numShowing:b.length,total:P,artifactIds:b}),t(C,{children:i(g,{children:[t(K,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(Pt,{showingTextProps:mt,sortByButtonProps:yt})}),t(re,{artifactIds:b})]})}),v&&t(oe,{probabilityFilter:y,setProbabilityFilter:dt}),i(o,{container:!0,columns:X,spacing:1,children:[t(o,{item:!0,xs:!0,children:t(A,{fullWidth:!0,onClick:f,color:"info",startIcon:t(Vt,{}),children:r`addNew`})}),t(o,{item:!0,xs:1,children:t(A,{fullWidth:!0,onClick:d,color:"info",startIcon:t(it,{}),children:r`showDup`})})]}),i(a.Suspense,{fallback:t(T,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:[t(o,{container:!0,spacing:1,columns:X,children:q.map(s=>t(o,{item:!0,xs:1,children:t(nt,{artifactId:s,effFilter:E,onDelete:ut,editorProps:{},canEquip:!0})},s))}),b.length!==q.length&&t(T,{ref:s=>{s&&ht(s)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})]})}export{Pe as default};
