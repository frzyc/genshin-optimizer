import{u as H,e as p,n as h,p as t,dB as oe,dC as ie,c4 as z,B as S,dD as J,dE as le,dF as ce,a0 as ue,dG as de,dH as pe,a2 as fe,a1 as me,T as L,K as w,dI as M,bc as O,co as R,dJ as j,bk as N,bl as U,D as _,dK as v,C as B,t as E,al as he,dL as xe,b as Ce,d as ge,Q as ye,J as g,s as ve,V as be,R as ke,_ as De}from"./index-94c37da5.js";import{T as we,g as Le,w as Se,v as Te,x as Ie,u as T}from"./index-581f9494.js";import{u as Me}from"./WeaponUtil-8a7b29e7.js";import{L as We,a as Be,b as Oe}from"./LocationAutocomplete-5352bfab.js";import{C as Re}from"./CloseButton-f7ad2d98.js";import{D as y,C as F,d as K,b as je,a as _e,L as Ee}from"./FieldDisplay-ac1a92e2.js";import{M as I,D as V}from"./DropdownButton-7ced2b07.js";import{S as q}from"./SqBadge-28fa9002.js";import{B as A}from"./ColoredText-5a5b0be5.js";import{a as Fe}from"./InfoTooltip-a45d500a.js";import{c as Ve}from"./StarDisplay-4aa86735.js";import{g as Ae}from"./index-3c5f49c3.js";import{C as Pe}from"./CardHeader-f7d76b88.js";function Ge({level:e,ascension:a,setBoth:n,useLow:o=!1,disabled:i=!1}){const{t:d}=H("ui"),s=o?ce:z,r=p.useCallback((u=1)=>{u=ue(u,1,o?de:pe);const f=s.findIndex(m=>u<=m);n({level:u,ascension:f})},[n,s,o]),l=p.useCallback(()=>{const u=s.findIndex(f=>e!==90&&e===f);n(a===u?{ascension:a+1}:{ascension:u})},[n,s,a,e]);return h(A,{sx:{bgcolor:u=>u.palette.contentNormal.main},children:[t(me,{children:t(fe,{onChange:r,value:e,startAdornment:"Lv. ",disabled:i,inputProps:{min:1,max:90,sx:{textAlign:"center",width:"3em"}},sx:{height:"100%",pl:2}})}),t(S,{sx:{pl:1,whiteSpace:"nowrap"},disabled:!(o?oe:ie)(e)||i,onClick:l,children:h("strong",{children:["/ ",z[a]]})}),t(V,{title:d("selectlevel"),sx:{flexGrow:1},disabled:i,children:[...o?J:le].map(([u,f])=>{const m=u===e&&f===a;return t(I,{selected:m,disabled:m,onClick:()=>n({level:u,ascension:f}),children:u===s[f]?`Lv. ${u}`:`Lv. ${u}/${s[f]}`},`${u}/${f}`)})})]})}function $e({avatar:e,title:a,action:n}){return h(w,{display:"flex",gap:1,p:2,alignItems:"center",children:[e,t(L,{variant:"subtitle1",sx:{flexGrow:1},children:a}),n&&t(L,{variant:"caption",children:n})]})}function ze({conditional:e,disabled:a=!1}){const{data:n}=p.useContext(y);return Object.keys(M(e.states,n)).length===1&&"path"in e?t(He,{conditional:e,disabled:a}):"path"in e?t(Je,{conditional:e,disabled:a}):t(Ne,{conditional:e,disabled:a})}function He({conditional:e,disabled:a}){const{character:n,characterDispatch:o}=p.useContext(F),{data:i}=p.useContext(y),d=p.useCallback(m=>{const C=O(n.conditional);m?R(C,e.path,m):j(C,e.path),o({conditional:C})},[e,n,o]),s=i.get(e.value).value,[r,l]=Object.entries(M(e.states,i))[0],u=X(l.name),f=P(e.name);return h(S,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s?"success":"primary",onClick:()=>d(s?void 0:r),disabled:a,startIcon:s?t(N,{}):t(U,{}),children:[f," ",u]})}function Je({conditional:e,disabled:a}){const{character:n,characterDispatch:o}=p.useContext(F),{data:i}=p.useContext(y),d=p.useCallback(m=>{const C=O(n.conditional);m?R(C,e.path,m):j(C,e.path),o({conditional:C})},[e,n,o]),s=i.get(e.value).value,r=M(e.states,i),l=s?r[s]:void 0,u=l?X(l.name):t(q,{color:"secondary",children:"Not Active"}),f=P(e.name);return h(V,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s&&l?"success":"primary",title:h("span",{children:[f," ",u]}),disabled:a,children:[t(I,{onClick:()=>d(),selected:!l,disabled:!l,children:t("span",{children:"Not Active"})}),t(_,{}),Object.entries(r).map(([m,C])=>t(I,{onClick:()=>d(m),selected:s===m,disabled:s===m,children:C.name},m))]})}function Ne({conditional:e,disabled:a}){const{character:n,characterDispatch:o}=p.useContext(F),{data:i}=p.useContext(y),d=p.useCallback((s,r)=>{const l=O(n.conditional);r?R(l,s,r):j(l,s),o({conditional:l})},[n,o]);return t(A,{fullWidth:!0,orientation:"vertical",disableElevation:!0,color:"secondary",children:Object.entries(M(e.states,i)).map(([s,r])=>{const l=i.get(r.value).value,u=l===s;return t(S,{color:u?"success":"primary",disabled:a,fullWidth:!0,onClick:()=>d(r.path,l?void 0:s),size:"small",startIcon:u?t(N,{}):t(U,{}),sx:{borderRadius:0},children:P(r.name)},s)})})}function Q(e){return typeof e!="string"}function X(e){if(!e)return"";let a="primary",n=e;return e&&Q(e)&&e.props.color&&(a=e.props.color,n=t("span",{children:e.props.children})),t(q,{sx:{ml:.5},color:a,children:n})}function P(e){if(Q(e)){const a=e.props.key18,n=e.props.ns,o=e.props.values;return t(we,{ns:n,key18:a,values:o,useBadge:!0})}return e}function Ue({conditional:e,hideHeader:a=!1,hideDesc:n=!1,disabled:o=!1}){var s;const{data:i}=p.useContext(y);let d;if("path"in e){const r=i.get(e.value).value,l=v(e.states,i);d=r&&((s=l[r])==null?void 0:s.fields)}else{const r=v(e.states,i);d=Object.values(r).flatMap(l=>i.get(l.value).value?l.fields:[])}return h(E,{children:[!v(a,e)&&t(Y,{header:e.header,hideDesc:n}),t(B,{sx:{p:0,"&:last-child":{pb:0}},children:t(ze,{conditional:e,disabled:o})}),d&&t(K,{fields:d})]})}function Ke({sections:e,teamBuffOnly:a,hideDesc:n=!1,hideHeader:o=!1,disabled:i=!1}){const{data:d}=p.useContext(y);if(!e.length)return null;const s=e.map((r,l)=>r.canShow&&!d.get(r.canShow).value||a&&!r.teamBuff?null:t(qe,{section:r,hideDesc:n,hideHeader:o,disabled:i},l)).filter(r=>r);return s.length?t(w,{display:"flex",flexDirection:"column",gap:1,children:s}):null}function qe({section:e,hideDesc:a=!1,hideHeader:n=!1,disabled:o=!1}){return"fields"in e?t(Qe,{section:e,hideDesc:a,hideHeader:n}):"states"in e?t(Ue,{conditional:e,hideDesc:a,hideHeader:n,disabled:o}):t(Xe,{section:e})}function Qe({section:e,hideDesc:a,hideHeader:n}){return h(E,{children:[!v(n,e)&&e.header&&t(Y,{header:e.header,hideDesc:a,hideDivider:e.fields.length===0}),t(K,{fields:e.fields})]})}function Xe({section:e}){const{data:a}=p.useContext(y);return t("div",{children:v(e.text,a)})}function Y({header:e,hideDesc:a,hideDivider:n}){const{data:o}=p.useContext(y),{icon:i,title:d,action:s}=e,r=v(i,o),l=!a&&v(e.description,o);return h(he,{children:[t($e,{avatar:r,title:a?d:h("span",{children:[d,t(Fe,{title:t(L,{children:l})})]}),action:s}),!n&&t(_,{})]})}function Ye({refinement:e,setRefinement:a,disabled:n=!1}){const{t:o}=H("ui");return t(V,{title:o("refinement",{value:e}),disabled:n,children:xe.map(i=>t(I,{onClick:()=>a(i),selected:e===i,disabled:e===i,children:o("refinement",{value:i})},i))})}const Ze=ke.lazy(()=>De(()=>import("./WeaponSelectionModal-9be41161.js"),["./WeaponSelectionModal-9be41161.js","./index-94c37da5.js","./index-6c56832a.css","./index-581f9494.js","./ColoredText-5a5b0be5.js","./SqBadge-28fa9002.js","./index-3c5f49c3.js","./totalUtils-c6f82a1a.js","./CloseButton-f7ad2d98.js","./StarDisplay-4aa86735.js","./DropdownButton-7ced2b07.js","./WeaponCard-7d03ce38.js","./WeaponUtil-8a7b29e7.js","./LocationAutocomplete-5352bfab.js","./CardActionArea-ea9fd492.js"],import.meta.url));function et({weaponId:e,footer:a=!1,onClose:n,extraButtons:o}){const{data:i}=p.useContext(y),d=Ce(),s=Me(e),{key:r="",level:l=0,refinement:u=1,ascension:f=0,lock:m,location:C="",id:b}=s??{},c=r?Ae(r):void 0,k=p.useCallback(x=>{d.weapons.set(e,x)},[e,d]),{gender:G}=ge(),$=p.useMemo(()=>C?Le(d.chars.LocationToCharacterKey(C),G):void 0,[d,G,C]),Z=$&&$.weaponTypeKey,ee=p.useCallback(x=>b&&d.weapons.set(b,{location:x}),[d,b]),te=p.useCallback(x=>x.weaponTypeKey===(c==null?void 0:c.weaponType),[c]),[ne,ae,se]=ye(),re=r?Se(r,f>=2):"";p.useEffect(()=>{if(!(!c||!k||c.key!==(s==null?void 0:s.key))&&c.rarity<=2&&(l>70||f>4)){const[x,D]=J[0];k({level:x,ascension:D})}},[c,s,k,l,f]);const W=p.useMemo(()=>c&&s&&Te([c.data,Ie(s)]),[c,s]);return t(be,{open:!!e,onClose:n,containerProps:{maxWidth:"md"},children:h(ve,{children:[t(Ze,{ascension:f,show:ne,onHide:se,onSelect:x=>k({key:x}),weaponTypeFilter:Z}),t(B,{children:c&&W&&h(g,{container:!0,spacing:1.5,children:[t(g,{item:!0,xs:12,sm:3,children:h(g,{container:!0,spacing:1.5,children:[t(g,{item:!0,xs:6,sm:12,children:t(w,{component:"img",src:re,className:`grad-${c.rarity}star`,sx:{maxWidth:256,width:"100%",height:"auto",borderRadius:1}})}),t(g,{item:!0,xs:6,sm:12,children:t(L,{children:t("small",{children:c.description})})})]})}),h(g,{item:!0,xs:12,sm:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[t(w,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:h(A,{children:[t(S,{color:"info",onClick:ae,children:(c==null?void 0:c.name)??"Select a Weapon"}),(c==null?void 0:c.hasRefinement)&&t(Ye,{refinement:u,setRefinement:x=>k({refinement:x})}),o]})}),h(w,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:[c&&t(Ge,{level:l,ascension:f,setBoth:k,useLow:!c.hasRefinement}),t(S,{color:"error",onClick:()=>b&&d.weapons.set(b,{lock:!m}),startIcon:m?t(We,{}):t(Be,{}),children:m?"Locked":"Unlocked"})]}),t(Ve,{stars:c.rarity}),t(L,{variant:"subtitle1",children:t("strong",{children:c.passiveName})}),t(L,{gutterBottom:!0,children:c.passiveName&&c.passiveDescription(W.get(T.weapon.refinement).value-1)}),h(w,{display:"flex",flexDirection:"column",gap:1,children:[h(E,{children:[t(Pe,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),t(_,{}),t(je,{children:[T.weapon.main,T.weapon.sub,T.weapon.sub2].map(x=>{const D=W.get(x);return D.isEmpty||!D.value?null:t(_e,{node:D,component:Ee},JSON.stringify(D.info))})})]}),i&&c.document&&t(Ke,{sections:c.document})]})]})]})}),a&&b&&t(B,{sx:{py:1},children:h(g,{container:!0,spacing:1,children:[t(g,{item:!0,flexGrow:1,children:t(Oe,{location:C,setLocation:ee,filter:te,autoCompleteProps:{getOptionDisabled:x=>!x.key}})}),t(g,{item:!0,flexGrow:2}),!!n&&t(g,{item:!0,children:t(Re,{sx:{height:"100%"},large:!0,onClick:n})})]})})]})})}const mt=Object.freeze(Object.defineProperty({__proto__:null,default:et},Symbol.toStringTag,{value:"Module"}));export{$e as C,Ke as D,Ge as L,Ye as R,et as W,mt as a};
