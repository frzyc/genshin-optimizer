import{b as j,p as t,cL as ft,cM as pt,cN as mt,cO as gt,cP as vt,cQ as yt,cR as xt,cS as bt,cT as St,cU as _t,bC as Ct,bA as Dt,bE as ie,cv as X,cV as It,cx as ee,cW as N,cu as te,ct as A,cw as U,cX as ae,u as De,bi as ye,bh as wt,n as l,bo as D,T as g,r as H,i as V,j as G,aJ as Ie,e as _,f as ne,cY as Mt,a5 as k,Z as Rt,d as E,cZ as $t,bK as jt,cl as kt,a4 as Bt,K as v,V as ce,t as W,J as $,k as Tt,ao as le,bf as Et,ab as we,be as de,bd as Me,q as O,bW as Re,aC as $e,b6 as Nt,o as je,c8 as At,a1 as ke,bU as Be,bN as Ot,bV as zt,b1 as Wt,bO as Ht,bP as Vt,Q as Gt,bj as Te,Y as Ee}from"./index-e59a7772.js";import{B as Ne,d as Ft}from"./BootstrapTooltip-25cef559.js";import{b as Q,d as Pt,e as qt,h as Kt,p as Lt}from"./StarDisplay-d48805fe.js";import{D as Y}from"./DataContext-5e02a972.js";import{E as Ut,s as Ae,J as b,K as w,L as M,M as y,N as R,p,O as F,P,Q as Jt,R as T,V as Oe,W as se,X as Qt,T as ze,q as Yt,g as q,r as re,F as Zt,Y as Xt,w as We,H as ea,S as He,d as ta,v as aa,u as xe,x as na,n as sa,C as Ve,Z as ra,i as J,o as be,m as oa,A as ia}from"./index-5ed2f486.js";import{A as Ge}from"./Artifact-c3fa3ee9.js";import{S as B}from"./SqBadge-3f6a83ef.js";import{b as ca,g as la}from"./index-017b3013.js";import{S as da}from"./SlotIcon-79003729.js";import{i as ue,I as ua}from"./ColoredText-c608d067.js";import{u as ha}from"./useWeapon-d46f7db1.js";import{g as Fe,W as Pe}from"./index-24bf7289.js";import{C as z}from"./CardActionArea-7e813119.js";function fa(e){const a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(a,(s,r,o,i)=>r+r+o+o+i+i);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null}function os(e,a){if(e)return`rgba(${e.r},${e.g},${e.b},${a})`}function pa(e){const a=j();return Q(a.charMeta,e)}function qe(e){const a=j();return Q(a.chars,e)}function ma(e){const a=j();return Q(a.teams,e)}function ga(e){const a=j();return Q(a.teamChars,e)}function va({statKey:e,iconProps:a={}}){switch(e){case"hp":case"hp_":case"base_hp":return t(Dt,{...a});case"atk":case"atk_":case"base_atk":return t(Ct,{...a});case"def":case"def_":case"base_def":return t(_t,{...a});case"eleMas":return t(St,{...a});case"critRate_":return t(bt,{...a});case"critDMG_":return t(xt,{...a});case"enerRech_":return t(yt,{...a});case"incHeal_":return t(vt,{...a});case"heal_":return t(gt,{...a});case"cdRed_":return t(mt,{...a});case"shield_":return t(pt,{...a});case"stamina":return t(ft,{...a})}const n=e.split("_")[0];return ie.includes(n)?t(ya,{ele:n,iconProps:a}):null}function ya({ele:e,iconProps:a={}}){switch(e){case"anemo":return t(ae,{...a});case"cryo":return t(U,{...a});case"dendro":return t(A,{...a});case"electro":return t(te,{...a});case"geo":return t(N,{...a});case"hydro":return t(ee,{...a});case"physical":return t(It,{...a});case"pyro":return t(X,{...a})}}function xa({statKey:e,value:a,color:n,prefix:s="",typographyProps:r={}}){const{t:o}=De("statKey_gen"),i=ye(e),c=wt(a,ye(e));return l(g,{color:n?`${n}.main`:void 0,...r,children:[t(va,{statKey:e,iconProps:D})," ",o(e)," ",t("strong",{children:`${s}${c}${i}`})]},e)}function Ke({condition:e,wrapper:a,falseWrapper:n,children:s}){return e?a(s):n?n(s):s}var he={},ba=V;Object.defineProperty(he,"__esModule",{value:!0});var Le=he.default=void 0,Sa=ba(H()),_a=G,Ca=(0,Sa.default)((0,_a.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}),"Favorite");Le=he.default=Ca;const Ue=({stars:e=1,colored:a=!1,inline:n=!1})=>t(Ie,{color:a?"warning":void 0,children:[...Array(e).keys()].map((s,r)=>t(Pt,{fontSize:n?"inherit":void 0,sx:n?{verticalAlign:"text-top"}:void 0},r))});var fe={},Da=V;Object.defineProperty(fe,"__esModule",{value:!0});var Ia=fe.default=void 0,wa=Da(H()),Ma=G,Ra=(0,wa.default)((0,Ma.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");Ia=fe.default=Ra;const $a=_.createContext({});function ja({iconProps:e}){const[a,n]=_.useState(0);return _.useEffect(()=>{const s=setInterval(()=>n(r=>r+1),1e3);return()=>clearInterval(s)},[]),t(Ut,{ele:ne[a%ne.length],iconProps:e})}const x=e=>t(ze,{ns:"elementalResonance_gen",key18:e}),oe=e=>t(ze,{ns:"elementalResonance",key18:e}),C=Ae(...ne.map(e=>b[e])),Je=Mt(ie,e=>[`${e}_res_`,w(p.charKey,y(b.ele,4,R(.15)),M.info(`${e}_res_`))]),ka={name:x("ProtectiveCanopy.name"),desc:x("ProtectiveCanopy.desc"),icon:l("span",{children:[t(ja,{iconProps:D})," x4"]}),canShow:e=>e.get(b.ele).value>=4,sections:[{teamBuff:!0,fields:Object.values(Je).map(([e,a])=>({node:a}))}]},[Ba,Ta]=w(p.charKey,y(C,4,y(b.pyro,2,R(.25))),M.info("atk_")),Ea={name:x("FerventFlames.name"),desc:x("FerventFlames.desc"),icon:l("span",{children:[t(X,{...D})," ",t(X,{...D})]}),canShow:e=>e.get(b.pyro).value>=2&&e.get(C).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.cryo"),value:-40,unit:"%"},{node:Ba}]}]},[Na,Aa]=w(p.charKey,y(C,4,y(b.hydro,2,R(.25))),M.info("hp_")),Oa={name:x("SoothingWater.name"),desc:x("SoothingWater.desc"),icon:l("span",{children:[t(ee,{...D})," ",t(ee,{...D})]}),canShow:e=>e.get(b.hydro).value>=2&&e.get(C).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.pyro"),value:-40,unit:"%"},{node:Na}]}]},Qe=["resonance","ShatteringIce"],Ye=F(Qe),[za,Wa]=w(p.charKey,y(C,4,y(b.cryo,2,P(Ye,"on",R(.15)))),M.info("critRate_")),Ha={name:x("ShatteringIce.name"),desc:x("ShatteringIce.desc"),icon:l("span",{children:[t(U,{...D})," ",t(U,{...D})]}),canShow:e=>e.get(b.cryo).value>=2&&e.get(C).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.electro"),value:-40,unit:"%"}]},{teamBuff:!0,path:Qe,value:Ye,name:T("enemyAffected.frozenOrCryo"),header:{title:x("ShatteringIce.name"),icon:t(U,{})},states:{on:{fields:[{node:za}]}}}]},Va={name:x("HighVoltage.name"),desc:x("HighVoltage.desc"),icon:l("span",{children:[t(te,{...D})," ",t(te,{...D})]}),canShow:e=>e.get(b.electro).value>=2&&e.get(C).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.hydro"),value:-40,unit:"%"}]}]},[Ga,Fa]=w(p.charKey,y(C,4,y(b.anemo,2,R(-.15))),M.info("staminaDec_")),[Pa,qa]=w(p.charKey,y(C,4,y(b.anemo,2,R(.1))),M.info("moveSPD_")),[Ka,La]=w(p.charKey,y(C,4,y(b.anemo,2,R(-.05))),M.info("cdRed_")),Ua={name:x("ImpetuousWinds.name"),desc:x("ImpetuousWinds.desc"),icon:l("span",{children:[t(ae,{...D})," ",t(ae,{...D})]}),canShow:e=>e.get(b.anemo).value>=2&&e.get(C).value>=4,sections:[{teamBuff:!0,fields:[{node:Ga},{node:Pa},{node:Ka}]}]},Ze=["resonance","EnduringRock"],Xe=F(Ze),et=["resonance","EnduringRockHit"],tt=F(et),[Ja,Qa]=w(p.charKey,y(C,4,y(b.geo,2,R(.15))),M.info("shield_")),[Ya,Za]=w(p.charKey,y(C,4,y(b.geo,2,P(Xe,"on",R(.15)))),M.info("all_dmg_")),[,Xa]=w(Jt.charKey,Za,M.info("all_dmg_")),[en,tn]=w(p.charKey,y(C,4,y(b.geo,2,P(tt,"on",R(-.2)))),M.info("geo_enemyRes_")),an={name:x("EnduringRock.name"),desc:x("EnduringRock.desc"),icon:l("span",{children:[t(N,{...D})," ",t(N,{...D})]}),canShow:e=>e.get(b.geo).value>=2&&e.get(C).value>=4,sections:[{teamBuff:!0,text:x("EnduringRock.desc"),fields:[{node:Ja}]},{teamBuff:!0,path:Ze,value:Xe,header:{title:x("EnduringRock.name"),icon:t(N,{})},name:T("protectedByShield"),states:{on:{fields:[{node:Oe(Ya,{isTeamBuff:!1})}]}}},{teamBuff:!0,path:et,value:tt,header:{title:x("EnduringRock.name"),icon:t(N,{})},name:oe("EnduringRock.hitCond"),states:{on:{fields:[{node:en},{text:se("duration"),value:15,unit:"s"}]}}}]},at=["resonance","SprawlingCanopy2ele"],nt=F(at),st=["resonance","SprawlingCanopy3ele"],rt=F(st),[nn,sn]=w(p.charKey,y(C,4,y(b.dendro,2,50)),M.info("eleMas")),[rn,on]=w(p.charKey,y(C,4,y(b.dendro,2,P(nt,"on",30))),M.info("eleMas")),[cn,ln]=w(p.charKey,y(C,4,y(b.dendro,2,P(rt,"on",20))),M.info("eleMas")),dn={name:x("SprawlingGreenery.name"),desc:x("SprawlingGreenery.desc"),icon:l("span",{children:[t(A,{...D})," ",t(A,{...D})]}),canShow:e=>e.get(b.dendro).value>=2&&e.get(C).value>=4,sections:[{teamBuff:!0,text:x("SprawlingGreenery.desc"),fields:[{node:nn}]},{teamBuff:!0,path:at,value:nt,header:{title:x("SprawlingGreenery.name"),icon:t(A,{})},name:oe("SprawlingGreenery.cond2ele"),states:{on:{fields:[{node:rn},{text:se("duration"),value:6,unit:"s"}]}}},{teamBuff:!0,path:st,value:rt,header:{title:x("SprawlingGreenery.name"),icon:t(A,{})},name:oe("SprawlingGreenery.cond3ele"),states:{on:{fields:[{node:cn},{text:se("duration"),value:6,unit:"s"}]}}}]},is=[ka,Ea,Oa,Ha,Va,Ua,an,dn],un=Qt({teamBuff:{premod:{...k(Je,([e,a])=>a),atk_:Ta,hp_:Aa,staminaDec_:Fa,moveSPD_:qa,cdRed_:La,shield_:Qa,geo_enemyRes_:tn,eleMas:Oe(Ae(sn,on,ln),{pivot:!0}),all_dmg_:Xa},total:{critRate_:Wa}}});function hn(e,a=0,n,s){const r=j(),[o,i]=Rt(),c=_.useDeferredValue(o),{gender:d}=E(),h=_.useMemo(()=>c&&pn(r,e,a,d,n,s),[c,d,e,r,a,n,s]);return _.useEffect(()=>e?r.chars.follow(e,i):void 0,[e,i,r]),h}class fn{constructor(a){this.data={},a.chars.followAny(n=>{this.removeData(n)})}getData(a){return this.data[a]}cacheData(a,n){this.data[a]=n}removeData(a){delete this.data[a]}}const Z=new Map,Se=e=>{if(Z.has(e))return Z.get(e);const a=new fn(e);return Z.set(e,a),a};function pn(e,a,n=0,s,r,o){if(!a)return;if(!n&&!r&&!o){const f=Se(e).getData(a);if(f)return f}const{teamData:i,teamBundle:c}=mn(e,a,n,r,o)??{};if(!i||!c)return;const d=Yt(i,s,a),h=k(d,(f,u)=>{const{data:m,...S}=c[u];return{...f,...S}});return!n&&!r&&!o&&Se(e).cacheData(a,h),h}function mn(e,a,n=0,s,r){if(!a)return;const o=e.chars.get(a);if(!o)return;const i=gn(e,!0,n,o,r||(e.weapons.get(o.equippedWeapon)??$t()),s??Object.values(o.equippedArtifacts).map(h=>e.arts.get(h)).filter(h=>h));if(!i)return;const c={[a]:i};return{teamData:{[a]:i.data},teamBundle:c}}function gn(e,a=!1,n,s,r,o){const i=q(s.key,e.gender);if(!i)return;const c=Fe(r.key);if(!c)return;const d=Pe.getAllDataOfType(i.weaponTypeKey),h=a?(()=>{const{display:S,...I}=c.data;return re([I,d])})():c.data,f=re([i.data,h,ca]),m=[...Array.isArray(o)?o.map(S=>Zt(S,n)):[o],Xt(s),We(r),f,ea,un];return{character:s,weapon:r,characterSheet:i,weaponSheet:c,data:m}}function vn({art:e,children:a}){const n=t(v,{children:t(ce,{variant:"rectangular",width:100,height:100})}),s=t(_.Suspense,{fallback:n,children:t(yn,{art:e})});return t(Ne,{placement:"top",title:s,disableInteractive:!0,children:a})}function yn({art:e}){const{t:a}=De("statKey_gen"),n=la(e.setKey),{slotKey:s,level:r,rarity:o,mainStatKey:i,substats:c}=e,d=n.getSlotName(s),h=jt.getVariant(i);return l(v,{p:1,children:[l(g,{variant:"h6",children:[t(da,{slotKey:s,iconProps:D})," ",d]}),l(g,{variant:"subtitle1",color:`${h}.main`,children:[t(He,{statKey:i,iconProps:D})," ",a(i)," ",kt(i,o,r)]}),l(g,{variant:"subtitle2",sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t(qt,{stars:o}),l(B,{color:Ge.levelVariant(r),children:["+",r]})," "]}),t(v,{py:1,children:c.map(({value:f,key:u,rolls:m})=>!!(f&&u)&&t(xa,{statKey:u,value:f,color:`roll${Bt(m.length,1,6)}`,prefix:"+"},u))}),t(g,{color:"success.main",children:n.name}),t(Kt,{color:"secondary.main",location:e.location})]})}function xn({artifactObj:e,slotKey:a}){if(!e)return t(W,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:t(v,{sx:{width:"100%",pb:"100%",position:"relative"},children:t(v,{sx:{position:"absolute",width:"70%",height:"70%",left:"50%",top:"50%",transform:"translate(-50%, -50%)",opacity:.7},component:"img",src:ue.slot[a]})})});const{mainStatKey:n,rarity:s,level:r}=e,i=ie.find(c=>e.mainStatKey.includes(c))??"secondary";return t(vn,{art:e,children:l(W,{sx:{display:"flex",flexDirection:"column",position:"relative"},children:[t(v,{component:"img",className:`grad-${s}star`,src:ta(e.setKey,e.slotKey),maxWidth:"100%",maxHeight:"100%"}),t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none"},children:t("strong",{children:t(B,{sx:{p:.5},color:Ge.levelVariant(r),children:l("strong",{children:["+",r]})})})}),t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",bottom:0,right:0},children:t(B,{color:i,sx:{p:.5},children:t(He,{statKey:n,iconProps:{fontSize:"inherit"}})})})]})})}function bn({sheet:e,addlText:a,children:n}){const s=l(_.Suspense,{fallback:t(ce,{variant:"text",width:100}),children:[l(g,{children:[t(ua,{src:ue.weaponTypes[e.weaponType],size:1.5})," ",e.name]}),a]});return t(Ne,{placement:"top",title:s,disableInteractive:!0,children:n})}function Sn({weaponId:e}){const a=ha(e);return a?t(ot,{weapon:a}):null}function ot({weapon:e}){const a=(e==null?void 0:e.key)&&Fe(e.key),n=_.useMemo(()=>a&&e&&aa([a.data,We(e)]),[a,e]);if(!e||!a||!n)return null;const s=l(v,{children:[t(_e,{node:n.get(xe.weapon.main)}),t(_e,{node:n.get(xe.weapon.sub)})]});return l(W,{sx:{height:"100%",maxWidth:128,position:"relative",display:"flex",flexDirection:"column"},children:[t(v,{display:"flex",flexDirection:"column",alignContent:"flex-end",className:`grad-${a.rarity}star`,children:t(bn,{sheet:a,addlText:s,children:t(v,{component:"img",src:na(e.key,e.ascension>=2),maxWidth:"100%",maxHeight:"100%",sx:{mt:"auto"}})})}),t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none"},children:t("strong",{children:t(B,{color:"primary",children:Pe.getLevelString(e)})})}),a.hasRefinement&&t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",bottom:0,right:0},children:t("strong",{children:l(B,{color:"secondary",children:["R",e.refinement]})})})]})}function _e({node:e}){return l(g,{children:[e.info.icon," ",sa(e)]})}function _n({hideWeapon:e=!1}){var n;const{data:a}=_.useContext(Y);return t(v,{children:l($,{container:!0,columns:e?5:6,spacing:.5,children:[!e&&t($,{item:!0,xs:1,height:"100%",children:t(Sn,{weaponId:((n=a.get(p.weapon.id).value)==null?void 0:n.toString())??""})}),t(Cn,{})]})})}function Cn(){const e=j(),{data:a}=_.useContext(Y),n=Tt.map(s=>{var r;return[s,e.arts.get(((r=a.get(p.art[s].id).value)==null?void 0:r.toString())??"")]});return t(le,{children:n.map(([s,r])=>t($,{item:!0,xs:1,children:t(xn,{artifactObj:r,slotKey:s})},s))})}function Dn({weapon:e}){return t(v,{children:l($,{container:!0,columns:e?6:5,spacing:.5,sx:{},children:[e&&t($,{item:!0,xs:1,height:"100%",children:t(ot,{weapon:e})}),t($,{item:!0,xs:5,children:t(Et,{sx:{backgroundColor:"info.main",height:"44px",display:"flex",justifyContent:"center",alignItems:"center"},children:t(g,{children:"TC Build"})})})]})})}function it(e,a,n){const s=Lt(e,a),r=Ve(e,"icon",a);return n&&s?s:r||""}function In({children:e,characterKey:a,onClick:n}){const{gender:s}=E(),{silly:r}=_.useContext(we),o=de(a),i=_.useCallback(d=>t(z,{onClick:n,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:d}),[n]),c=Ve(a,"banner",s);return t(Ke,{condition:!!n,wrapper:i,children:l(v,{display:"flex",position:"relative",className:c?void 0:`grad-${o.rarity}star`,sx:{"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.5,backgroundImage:`url(${c})`,backgroundPosition:"center",backgroundSize:"cover"}},width:"100%",children:[t(v,{flexShrink:1,component:"img",src:it(a,s,r),sx:{maxWidth:"40%"},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1}),t(v,{flexGrow:1,sx:{py:1,pr:1},display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-between",children:e})]})})}function wn({characterKey:e}){const{gender:a}=E(),{data:n}=_.useContext(Y),s=n.get(p.charEle).value,r=n.get(p.lvl).value,o=n.get(p.constellation).value,i=n.get(p.asc).value,c=n.get(p.total.autoBoost).value,d=n.get(p.total.skillBoost).value,h=n.get(p.total.burstBoost).value,f=n.get(p.total.auto).value,u=n.get(p.total.skill).value,m=n.get(p.total.burst).value,S=de(e);return l(le,{children:[t(O,{label:t(g,{variant:"subtitle1",children:t(Me,{characterKey:e,gender:a})}),size:"small",color:s,sx:{opacity:.85}}),l(v,{display:"flex",gap:1,sx:{textShadow:"0 0 5px gray"},alignItems:"center",children:[l(v,{children:[l(g,{component:"span",variant:"h6",whiteSpace:"nowrap",children:["Lv. ",r]}),l(g,{component:"span",variant:"h6",color:"text.secondary",children:["/",Re[i]]})]}),t(g,{component:"span",whiteSpace:"nowrap",sx:{opacity:.85},children:t($e,{color:`roll${o<3?3:o}`,children:t(Ie,{color:"white",children:l("strong",{children:["C",o]})})})})]}),l(v,{display:"flex",gap:1,sx:{opacity:.85},children:[t(O,{size:"small",color:c?"info":"secondary",label:t("strong",{children:f})}),t(O,{size:"small",color:d?"info":"secondary",label:t("strong",{children:u})}),t(O,{size:"small",color:h?"info":"secondary",label:t("strong",{children:m})})]}),t(g,{variant:"h6",lineHeight:1,children:t(Ue,{stars:S.rarity,colored:!0,inline:!0})})]})}function cs({characterKey:e}){const{gender:a}=E(),n=de(e),s=q(e,a);return l(le,{children:[t(O,{label:t(g,{variant:"subtitle1",children:t(Me,{characterKey:e,gender:a})}),size:"small",color:s.elementKey,sx:{opacity:.85}}),t(v,{mt:1,children:t(g,{variant:"h4",children:t($e,{children:"NEW"})})}),t(g,{mt:1.5,children:t(Ue,{stars:n.rarity,colored:!0})})]})}var pe={},Mn=V;Object.defineProperty(pe,"__esModule",{value:!0});var ct=pe.default=void 0,Rn=Mn(H()),$n=G,jn=(0,Rn.default)((0,$n.jsx)("path",{d:"M21.6 18.2 13 11.75v-.91c1.65-.49 2.8-2.17 2.43-4.05-.26-1.31-1.3-2.4-2.61-2.7C10.54 3.57 8.5 5.3 8.5 7.5h2c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5c0 .84-.69 1.52-1.53 1.5-.54-.01-.97.45-.97.99v1.76L2.4 18.2c-.77.58-.36 1.8.6 1.8h18c.96 0 1.37-1.22.6-1.8zM6 18l6-4.5 6 4.5H6z"}),"Checkroom");ct=pe.default=jn;const Ce=ra(Nt({dyn:{...p.art,...p.artSet}})),kn={art:je([...At,...ke],e=>Ce.dyn[e]),artSet:k(p.artSet,(e,a)=>Ce.dyn[a])};function ls(e,a,n){const s={base:{},values:{flower:[],plume:[],goblet:[],circlet:[],sands:[]}},r=new Set;for(const o of e){const i=Be(o.mainStatKey,o.rarity,Math.max(Math.min(a,Ot[o.rarity]),o.level)),c={id:o.id,set:o.setKey,values:{[o.setKey]:1,[o.mainStatKey]:i,...Object.fromEntries(o.substats.map(d=>[d.key,d.key.endsWith("_")?d.accurateValue/100:d.accurateValue]))}};delete c.values[""],s.values[o.slotKey].push(c),Object.keys(c.values).forEach(d=>r.add(d))}if(s.base=je([...r],o=>0),n)for(const o of Object.values(s.values))o.push({id:"",values:{}});return s}function ds(e,a,n){var f;const{artifact:{sets:s},optimization:{target:r,minTotal:o}}=n;if(!r)return{};const i=(f=e[a])==null?void 0:f.target.data[0];if(!i)return{};Object.assign(i,re([i,kn]));const c=Wt(i.display??{},r);if(!c)return{};const d=Object.keys(o).map(u=>i.total[u]).filter(u=>u);let h=be([c,...d],i,({path:[u]})=>u!=="dyn");return h=oa(h,u=>{if(u.operation==="read"&&u.path[0]==="dyn"){const m=s[u.path[1]];if(m)return J(m);if(!ke.includes(u.path[1]))return J(0)}return u},u=>u),h=be(h,{},u=>!1),{nodes:h}}function us(e){const a=new Set;return ia(e,{},n=>{const s=n.path[1];return a.add(s),s},1),a}function hs(e){const{artifact:{slots:a,substats:{stats:n,type:s,rarity:r}}}=e,o=k(n,(d,h)=>Math.ceil(n[h]/Ht(h,r,s))),i=En(a),c=Tn(a);return{minSubLines:c,minOtherRolls:Bn(Object.entries(o),i,c)}}function Bn(e,a,n=4*5){const s=e.reduce((r,[o,i])=>{const c=5-(a[o]??0);return r+Math.min(i,c)},0);return n-s}function Tn(e){return Object.values(e).reduce((a,{rarity:n,level:s})=>{const{high:r,low:o}=Vt[n];return a+(s>=4?r:o)},0)}function En(e){const a={};return Object.values(e).forEach(({statKey:n})=>{a[n]=(a[n]??0)+1},0),a}function Nn(e){const{artifact:{slots:a,substats:{stats:n},sets:s}}=e,r=k(n,(o,i)=>zt(o,i));return Object.values(a).forEach(({statKey:o,rarity:i,level:c})=>r[o]=(r[o]??0)+Be(o,i,c)),{art:k(r,(o,i)=>i.endsWith("_")?R(o):J(o)),artSet:k(s,o=>J(o))}}function fs(e){const{weapon:{key:a,level:n,ascension:s,refinement:r}}=e;return{id:"",location:"",key:a,level:n,ascension:s,refinement:r,lock:!1}}var me={},An=V;Object.defineProperty(me,"__esModule",{value:!0});var lt=me.default=void 0,On=An(H()),zn=G,Wn=(0,On.default)((0,zn.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");lt=me.default=Wn;var ge={},Hn=V;Object.defineProperty(ge,"__esModule",{value:!0});var dt=ge.default=void 0,Vn=Hn(H()),Gn=G,Fn=(0,Vn.default)((0,Gn.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}),"FavoriteBorder");dt=ge.default=Fn;function Pn({characterKey:e,onClick:a,onMouseDown:n,onMouseEnter:s,hoverChild:r,hideFav:o}){const i=qe(e),{favorite:c}=pa(e),{gender:d}=E(),{silly:h}=_.useContext(we),f=q(e,d),u=_.useCallback(()=>a==null?void 0:a(e),[e,a]),m=_.useCallback(L=>t(z,{onClick:u,onMouseDown:n,onMouseEnter:s,children:L}),[u,n,s]),[S,I,K]=Gt();return t(Te,{enterNextDelay:500,enterTouchDelay:500,placement:"top",open:!!r&&S,onClose:K,onOpen:I,title:r,children:t(W,{sx:{maxWidth:128,position:"relative",display:"flex",flexDirection:"column"},children:l(Ke,{condition:!!a||!!n||!!s,wrapper:m,children:[t(v,{display:"flex",className:`grad-${f.rarity}star`,children:t(v,{component:"img",src:it(e,d,h),maxWidth:"100%",maxHeight:"100%",draggable:!1})}),i&&t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",top:0},children:t("strong",{children:l(B,{color:"primary",children:[i.level,"/",Re[i.ascension]]})})}),!o&&t(v,{sx:{position:"absolute",top:0,right:0},children:c?t(Le,{fontSize:"small"}):t(dt,{fontSize:"small"})}),i&&t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",bottom:0,right:0},children:t("strong",{children:l(B,{color:"secondary",children:["C",i.constellation]})})})]})})})}function qn({index:e}){return t(W,{sx:{display:"flex",alignItems:"center",justifyContent:"center",py:"12.5%"},children:t(v,{component:"img",src:ue.team[`team${e+1}`],sx:{width:"75%",height:"auto",opacity:.7}})})}function ps({teamId:e,onClick:a,hoverCard:n=!1,bgt:s}){const r=ma(e),{name:o,description:i,loadoutData:c}=r,d=j(),h=c.map(f=>{if(!f)return;const u=d.teamChars.get(f.teamCharId);if(u)return q(u.key).elementKey});return t(Ee,{bgt:s,sx:{height:"100%"},children:l(v,{sx:f=>({height:"100%",display:"flex",flexDirection:"column",background:`linear-gradient(to right, ${h.map(m=>{if(!m)return"rgba(0,0,0,0)";const S=f.palette[m].main,I=fa(S);return I?`rgba(${I.r},${I.g},${I.b},0.25)`:"rgba(0,0,0,0)"}).map((m,S)=>`${m} ${S*25+12.5}%`).join(", ")})`}),children:[t(z,{onClick:()=>a(),sx:{p:1},children:l(g,{sx:{display:"flex",gap:1},children:[t("span",{children:o})," ",i&&t(Te,{title:t(g,{children:i}),children:t(Ft,{})})]})}),t(v,{sx:{p:1,marginTop:"auto"},children:t($,{container:!0,columns:4,spacing:1,children:c.map((f,u)=>{var I;const m=f==null?void 0:f.teamCharId,S=m&&((I=d.teamChars.get(m))==null?void 0:I.key);return t($,{item:!0,xs:1,height:"100%",children:S?t(z,{onClick:()=>a(S),children:t(Pn,{characterKey:S,hoverChild:n&&t(Kn,{characterKey:S,teamCharId:m,teamId:e}),hideFav:!0})}):t(z,{onClick:()=>a(),children:t(qn,{index:u})})},u)})})})]})})}function Kn({characterKey:e,teamId:a,teamCharId:n}){var L;const s=j(),r=qe(e),{gender:o}=E(),i=q(e,o),{name:c}=ga(n),d=s.teams.getLoadoutDatum(a,n),h=s.teams.getActiveBuildName(d),f=(()=>s.teams.getLoadoutWeapon(d))(),u=(()=>{const{buildType:ut,buildTcId:ve}=d;return ut==="tc"&&ve?Nn(s.buildTcs.get(ve)):Object.values(s.teams.getLoadoutArtifacts(d)).filter(ht=>ht)})(),m=hn(e,void 0,u,f),S=(L=m==null?void 0:m[e])==null?void 0:L.target,I=_.useMemo(()=>r&&i&&{character:r,characterSheet:i,characterDispatch:()=>{}},[r,i]),K=_.useMemo(()=>S&&m&&{data:S,teamData:m},[S,m]);return!I||!K?null:t($a.Provider,{value:I,children:t(Y.Provider,{value:K,children:t(v,{sx:{width:300,m:-1},children:t(_.Suspense,{fallback:t(ce,{variant:"rectangular",width:"100%",height:300}),children:l(Ee,{children:[t(In,{characterKey:e,children:t(wn,{characterKey:e})}),l(v,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:[l(g,{sx:{display:"flex",gap:1,alignItems:"center"},children:[t(lt,{}),t("span",{children:c})]}),l(g,{sx:{display:"flex",gap:1,alignItems:"center"},children:[t(ct,{}),t("span",{children:h})]}),(d==null?void 0:d.buildType)==="tc"&&(d!=null&&d.buildTcId)?t(Dn,{weapon:f}):t(_n,{})]})]})})})})})}export{xn as A,it as B,$a as C,cs as H,va as S,ps as T,Sn as W,Le as a,lt as b,ct as c,Ia as d,Pn as e,ls as f,Nn as g,kn as h,In as i,wn as j,_n as k,hs as l,us as m,fs as n,ds as o,fa as p,os as q,is as r,ga as s,qe as t,ma as u,hn as v,pa as w,vn as x,bn as y,un as z};
