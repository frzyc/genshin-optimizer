(this["webpackJsonpgenshin-optimizer"]=this["webpackJsonpgenshin-optimizer"]||[]).push([[10],{204:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return ee}));var r=a(3),n=a(79),i=a(81),c=a(85),s=a(95),l=a(94),u=a(83),o=a(22),d=a(0),j=a.n(d),b=a(188),f=a(196),h=a(31),m=a(41),O=a(29),x=a(194),g=a(154),v=a(103),y=a(1),S=a(2),p=a(5),k=a.n(p),C=(a(59),a(23)),B=a(6),I=a(52),N=a(54),w=a(13),F={variant:void 0,active:!1,disabled:!1},K=j.a.forwardRef((function(e,t){var a=e.bsPrefix,r=e.active,n=e.disabled,i=e.className,c=e.variant,s=e.action,l=e.as,u=e.eventKey,o=e.onClick,b=Object(S.a)(e,["bsPrefix","active","disabled","className","variant","action","as","eventKey","onClick"]);a=Object(B.a)(a,"list-group-item");var f=Object(d.useCallback)((function(e){if(n)return e.preventDefault(),void e.stopPropagation();o&&o(e)}),[n,o]);return j.a.createElement(N.a,Object(y.a)({ref:t},b,{eventKey:Object(w.b)(u,b.href),as:l||(s?b.href?"a":"button":"div"),onClick:f,className:k()(i,a,r&&"active",n&&"disabled",c&&a+"-"+c,s&&a+"-action")}))}));K.defaultProps=F,K.displayName="ListGroupItem";var A=K,T={variant:void 0,horizontal:void 0},E=j.a.forwardRef((function(e,t){var a,r=Object(C.a)(e,{activeKey:"onSelect"}),n=r.className,i=r.bsPrefix,c=r.variant,s=r.horizontal,l=r.as,u=void 0===l?"div":l,o=Object(S.a)(r,["className","bsPrefix","variant","horizontal","as"]),d=Object(B.a)(i,"list-group");return a=s?!0===s?"horizontal":"horizontal-"+s:null,j.a.createElement(I.a,Object(y.a)({ref:t},o,{as:u,className:k()(n,d,c&&d+"-"+c,a&&d+"-"+a)}))}));E.defaultProps=T,E.displayName="ListGroup",E.Item=A;var M=E,P=a(152),_=a(201),D=a(55);function G(){return new Worker(a.p+"static/js/BuildWorker.90293407.worker.js")}var W=a(93),z=a(99),U=a(90),R=a(88),J=a(86),L=a(124),H=a(102),V=a(87),q=a(89),Q=a(84),X=a(96),Y=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,null,[{key:"splitArtifactsBySlot",value:function(e){var t={},a=function(a){t[a]=Object.values(e).filter((function(e){return e.slotKey===a}))};for(var r in z.d)a(r);return t}},{key:"generateAllPossibleArtifactSetPerm",value:function(e){var t=e.filter((function(e){return e.key})).map((function(e){return e.key}));e.reduce((function(e,t){return t.key?e+t.num:e}),0)<5&&t.push("Other");var a=[],r=W.a.getArtifactSlotKeys();return function n(i,c){if(i>=r.length){var s={};Object.values(c).forEach((function(e){s[e]?s[e]+=1:s[e]=1}));var l,u=!0,o=Object(X.a)(e);try{for(o.s();!(l=o.n()).done;){var d=l.value;if(d.key&&(!s[d.key]||s[d.key]<d.num)){u=!1;break}}}catch(b){o.e(b)}finally{o.f()}u&&a.push(c)}else{var j=r[i];t.forEach((function(e){("Other"===e||z.c[e]&&z.c[e].pieces&&Object.keys(z.c[e].pieces).includes(j))&&(c[j]=e,n(i+1,Object(Q.a)({},c)))}))}}(0,{}),a}},{key:"calculateTotalBuildNumber",value:function(e,t,a){var r=a.filter((function(e){return e.key})).map((function(e){return e.key})),i={};return Object.entries(e).forEach((function(e){var t=Object(n.a)(e,2),a=t[0],c=t[1],s={};c.forEach((function(e){r.includes(e.setKey)?s[e.setKey]=(s[e.setKey]||0)+1:s.Other=(s.Other||0)+1})),i[a]=s})),t.reduce((function(e,t){return e+Object.entries(t).reduce((function(e,t){var a=Object(n.a)(t,2),r=a[0],c=a[1];return i[r]&&i[r][c]?e*i[r][c]:0}),1)}),0)}}]),e}(),Z=a(17),$=a(97),ee=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var c;if(Object(i.a)(this,a),(c=t.call(this,e)).forceUpdateBuildDisplay=function(){return c.forceUpdate()},c.statsDisplayKeys=function(){return["hp","atk","def","ele_mas","crit_rate","crit_dmg","heal_bonu","ener_rech","phy_dmg","ele_dmg","phy_atk","ele_atk"]},c.splitArtifacts=function(){if(!c.state.selectedCharacterId)return{};var e=U.a.getArtifactDatabase();if(Object.entries(e).forEach((function(t){var a=Object(n.a)(t,2),r=a[0],i=a[1];i.lock&&delete e[r],c.state.selectedCharacterId&&i.location&&i.location!==c.state.selectedCharacterId&&delete e[r]})),c.state.setFilters.every((function(e){return e.key}))){var t=c.state.setFilters.map((function(e){return e.key}));Object.entries(e).forEach((function(a){var r=Object(n.a)(a,2),i=r[0],c=r[1];t.includes(c.setKey)&&delete e[i]}))}var r=Y.splitArtifactsBySlot(e);return a.artifactsSlotsToSelectMainStats.forEach((function(e,t){return c.state.mainStat[t]&&(r[e]=r[e].filter((function(e){return e.mainStatKey===c.state.mainStat[t]})))})),r},c.changeMainStat=function(e,t){c.setState((function(a){var r=Object(q.e)(a.mainStat);return r[e]=t,{mainStat:r}}))},c.changeSetFilterKey=function(e,t,a){c.state.setFilters[e].key!==t&&c.setState((function(r){var n=Object(q.e)(r.setFilters),i=0;return a&&a[0]&&(i=parseInt(a[0])),n[e]={key:t,num:i},{setFilters:n}}))},c.dropdownitemsForStar=function(e,t){return W.a.getArtifactSetsByMaxStarEntries(e).map((function(e){var a=Object(n.a)(e,2),i=a[0],s=a[1];if(c.state.setFilters.some((function(e){return e.key===i})))return!1;var l=Object.keys(z.c[i].sets),u=c.state.setFilters.reduce((function(e,a,r){return a.key&&r!==t?e+a.num:e}),0);return!l.every((function(e){return parseInt(e)+u>5}))&&Object(r.jsx)(b.a.Item,{onClick:function(){return c.changeSetFilterKey(t,i,l)},children:s.name},i)}))},c.generateBuilds=function(e,t){c.setState({generatingBuilds:!0,builds:[]});var a=c.state,r=a.setFilters,n=a.asending,i=a.buildFilterKey,s=a.maxBuildsToShow,l=J.a.getCharacter(c.state.selectedCharacterId),u=$.a.createWeaponBundle(l),o=R.a.calculateCharacterWithWeaponStats(l,u),d=W.a.getAllArtifactSetEffectsObj(),j=Object(q.e)(e);Object.values(j).forEach((function(e){e.forEach((function(e){e.mainStatVal=W.a.getMainStatValue(e.mainStatKey,e.numStars,e.level)}))}));var b={splitArtifacts:j,artifactSetPerms:t,initialStats:o,artifactSetEffects:d,setFilters:r,maxBuildsToShow:s,buildFilterKey:i,asending:n},f=new G;f.onmessage=function(a){Z.a.timing({category:"Build Generation",variable:"timing",value:a.data.timing,label:Y.calculateTotalBuildNumber(e,t,c.state.setFilters)});var r=a.data.builds.map((function(e){return R.a.calculateBuildWithObjs(o,e.artifacts)}));c.setState({builds:r,generatingBuilds:!1})},f.postMessage(b)},c.BuildGeneratorEditorCard=function(e){var t=J.a.getCharacterDatabase(),n=J.a.getCharacter(c.state.selectedCharacterId),i=n?n.name:"Character Name",s=c.state.setFilters.reduce((function(e,t){return t.key?e+t.num:e}),0),l=c.splitArtifacts(),d=Y.generateAllPossibleArtifactSetPerm(c.state.setFilters),j=Y.calculateTotalBuildNumber(l,d,c.state.setFilters),y=0===j?Object(r.jsx)(f.a,{variant:"warning",className:"mb-0",children:Object(r.jsxs)("span",{children:["Current configuration will not generate any builds for ",Object(r.jsx)("b",{children:i}),". Please change your Artifact configurations, or add/unlock more Artifacts."]})}):j>c.state.maxBuildsToGenerate?Object(r.jsx)(f.a,{variant:"danger",className:"mb-0",children:Object(r.jsxs)("span",{children:["Current configuration will generate ",Object(r.jsx)("b",{children:j})," builds for ",Object(r.jsx)("b",{children:i}),". Please restrict artifact configuration to reduce builds to less than ",c.state.maxBuildsToGenerate,", or your browser might crash."]})}):Object(r.jsx)(f.a,{variant:"success",className:"mb-0",children:Object(r.jsxs)("span",{children:["Current configuration will generate ",Object(r.jsx)("b",{children:j})," builds for ",Object(r.jsx)("b",{children:i}),"."]})});return Object(r.jsxs)(h.a,{bg:"darkcontent",text:"lightfont",children:[Object(r.jsx)(h.a.Header,{children:"Build Generator"}),Object(r.jsxs)(h.a.Body,{children:[Object(r.jsxs)(m.a,{children:[Object(r.jsxs)(O.a,{children:[Object(r.jsx)("div",{className:"mb-2",children:Object(r.jsxs)(x.a,{title:c.state.selectedCharacterId?i:"Select Character",children:[Object(r.jsx)(b.a.Item,{onClick:function(){return c.setState({selectedCharacterId:"",builds:[]})},children:"No Character"}),Object.values(t).map((function(e,t){return Object(r.jsx)(b.a.Item,{onClick:function(){return c.setState({selectedCharacterId:e.id,builds:[]})},children:e.name},e.name+t)}))]})}),c.state.setFilters.map((function(e,t){return Object(r.jsx)("div",{className:"mb-2",children:Object(r.jsxs)(g.a,{children:[Object(r.jsxs)(x.a,{as:g.a,title:W.a.getArtifactSetName(e.key,"Set (Optional)"),children:[Object(r.jsx)(b.a.Item,{onClick:function(){return c.changeSetFilterKey(t,"")},children:"Unselect Artifact"}),Object(r.jsx)(b.a.ItemText,{children:"Max Rarity \ud83d\udfca\ud83d\udfca\ud83d\udfca\ud83d\udfca\ud83d\udfca"}),c.dropdownitemsForStar(5,t),Object(r.jsx)(b.a.Divider,{}),Object(r.jsx)(b.a.ItemText,{children:"Max Rarity \ud83d\udfca\ud83d\udfca\ud83d\udfca\ud83d\udfca"}),c.dropdownitemsForStar(4,t),Object(r.jsx)(b.a.Divider,{}),Object(r.jsx)(b.a.ItemText,{children:"Max Rarity \ud83d\udfca\ud83d\udfca\ud83d\udfca"}),c.dropdownitemsForStar(3,t)]}),Object(r.jsx)(x.a,{as:g.a,title:"".concat(e.num,"-set"),disabled:!e.key||s>=5,children:e.key&&W.a.getArtifactSetEffectsObj(e.key)&&Object.keys(W.a.getArtifactSetEffectsObj(e.key)).map((function(a){var n=c.state.setFilters.reduce((function(t,a){return a.key&&a.key!==e.key?t+a.num:t}),0);return parseInt(a)+n<=5&&Object(r.jsx)(b.a.Item,{onClick:function(){return c.setState((function(e){var r=Object(q.e)(e.setFilters);return r[t].num=parseInt(a),{setFilters:r}}))},children:"".concat(a,"-set")},a)}))})]})},t)}))]}),Object(r.jsxs)(O.a,{children:[Object(r.jsx)("h5",{children:"Artifact Main Stat (Optional)"}),a.artifactsSlotsToSelectMainStats.map((function(e,t){return Object(r.jsxs)("div",{className:"text-inline mb-1 d-flex justify-content-between",children:[Object(r.jsx)("h6",{className:"d-inline mr-2",children:W.a.getArtifactSlotNameWithIcon(e)}),Object(r.jsxs)(x.a,{title:c.state.mainStat[t]?V.a.getStatNameWithPercent(c.state.mainStat[t]):"Select a mainstat",className:"d-inline",children:[Object(r.jsx)(b.a.Item,{onClick:function(){return c.changeMainStat(t,"")},children:"No MainStat"}),z.d[e].stats.map((function(e){return Object(r.jsx)(b.a.Item,{onClick:function(){return c.changeMainStat(t,e)},children:V.a.getStatNameWithPercent(e)},e)}))]})]},e)}))]})]}),Object(r.jsxs)(m.a,{className:"d-flex justify-content-between mb-2",children:[Object(r.jsx)(O.a,{xs:"auto",children:Object(r.jsx)(v.a,{className:"h-100",disabled:!c.state.selectedCharacterId||j>c.state.maxBuildsToGenerate||c.state.generatingBuilds,variant:c.state.selectedCharacterId&&j<=c.state.maxBuildsToGenerate?"success":"danger",onClick:function(){return setTimeout((function(){c.generateBuilds(l,d)}),0)},children:Object(r.jsx)("span",{children:"Generate Builds"})})}),Object(r.jsx)(O.a,{xs:"auto",children:Object(r.jsxs)(g.a,{children:[Object(r.jsx)(x.a,{disabled:!c.state.selectedCharacterId,title:"Sort by ".concat(V.a.getStatNameWithPercent(c.state.buildFilterKey)),as:g.a,children:c.state.selectedCharacterId&&c.statsDisplayKeys().map((function(e){return"ele_dmg"!==e&&"ele_atk"!==e||(e="".concat(R.a.getElementalKey(n.characterKey),"_").concat(e)),Object(r.jsx)(b.a.Item,{onClick:function(){return c.setState({buildFilterKey:e})},children:V.a.getStatNameWithPercent(e)},e)}))}),Object(r.jsx)(v.a,{onClick:function(){return c.setState((function(e){return{asending:!e.asending}}))},children:Object(r.jsx)(o.a,{icon:c.state.asending?u.u:u.v,className:"fa-fw"})})]})})]}),Object(r.jsx)(m.a,{children:Object(r.jsx)(O.a,{children:c.state.selectedCharacterId&&y})})]})]})},c.ArtifactDisplayItem=function(e){var t=e.build,a=e.character;return Object(r.jsx)("div",{children:Object(r.jsxs)(M.Item,{variant:e.index%2?"customdark":"customdarker",className:"text-white",action:!0,onClick:function(){return c.setState({modalBuild:t})},children:[Object(r.jsx)(m.a,{children:Object(r.jsx)(O.a,{children:Object.entries(t.setToSlots).sort((function(e,t){var a=Object(n.a)(e,2),r=(a[0],a[1]),i=Object(n.a)(t,2);i[0];return i[1].length-r.length})).map((function(e){var t=Object(n.a)(e,2),a=t[0],i=t[1];return Object(r.jsxs)(P.a,{variant:"primary",className:"mr-2",children:[i.map((function(e){return W.a.getArtifactSlotIcon(e)}))," ",W.a.getArtifactSetName(a)]},a)}))})}),Object(r.jsx)(m.a,{children:c.statsDisplayKeys().map((function(e){var n;"ele_dmg"!==e&&"ele_atk"!==e||(e="".concat(R.a.getElementalKey(a.characterKey),"_").concat(e));var i=V.a.getStatUnit(e);return Object(r.jsx)(O.a,{className:"text-nowrap",xs:12,sm:6,md:4,lg:3,children:Object(r.jsxs)("span",{children:[V.a.getStatName(e),": ",Object(r.jsxs)("span",{className:"text-warning",children:[null===(n=t.finalStats[e])||void 0===n?void 0:n.toFixed(V.a.fixedUnit(e)),i]})]})},e)}))})]})})},c.BuildModal=function(e){var t=e.build,a=e.character;return t?Object(r.jsx)(_.a,{show:null!==c.state.modalBuild,onHide:function(){return c.setState({modalBuild:null})},size:"xl",dialogAs:D.a,className:"pt-3 pb-3",children:Object(r.jsx)(L.a,{characterToEdit:a,newBuild:t,onClose:function(){return c.setState({modalBuild:null})},forceUpdate:c.forceUpdateBuildDisplay})}):null},Object(H.a)(),c.state=a.getInitialState(),e.location.selectedCharacterId)c.state=a.getInitialState(),e.location.selectedCharacterId&&(c.state.selectedCharacterId=e.location.selectedCharacterId);else{var s=Object(q.i)("BuildsDisplay.state");if(s){var l=J.a.getCharacter(s.selectedCharacterId);s&&l&&(c.state=s)}}return Z.a.pageview("/build"),c}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(){var e=Object(q.e)(this.state);e.builds=[],delete e.generatingBuilds,delete e.modalBuild,Object(q.j)("BuildsDisplay.state",e)}},{key:"render",value:function(){var e=this,t=J.a.getCharacter(this.state.selectedCharacterId),a=t?t.name:"Character Name";return Object(r.jsxs)(D.a,{children:[Object(r.jsx)(this.BuildModal,{build:this.state.modalBuild,character:t}),Object(r.jsx)(m.a,{className:"mt-2 mb-2",children:Object(r.jsx)(O.a,{children:Object(r.jsx)(this.BuildGeneratorEditorCard,{})})}),Object(r.jsx)(m.a,{className:"mb-2",children:Object(r.jsx)(O.a,{children:Object(r.jsxs)(h.a,{bg:"darkcontent",text:"lightfont",children:[Object(r.jsx)(h.a.Header,{children:this.state.selectedCharacterId?"Showing ".concat(this.state.builds.length," Builds generated for ").concat(a):"Select a character to generate builds."}),Object(r.jsx)(M,{children:this.state.builds.map((function(a,n){return n<e.state.maxBuildsToShow&&Object(r.jsx)(e.ArtifactDisplayItem,{build:a,character:t,index:n},Object.values(a.artifactIds).join("_"))}))})]})})})]})}}]),a}(j.a.Component);ee.initialState={builds:[],generatingBuilds:!1,selectedCharacterId:"",sandsMainKey:"",gobletMainKey:"",circletMainkey:"",setFilters:[{key:"",num:0},{key:"",num:0},{key:"",num:0}],mainStat:["","",""],buildFilterKey:"atk",asending:!1,modalBuild:null,maxBuildsToShow:100,maxBuildsToGenerate:5e5},ee.maxBuildsToShowList=[100,50,25,5],ee.maxBuildsToGenerateList=[5e4,1e4,5e3,1e3,500,100],ee.getInitialState=function(){return JSON.parse(JSON.stringify(ee.initialState))},ee.artifactsSlotsToSelectMainStats=["sands","goblet","circlet"]}}]);
//# sourceMappingURL=10.8e46b79d.chunk.js.map