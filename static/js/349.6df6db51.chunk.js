!function(){"use strict";var e={18349:function(e,n,r){var t=r(37762),a=r(93433),i=r(1413),o=r(74165),u=r(29439);function s(e,n){if(e&&n)return!Array.isArray(n)&&console.error(n),n.reduce((function(e,n){return null===e||void 0===e?void 0:e[n]}),e)}function c(e,n){return Object.fromEntries(e.map((function(e,r){return[e,n(e,r)]})))}function l(e,n){return Object.fromEntries(e.map((function(e,r){return n(e,r)})))}function f(e,n){return Object.fromEntries(Object.entries(e).map((function(e,r){var t=(0,u.Z)(e,2),a=t[0],i=t[1];return[a,n(i,a,r)]})))}var d=(0,o.Z)().mark((function e(n,r){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n;case 1:if(!(t<=r)){e.next=7;break}return e.next=4,t;case 4:t++,e.next=1;break;case 7:case"end":return e.stop()}}),e)}));function p(e,n){return(0,a.Z)(d(e,n))}function h(e){throw new Error("Should not reach this with value ".concat(e))}v(NaN,{name:"TODO"}),m(1),m(0),v("none");function v(e,n){return"number"===typeof e?{operation:"const",operands:[],type:"number",value:e,info:n}:{operation:"const",operands:[],type:"string",value:e,info:n}}function m(e,n){return e>=Number.MAX_VALUE/100&&(e=1/0),e<=-Number.MAX_VALUE/100&&(e=-1/0),v(e,(0,i.Z)({unit:"%"},n))}function g(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return{operation:"min",operands:k(n)}}function b(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return{operation:"max",operands:k(n)}}function w(e,n){return{operation:"read",operands:[],path:e,info:n,type:"number"}}function k(e){return e.map((function(e){return"object"===typeof e?e:v(e)}))}function Z(e,n,r){var t=new Set,a=new Set;e.forEach((function e(i){a.has(i)||(t.has(i)?console.error("Found cyclical dependency during formula traversal"):(t.add(i),n(i),i.operands.forEach(e),r(i),t.delete(i),a.add(i)))}))}function y(e,n,r){var t=new Set,a=new Map,o=new Map;function u(e){var s=a.get(e);if(s)return s;s=n(e);var c=o.get(s);return c||(t.has(s)?(console.error("Found cyclical dependency during formula mapping"),v(NaN)):(t.add(s),c=r(function(e){var n=e.operands.map(u);return x(n,e.operands)?e:(0,i.Z)((0,i.Z)({},e),{},{operands:n})}(s),e),t.delete(s),a.set(e,c),o.set(s,c),c))}var s=e.map(u);return x(s,e)?e:s}function x(e,n){return void 0===e?void 0===n:void 0!==n&&(e.length===n.length&&e.every((function(e,r){return e===n[r]})))}var S={min:function(e){return Math.min.apply(Math,(0,a.Z)(e))},max:function(e){return Math.max.apply(Math,(0,a.Z)(e))},add:function(e){return e.reduce((function(e,n){return e+n}),0)},mul:function(e){return e.reduce((function(e,n){return e*n}),1)}},M=(0,i.Z)((0,i.Z)({},S),{},{res:function(e){var n=(0,u.Z)(e,1)[0];return n<0?1-n/2:n>=.75?1/(4*n+1):1-n},sum_frac:function(e){return e[0]/e.reduce((function(e,n){return e+n}))},threshold:function(e){var n=(0,u.Z)(e,4),r=n[0],t=n[1],a=n[2],i=n[3];return r>=t?a:i}}),O=new Set(Object.keys(S));function j(e){return y(e,(function(e){return e}),(function(e){var n=e;if(O.has(e.operation)){var r=e,t=r.operation,a=!1,o=r.operands.flatMap((function(e){return e.operation===t?(a=!0,e.operands):[e]}));n=a?(0,i.Z)((0,i.Z)({},r),{},{operands:o}):r}return n}))}function E(e){function n(e){var n,r=new Map,a=(0,t.Z)(e);try{for(a.s();!(n=a.n()).done;){var i,o=n.value;r.set(o,(null!==(i=r.get(o))&&void 0!==i?i:0)+1)}}catch(u){a.e(u)}finally{a.f()}return r}for(var r={common:{counts:new Map,formulas:new Set,operation:"add"}},o=function(){for(var o,s=void 0,c={operation:r.common.operation,operands:(o=r.common.counts,(0,a.Z)(o).flatMap((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return Array(t).fill(r)})))},l=new Map,f=0,d=Object.keys(S);f<d.length;f++){var p=d[f];l.set(p,[])}if(e=y(e,(function(e){if(r.common.formulas.has(e)){var n=e,t=new Map(r.common.counts),a=n.operands.filter((function(e){var n=t.get(e);return!n||(t.set(e,n-1),!1)}));return a.length?(a.push(c),(0,i.Z)((0,i.Z)({},n),{},{operands:a})):c}return e}),(function(e){if(!O.has(e.operation))return e;var r=e;if(s){if(s.operation===r.operation){var a,i=n(r.operands),o=new Map,c=s.counts,f=0,d=(0,t.Z)(i.entries());try{for(d.s();!(a=d.n()).done;){var p,h=(0,u.Z)(a.value,2),v=h[0],m=h[1],g=Math.min(m,null!==(p=c.get(v))&&void 0!==p?p:0);g?(o.set(v,g),f+=g):o.delete(v)}}catch(C){d.e(C)}finally{d.f()}f>1&&(s.counts=o,s.formulas.add(r))}}else{var b,w=l.get(r.operation),k=n(r.operands),Z=(0,t.Z)(w);try{for(Z.s();!(b=Z.n()).done;){var y,x=(0,u.Z)(b.value,2),S=x[0],M=x[1],j=0,E=new Map,F=(0,t.Z)(M.entries());try{for(F.s();!(y=F.n()).done;){var T,A=(0,u.Z)(y.value,2),B=A[0],N=A[1],R=Math.min(N,null!==(T=k.get(B))&&void 0!==T?T:0);R&&(E.set(B,R),j+=R)}}catch(C){F.e(C)}finally{F.f()}if(j>1){s={counts:E,formulas:new Set([r,S]),operation:r.operation},l.clear();break}}}catch(C){Z.e(C)}finally{Z.f()}s||w.push([r,k])}return r})),!s)return"break";r.common=s};;){if("break"===o())break}return e}function F(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!1},o={data:[],processed:new Map},c=new Map([[o,new Map]]);function l(e,n){var f,d=n.processed.get(e);if(d)return d;var p,m=e.operation;switch(m){case"const":return e;case"add":case"mul":case"max":case"min":var g=M[m],b=[],w=e.operands.filter((function(e){var r=l(e,n);return"const"!==r.operation||(b.push(r.value),!1)})).map((function(e){return l(e,n)})),k=g(b);if(isFinite(k)){if("mul"===m&&0===k){p=v(k);break}}else if("mul"!==m&&("max"!==m||k>0)&&("min"!==m||k<0)){p=v(k);break}k!==g([])&&w.push(v(k)),p=w.length<=1?null!==(f=w[0])&&void 0!==f?f:v(g([])):{operation:m,operands:w};break;case"res":case"sum_frac":var Z=e.operands.map((function(e){return l(e,n)})),y=M[m];p=Z.every((function(e){return"const"===e.operation}))?v(y(Z.map((function(e){return e.value})))):(0,i.Z)((0,i.Z)({},e),{},{operands:Z});break;case"lookup":var x=l(e.operands[0],n);if("const"===x.operation){var S,O=null!==(S=e.table[x.value])&&void 0!==S?S:e.operands[1];if(O){p=l(O,n);break}}throw new Error("Unsupported ".concat(m," node while folding"));case"prio":var j=e.operands.find((function(e){var r=l(e,n);if("const"!==r.operation)throw new Error("Unsupported ".concat(m," node while folding"));return void 0!==r.value}));p=j?l(j,n):v(void 0);break;case"small":var E,F,T=void 0,A=(0,t.Z)(e.operands);try{for(A.s();!(F=A.n()).done;){var B,N=l(F.value,n);if("const"!==N.operation)throw new Error("Unsupported ".concat(m," node while folding"));(void 0===(null===(B=T)||void 0===B?void 0:B.value)||void 0!==N.value&&N.value<T.value)&&(T=N)}}catch(J){A.e(J)}finally{A.f()}p=null!==(E=T)&&void 0!==E?E:v(void 0);break;case"match":var R=e.operands.map((function(e){return l(e,n)})),C=(0,u.Z)(R,4),D=C[0],P=C[1],U=C[2],K=C[3];if("const"!==D.operation||"const"!==P.operation)throw new Error("Unsupported ".concat(m," node while folding"));p=D.value===P.value?U:K;break;case"threshold":var z=e.operands.map((function(e){return l(e,n)})),G=(0,u.Z)(z,4),W=G[0],q=G[1],H=G[2],L=G[3];p="const"===H.operation&&"const"===L.operation&&H.value===L.value?H:"const"===W.operation&&"const"===q.operation?W.value>=q.value?H:L:(0,i.Z)((0,i.Z)({},e),{},{operands:[W,q,H,L]});break;case"subscript":var V=e.operands.map((function(e){return l(e,n)})),_=(0,u.Z)(V,1)[0];p="const"===_.operation?v(e.list[_.value]):(0,i.Z)((0,i.Z)({},e),{},{operands:[_]});break;case"read":var I=n.data.map((function(n){return s(n,e.path)})).filter((function(e){return e}));if(0===I.length)if(r(e)){var Y=e.accu;p=void 0===Y||"small"===Y?"string"===e.type?v(void 0):v(NaN):v(M[Y]([]))}else p=e;else p=void 0===e.accu||1===I.length?l(I[I.length-1],n):l({operation:e.accu,operands:I},n);break;case"data":e.reset&&(n=o);var X=c.get(n),$=X.get(e.data);$||($={data:[].concat((0,a.Z)(n.data),[e.data]),processed:new Map},c.set($,new Map),X.set(e.data,$)),p=l(e.operands[0],$);break;default:h(m)}return p.info&&delete(p=(0,i.Z)({},p)).info,n.processed.set(e,p),p}var f={data:[n],processed:new Map};return c.set(f,new Map),c.get(o).set(n,f),e.map((function(e){return l(e,f)}))}var T=["flower","plume","sands","goblet","circlet"],A=(["physical"].concat(["anemo","geo","electro","hydro","pyro","cryo","dendro"]),["Albedo","Aloy","Amber","AratakiItto","Barbara","Beidou","Bennett","Candace","Chongyun","Collei","Cyno","Diluc","Diona","Dori","Eula","Fischl","Ganyu","Gorou","HuTao","Jean","KaedeharaKazuha","Kaeya","KamisatoAyaka","KamisatoAyato","Keqing","Klee","KujouSara","KukiShinobu","Lisa","Mona","Nilou","Ningguang","Noelle","Qiqi","RaidenShogun","Razor","Rosaria","SangonomiyaKokomi","Sayu","Shenhe","ShikanoinHeizou","Sucrose","Tartaglia","Thoma","Tighnari","Venti","Xiangling","Xiao","Xingqiu","Xinyan","YaeMiko","Yanfei","Yelan","Yoimiya","YunJin","Zhongli"]),B=([].concat(A,["Traveler"]),["TravelerAnemo","TravelerGeo","TravelerElectro","TravelerDendro"]);[].concat(A,B),[].concat(A,["TravelerAnemoF","TravelerGeoF","TravelerElectroF","TravelerDendroF"],["TravelerAnemoM","TravelerGeoM","TravelerElectroM","TravelerDendroM"]),[].concat(["AmenomaKageuchi","AquilaFavonia","BlackcliffLongsword","CinnabarSpindle","CoolSteel","KagotsurubeIsshin","DarkIronSword","DullBlade","FavoniusSword","FesteringDesire","FilletBlade","FreedomSworn","HaranGeppakuFutsu","HarbingerOfDawn","IronSting","KeyOfKhajNisut","LionsRoar","MistsplitterReforged","PrimordialJadeCutter","PrototypeRancour","RoyalLongsword","SacrificialSword","SapwoodBlade","SilverSword","SkyriderSword","SkywardBlade","SummitShaper","SwordOfDescension","TheAlleyFlash","TheBlackSword","TheFlute","TravelersHandySword","XiphosMoonlight"],["Akuoumaru","BlackcliffSlasher","BloodtaintedGreatsword","DebateClub","FavoniusGreatsword","FerrousShadow","ForestRegalia","KatsuragikiriNagamasa","LithicBlade","LuxuriousSeaLord","MakhairaAquamarine","OldMercsPal","PrototypeArchaic","Rainslasher","RedhornStonethresher","RoyalGreatsword","SacrificialGreatsword","SerpentSpine","SkyriderGreatsword","SkywardPride","SnowTombedStarsilver","SongOfBrokenPines","TheBell","TheUnforged","WasterGreatsword","Whiteblind","WhiteIronGreatsword","WolfsGravestone"],["BeginnersProtector","BlackcliffPole","BlackTassel","CalamityQueller","CrescentPike","Deathmatch","DragonsBane","DragonspineSpear","EngulfingLightning","FavoniusLance","Halberd","IronPoint","KitainCrossSpear","LithicSpear","MissiveWindspear","Moonpiercer","PrimordialJadeWingedSpear","PrototypeStarglitter","RoyalSpear","SkywardSpine","StaffOfHoma","StaffOfTheScarletSands","TheCatch","VortexVanquisher","WavebreakersFin","WhiteTassel"],["AlleyHunter","AmosBow","AquaSimulacra","BlackcliffWarbow","CompoundBow","ElegyForTheEnd","EndOfTheLine","FadingTwilight","FavoniusWarbow","Hamayumi","HuntersBow","HuntersPath","KingsSquire","Messenger","MitternachtsWaltz","MouunsMoon","PolarStar","Predator","PrototypeCrescent","RavenBow","RecurveBow","RoyalBow","Rust","SacrificialBow","SeasonedHuntersBow","SharpshootersOath","SkywardHarp","Slingshot","TheStringless","TheViridescentHunt","ThunderingPulse","WindblumeOde"],["ApprenticesNotes","BlackcliffAgate","DodocoTales","EmeraldOrb","EverlastingMoonglow","EyeOfPerception","FavoniusCodex","Frostbearer","FruitOfFulfillment","HakushinRing","KagurasVerity","LostPrayerToTheSacredWinds","MagicGuide","MappaMare","MemoryOfDust","OathswornEye","OtherworldlyStory","PocketGrimoire","PrototypeAmber","RoyalGrimoire","SacrificialFragments","SkywardAtlas","SolarPearl","TheWidsith","ThrillingTalesOfDragonSlayers","TwinNephrite","WanderingEvenstar","WineAndSong"]);var N=(0,o.Z)().mark(V),R=(0,o.Z)().mark(I);function C(e,n,r,t,a,o){for(var u=o,s={pruneNodeRange:!0},c={pruneNodeRange:!0},l={reaffine:!0},f={pruneOrder:!0,pruneArtRange:!0,pruneNodeRange:!0},d=0;Object.values(u).some((function(e){return e}))&&d++<20;){if(u.pruneOrder){delete u.pruneOrder;var p=P(r,t,a);r!==p&&(r=p,u=(0,i.Z)((0,i.Z)({},u),s))}if(u.pruneArtRange){delete u.pruneArtRange;var h=U(e,r,n);r!==h&&(r=h,u=(0,i.Z)((0,i.Z)({},u),c))}if(u.pruneNodeRange){delete u.pruneNodeRange;var v=K(e,r);e!==v&&(e=v,u=(0,i.Z)((0,i.Z)({},u),l))}if(u.reaffine){delete u.reaffine;var m=D(e,r),g=m.nodes,b=m.arts;e===g&&r===b||(e=g,r=b,u=(0,i.Z)((0,i.Z)({},u),f))}}return{nodes:e,arts:r}}function D(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new Set,s=new Set;function l(e,n){n?o.add(e):e.operands.forEach((function(e){var n=e;o.has(n)&&s.add(n)}))}var d=new Set;if(Z(e,(function(e){}),(function(e){var n=e,r=n.operation;switch(r){case"read":if("number"!==n.type||"dyn"!==n.path[0]||"add"!==n.accu)throw new Error("Found unsupported ".concat(r," node at path ").concat(n.path," when computing affine nodes"));d.add(n.path[1]),l(n,!0);break;case"add":l(n,n.operands.every((function(e){return o.has(e)})));break;case"mul":var t=n.operands.filter((function(e){return"const"!==e.operation}));l(n,0===t.length||1===t.length&&o.has(t[0]));break;case"const":if("string"===typeof n.value||void 0===n.value)throw new Error("Found constant ".concat(n.value," while compacting"));l(n,!0);break;case"res":case"threshold":case"sum_frac":case"max":case"min":l(n,!1);break;case"data":case"subscript":case"lookup":case"match":throw new Error("Found unsupported ".concat(r," node when computing affine nodes"));default:h(r)}})),(0,a.Z)(s).every((function(e){var n=e.operation;return"read"===n||"const"===n}))&&Object.keys(n.base).length===d.size)return{nodes:e,arts:n};var p=-1;function m(){for(;d.has("".concat(++p)););return"".concat(p)}e.forEach((function(e){return o.has(e)&&s.add(e)}));var g=(0,a.Z)(s).filter((function(e){return"const"!==e.operation})),b=new Map(g.map((function(e){return[e,r||"read"!==e.operation||"dyn"!==e.path[0]?(0,i.Z)((0,i.Z)({},w(["dyn","".concat(m())])),{},{accu:"add"}):e]})));function k(e){var n=F((0,a.Z)(b.keys()),{dyn:f(e,(function(e){return v(e)}))},(function(e){return!0}));return Object.fromEntries((0,a.Z)(b.values()).map((function(e,r){return[e.path[1],n[r].value]})))}for(var x={nodes:e=y(e,(function(e){var n;return null!==(n=b.get(e))&&void 0!==n?n:e}),(function(e){return e})),arts:{base:k(n.base),values:c(T,(function(e){return n.values[e].map((function(e){return{id:e.id,set:e.set,values:k(e.values)}}))}))}},S=Object.entries(k({})),M=0,O=Object.values(x.arts.values);M<O.length;M++){var j,E=O[M],A=(0,t.Z)(E);try{for(A.s();!(j=A.n()).done;){var B,N=j.value.values,R=(0,t.Z)(S);try{for(R.s();!(B=R.n()).done;){var C=(0,u.Z)(B.value,2),D=C[0],P=C[1];N[D]-=P}}catch(U){R.e(U)}finally{R.f()}}}catch(U){A.e(U)}finally{A.f()}}return x}function P(e,n,r){var t,a=!1,i=!(null!==(t=r.rainbow)&&void 0!==t&&t.length),o=new Set(Object.entries(r).filter((function(e){var n=(0,u.Z)(e,2);n[0];return n[1].length})).map((function(e){return(0,u.Z)(e,1)[0]}))),s=new Set(Object.entries(r).filter((function(e){var n=(0,u.Z)(e,2),r=(n[0],n[1]);return r.includes(2)&&!r.includes(4)})).map((function(e){return(0,u.Z)(e,1)[0]}))),l=c(T,(function(r){var t=e.values[r],c=t.filter((function(e){var r=0;return t.every((function(t){var a=Object.entries(t.values).every((function(n){var r=(0,u.Z)(n,2),t=r[0];return r[1]>=e.values[t]})),c=Object.entries(t.values).some((function(n){var r=(0,u.Z)(n,2),t=r[0];return r[1]>e.values[t]}));return a&&(c||t.id>e.id)&&(i&&!o.has(t.set)&&!s.has(e.set)||e.set===t.set)&&r++,r<n}))}));return c.length!==t.length&&(a=!0),c}));return a?{base:e.base,values:l}:e}function U(e,n,r){for(var t=Object.fromEntries(Object.entries(n.base).map((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return[r,{min:t,max:t}]}))),a={arts:n},i=function(){var n=c(T,(function(e){return G(a.arts.values[e])})),i=c(T,(function(e){return z(Object.entries(n).map((function(n){return n[0]===e?t:n[1]})).filter((function(e){return e})))})),o=!1,u=c(T,(function(n){var t=a.arts.values[n].filter((function(t){var a=z([G([t]),i[n]]),o=W(e,a);return e.every((function(e,n){var t;return o.get(e).max>=(null!==(t=r[n])&&void 0!==t?t:-1/0)}))}));return t.length!==a.arts.values[n].length&&(o=!0),t}));if(!o)return"break";a.arts={base:a.arts.base,values:u}};;){if("break"===i())break}return a.arts}function K(e,n){var r=W(e,z([Object.fromEntries(Object.entries(n.base).map((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return[r,{min:t,max:t}]})))].concat((0,a.Z)(Object.values(n.values).map((function(e){return G(e)}))))));return y(e,(function(e){var n=r.get(e),t=n.min;if(t===n.max)return v(t);var i=e.operation,o=e.operands.map((function(e){return r.get(e)}));switch(i){case"threshold":var s=(0,u.Z)(o,4),c=s[0],l=s[1],f=s[2],d=s[3];if(c.min>=l.max)return e.operands[2];if(c.max<l.min)return e.operands[3];if(f.max===f.min&&d.max===d.min&&f.min===d.min&&isFinite(f.min))return v(f.max);break;case"min":var p=e.operands.filter((function(e,n){var r=o[n];return o.every((function(e,n){return r.min<=e.max}))}));if(p.length<o.length)return g.apply(void 0,(0,a.Z)(p));break;case"max":var h=e.operands.filter((function(e,n){var r=o[n];return o.every((function(e){return r.max>=e.min}))}));if(h.length<o.length)return b.apply(void 0,(0,a.Z)(h))}return e}),(function(e){return e}))}function z(e){var n={};return e.forEach((function(e){Object.entries(e).forEach((function(e){var r=(0,u.Z)(e,2),t=r[0],a=r[1];n[t]?(n[t].min+=a.min,n[t].max+=a.max):n[t]=(0,i.Z)({},a)}))})),n}function G(e){var n={};return e.length&&(Object.keys(e[0].values).filter((function(n){return e.every((function(e){return e.values[n]}))})).forEach((function(r){return n[r]={min:e[0].values[r],max:e[0].values[r]}})),e.forEach((function(e){for(var r=e.values,t=0,a=Object.entries(r);t<a.length;t++){var i=(0,u.Z)(a[t],2),o=i[0],s=i[1];n[o]?(n[o].max<s&&(n[o].max=s),n[o].min>s&&(n[o].min=s)):n[o]={min:0,max:s}}}))),n}function W(e,n){var r=new Map;return Z(e,(function(e){}),(function(e){var t,a,i=e,o=i.operation,s=i.operands.map((function(e){return r.get(e)}));switch(o){case"read":if("dyn"!==i.path[0])throw new Error("Found non-dyn path ".concat(i.path," while computing range"));a=null!==(t=n[i.path[1]])&&void 0!==t?t:{min:0,max:0};break;case"const":a=q([i.value]);break;case"subscript":a=q(i.list);break;case"add":case"min":case"max":a={min:M[o](s.map((function(e){return e.min}))),max:M[o](s.map((function(e){return e.max})))};break;case"res":a={min:M[o]([s[0].max]),max:M[o]([s[0].min])};break;case"mul":a=s.reduce((function(e,n){return q([e.min*n.min,e.min*n.max,e.max*n.min,e.max*n.max])}));break;case"threshold":a=s[0].min>=s[1].max?s[2]:s[0].max<s[1].min?s[3]:q([],[s[2],s[3]]);break;case"sum_frac":var c=(0,u.Z)(s,2),l=c[0],f=c[1],d={min:l.min+f.min,max:l.max+f.max};a=d.min<=0&&d.max>=0?l.min<=0&&l.max>=0?{min:NaN,max:NaN}:{min:-1/0,max:1/0}:q([l.min/d.min,l.min/d.max,l.max/d.min,l.max/d.max]);break;case"data":case"lookup":case"match":throw new Error("Unsupported ".concat(o," node"));default:h(o)}r.set(i,a)})),r}function q(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Math.max.apply(Math,(0,a.Z)(e).concat((0,a.Z)(n.map((function(e){return e.max}))))),t=Math.min.apply(Math,(0,a.Z)(e).concat((0,a.Z)(n.map((function(e){return e.min})))));return{min:t,max:r}}function H(e,n){return{base:e.base,values:c(T,(function(r){var t=n[r];switch(t.kind){case"id":return e.values[r].filter((function(e){return t.ids.has(e.id)}));case"exclude":return e.values[r].filter((function(e){return!t.sets.has(e.set)}));case"required":return e.values[r].filter((function(e){return t.sets.has(e.set)}))}}))}}function L(e){return T.reduce((function(n,r){return n*e.values[r].length}),1)}function V(e,n){var r,i,s,c,l,d,p;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:r=f(n.values,(function(e){return new Set(e.map((function(e){return e.set})))})),i=(0,t.Z)(e),o.prev=2,i.s();case 4:if((s=i.n()).done){o.next=19;break}c=s.value,l=function(){var e=(0,u.Z)(p[d],2),n=e[0],t=e[1],i=r[n];switch(t.kind){case"required":if((0,a.Z)(t.sets).every((function(e){return!i.has(e)})))return"continue|filter_loop";break;case"exclude":if((0,a.Z)(i).every((function(e){return t.sets.has(e)})))return"continue|filter_loop"}},d=0,p=Object.entries(c);case 8:if(!(d<p.length)){o.next=15;break}if("continue|filter_loop"!==l()){o.next=12;break}return o.abrupt("continue",17);case 12:d++,o.next=8;break;case 15:return o.next=17,c;case 17:o.next=4;break;case 19:o.next=24;break;case 21:o.prev=21,o.t0=o.catch(2),i.e(o.t0);case 24:return o.prev=24,i.f(),o.finish(24);case 27:case"end":return o.stop()}}),N,null,[[2,21,24,27]])}function _(e){return new Set(null!==e&&void 0!==e&&e.includes(2)?e.includes(4)?[0,1]:[0,1,4,5]:null!==e&&void 0!==e&&e.includes(4)?[0,1,2,3]:[0,1,2,3,4,5])}function I(e,n){var r,s,l,d,h,v,m,g,b,w,k,Z,y,x,S,M;return(0,o.Z)().wrap((function(O){for(;;)switch(O.prev=O.next){case 0:for(y=function(e){var n,u,c,l,f,d,h,v,m,g,b;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:b=function(e){var n,r,c,l,d,h,v,m,g,y,x,S,M,O;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=f.length-e,r=[],c=[],l=[],d=0,h=(0,t.Z)(s),o.prev=3,m=function(){var e=v.value,t=Z[e],i=k[e];if(!t)return"continue";p(1,n).every((function(e){return!t.has(i+e)}))?l.push(e):t.has(i)?p(0,n).some((function(e){return!t.has(i+e)}))&&r.push(e):(d+=(0,a.Z)(t).find((function(e){return e>i}))-i,c.push(e))},h.s();case 6:if((v=h.n()).done){o.next=12;break}if("continue"!==m()){o.next=10;break}return o.abrupt("continue",10);case 10:o.next=6;break;case 12:o.next=17;break;case 14:o.prev=14,o.t0=o.catch(3),h.e(o.t0);case 17:return o.prev=17,h.f(),o.finish(17);case 20:if(!(d>n)){o.next=22;break}return o.abrupt("return");case 22:if(e!==f.length){o.next=26;break}return o.next=25,(0,i.Z)({},w);case 25:return o.abrupt("return");case 26:if(d!==n){o.next=47;break}g=(0,t.Z)(c),o.prev=28,g.s();case 30:if((y=g.n()).done){o.next=38;break}return x=y.value,k[x]++,w[T[f[e]]]={kind:"required",sets:new Set([x])},o.delegateYield(b(e+1),"t1",35);case 35:k[x]--;case 36:o.next=30;break;case 38:o.next=43;break;case 40:o.prev=40,o.t2=o.catch(28),g.e(o.t2);case 43:return o.prev=43,g.f(),o.finish(43);case 46:return o.abrupt("return");case 47:S=0,M=[].concat(r,c);case 48:if(!(S<M.length)){o.next=57;break}return O=M[S],k[O]++,w[T[f[e]]]={kind:"required",sets:new Set([O])},o.delegateYield(b(e+1),"t3",53);case 53:k[O]--;case 54:S++,o.next=48;break;case 57:return w[T[f[e]]]={kind:"exclude",sets:new Set([].concat(c,l,r))},o.delegateYield(b(e+1),"t4",59);case 59:case"end":return o.stop()}}),u,null,[[3,14,17,20],[28,40,43,46]])},g=function(e){var r,a,i;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==l.length){n.next=3;break}return n.delegateYield(b(0),"t0",2);case 2:return n.abrupt("return",n.t0);case 3:r=(0,t.Z)(s),n.prev=4,i=(0,o.Z)().mark((function n(){var r,t,i,u,s;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.value,!c.has(r)){n.next=3;break}return n.abrupt("return","continue");case 3:if(t=l[e].length,i=Z[r],u=0,!i||i.has(t)){n.next=9;break}if(!((u=(null!==(s=p(t+1,5).find((function(e){return i.has(e)})))&&void 0!==s?s:6)-t)>m)){n.next=9;break}return n.abrupt("return","continue");case 9:return c.add(r),k[r]=l[e].length,l[e].forEach((function(e){return w[T[e]]={kind:"required",sets:new Set([r])}})),m-=u,n.delegateYield(g(e+1),"t0",14);case 14:m+=u,k[r]=0,c.delete(r);case 17:case"end":return n.stop()}}),n)})),r.s();case 7:if((a=r.n()).done){n.next=14;break}return n.delegateYield(i(),"t1",9);case 9:if("continue"!==n.t1){n.next=12;break}return n.abrupt("continue",12);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t2=n.catch(4),r.e(n.t2);case 19:return n.prev=19,r.f(),n.finish(19);case 22:case"end":return n.stop()}}),n,null,[[4,16,19,22]])},n=(0,o.Z)().mark(g),u=(0,o.Z)().mark(b),c=new Set,l=[],f=[],d=(0,t.Z)(e);try{for(d.s();!(h=d.n()).done;)v=h.value,l.push([]),5===v?f.push(l.length-1):l[v].push(l.length-1)}catch(y){d.e(y)}finally{d.f()}return l=l.filter((function(e){return e.length})).sort((function(e,n){return n.length-e.length})),m=f.length,r.delegateYield(g(0),"t0",10);case 10:case"end":return r.stop()}}),r)},v=function(e,n){if(!p(n+1,4).some((function(n){return 5!==e[n]})))return(e=(0,a.Z)(e))[n]=5,e.reduce((function(e,n){return 6*e+n}),0)},h=function(e,n,r){if(5!==e.length){var i,o=(0,t.Z)(n);try{var u=function(){var t=i.value;h([].concat((0,a.Z)(e),[t]),n,r.filter((function(e){return e!==t})))};for(o.s();!(i=o.n()).done;)u()}catch(s){o.e(s)}finally{o.f()}h([].concat((0,a.Z)(e),[e.length]),new Set([].concat((0,a.Z)(n),[e.length])),[].concat((0,a.Z)(r),[e.length]))}else l.has(r.length)&&d.push(e)},r=(0,o.Z)().mark(y),s=(0,a.Z)(new Set(n)),l=_(e.rainbow),d=[],h([0],new Set([0]),[0]),m=function(e){var n,r=new Map,i=(0,t.Z)(d);try{for(i.s();!(n=i.n()).done;){var o,s=n.value,c=v(s,e);void 0!==c&&r.set(c,(null!==(o=r.get(c))&&void 0!==o?o:new Set(s.slice(0,e)).size+1)-1)}}catch(h){i.e(h)}finally{i.f()}var l,f=(0,t.Z)(r.entries());try{var p=function(){var n=(0,u.Z)(l.value,2),r=n[0];if(0===n[1]){var t=(0,a.Z)(d.find((function(n){return v(n,e)===r})));t[e]=5,d=d.filter((function(n){return v(n,e)!==r})),d.push(t)}};for(f.s();!(l=f.n()).done;)p()}catch(h){f.e(h)}finally{f.f()}},g=4;g>=0;g--)m(g);b={kind:"exclude",sets:new Set},w=c(T,(function(e){return b})),k=(0,i.Z)((0,i.Z)({},f(e,(function(e){return 0}))),c(s,(function(e){return 0}))),Z=f(e,_),x=(0,t.Z)(d),O.prev=14,x.s();case 16:if((S=x.n()).done){O.next=21;break}return M=S.value,O.delegateYield(y(M),"t0",19);case 19:O.next=16;break;case 21:O.next=26;break;case 23:O.prev=23,O.t1=O.catch(14),x.e(O.t1);case 26:return O.prev=26,x.f(),O.finish(26);case 29:case"end":return O.stop()}}),R,null,[[14,23,26,29]])}var Y=r(15671),X=r(43144),$=function(){function e(n,r){var t=this,a=n.arts,o=n.optimizationTarget,u=n.filters,s=n.plotBase,c=n.maxBuilds;(0,Y.Z)(this,e),this.builds=[],this.buildValues=void 0,this.plotData=void 0,this.threshold=-1/0,this.maxBuilds=void 0,this.min=void 0,this.arts=void 0,this.nodes=void 0,this.callback=void 0,this.interimReport=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.refresh(n),t.callback((0,i.Z)({command:"interim",buildValues:t.buildValues},e)),t.buildValues=void 0,e.tested=0,e.failed=0,e.skipped=0},this.arts=a,this.min=u.map((function(e){return e.min})),this.maxBuilds=c,this.callback=r,this.nodes=u.map((function(e){return e.value})),this.nodes.push(o),s&&(this.plotData={},this.nodes.push(s)),this.nodes=function(e,n){return E(e=j(e=F(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!1})))}(this.nodes,{},(function(e){return!1}))}return(0,X.Z)(e,[{key:"compute",value:function(e,n){this.threshold>e&&(this.threshold=e);var r=this.min,t=this.interimReport,i=this,o=H(this.arts,n),s=L(o),c=this.builds.length,l=this.nodes,f=C(l,r,o,this.maxBuilds,{},{pruneArtRange:!0,pruneNodeRange:!0});l=f.nodes,o=f.arts;var d=Object.values(o.values).sort((function(e,n){return e.length-n.length})),p=function(e,n,r,t){var i='\n"use strict";\n// copied from the code above\nfunction res(res) {\n  if (res < 0) return 1 - res / 2\n  else if (res >= 0.75) return 1 / (res * 4 + 1)\n  return 1 - res\n}\nconst x0=0',o=1,s=new Map;return Z(e,(function(e){}),(function(e){var c=e.operation,l=e.operands,f="x".concat(o++),d=l.map((function(e){return s.get(e)}));switch(s.set(e,f),c){case"read":var p=r(e),v=new Array(t).fill(null).map((function(e,n){return"(b[".concat(n,'].values["').concat(p,'"] ?? 0)')}));n[p]&&0!==n[p]&&(v=[n[p].toString()].concat((0,a.Z)(v))),i+=",".concat(f,"=").concat(v.join("+"));break;case"const":s.set(e,"(".concat(e.value,")"));break;case"add":case"mul":i+=",".concat(f,"=").concat(d.join("add"===c?"+":"*"));break;case"min":case"max":i+=",".concat(f,"=Math.").concat(c,"(").concat(d,")");break;case"threshold":var m=(0,u.Z)(d,4),g=m[0],b=m[1],w=m[2],k=m[3];i+=",".concat(f,"=(").concat(g,">=").concat(b,")?").concat(w,":").concat(k);break;case"res":i+=",".concat(f,"=res(").concat(d[0],")");break;case"sum_frac":i+=",".concat(f,"=").concat(d[0],"/(").concat(d[0],"+").concat(d[1],")");break;case"match":case"lookup":case"subscript":case"prio":case"small":case"data":throw new Error("Unsupported ".concat(c," node in precompute"));default:h(c)}})),i+=";\nreturn [".concat(e.map((function(e){return s.get(e)})),"]"),new Function("b",i)}(l,o.base,(function(e){return e.path[1]}),d.length),v=Array(d.length),m={tested:0,failed:0,skipped:s-L(o)};!function e(n){if(n<0){var a=p(v);if(r.every((function(e,n){return e<=a[n]}))){var o,u=a[r.length],s=i.builds,c=i.plotData;if(u>=i.threshold&&(o={value:u,artifactIds:v.map((function(e){return e.id}))},s.push(o)),c){var l=a[r.length+1];(!c[l]||c[l].value<u)&&(o||(o={value:u,artifactIds:v.map((function(e){return e.id}))}),o.plot=l,c[l]=o)}}else m.failed+=1}else d[n].forEach((function(r){v[n]=r,e(n-1)})),0===n&&(m.tested+=d[0].length,m.tested>65536&&t(m))}(d.length-1),t(m,this.builds.length>c)}},{key:"refresh",value:function(e){var n,r,i=this.maxBuilds;(Object.keys(null!==(n=this.plotData)&&void 0!==n?n:{}).length>=1e5&&(this.plotData=function(e){for(var n=.01,r=new Set(e.flatMap((function(e){return Object.values(e).map((function(e){return Math.round(e.plot/n)}))})));r.size>1500;)n*=2,r=new Set((0,a.Z)(r).map((function(e){return Math.round(e/2)})));var i,o={},u=(0,t.Z)(e);try{for(u.s();!(i=u.n()).done;)for(var s=i.value,c=0,l=Object.values(s);c<l.length;c++){var f=l[c],d=Math.round(f.plot/n)*n;(!o[d]||o[d].value<f.value)&&(o[d]=f)}}catch(p){u.e(p)}finally{u.f()}return o}([this.plotData])),this.builds.length>=1e3||e)&&(this.builds=this.builds.sort((function(e,n){return n.value-e.value})).slice(0,i),this.buildValues=this.builds.map((function(e){return e.value})),this.threshold=Math.max(this.threshold,null!==(r=this.buildValues[i-1])&&void 0!==r?r:-1/0))}}]),e}(),J=r(60136),Q=r(29388),ee=r(7112),ne=r(4942),re=function(){function e(n,r){var t=n.arts,i=n.optimizationTarget,o=n.filters,u=n.maxBuilds;(0,Y.Z)(this,e),this.min=void 0,this.nodes=void 0,this.arts=void 0,this.maxBuilds=void 0,this.filters=[],this.interim=void 0,this.firstUncalculated=0,this.callback=void 0,this.arts=t,this.min=[-1/0].concat((0,a.Z)(o.map((function(e){return e.min})))),this.nodes=[i].concat((0,a.Z)(o.map((function(e){return e.value})))),this.callback=r,this.maxBuilds=u,oe(this.nodes,t)}return(0,X.Z)(e,[{key:"addFilter",value:function(e){var n=H(this.arts,e),r=L(n);r&&this.filters.push({nodes:this.nodes,arts:n,maxConts:[],approxs:[],age:0,count:r})}},{key:"split",value:function(e,n){for(e>this.min[0]&&(this.min[0]=e,this.firstUncalculated=0,this.filters.forEach((function(e){return delete e.calculated}))),this.firstUncalculated<this.filters.length&&this.calculateFilter(this.firstUncalculated++);this.filters.length;){var r=this.getApproxFilter(),t=r.arts,a=r.count;if(this.reportInterim(!1),a){if(a<=n)return this.reportInterim(!0),f(t.values,(function(e){return{kind:"id",ids:new Set(e.map((function(e){return e.id})))}}));this.splitOldFilter(r)}}this.reportInterim(!0)}},{key:"reportInterim",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.interim&&(this.interim.skipped>1e6||!0===e)&&(this.callback(this.interim),this.interim=void 0)}},{key:"splitOldFilter",value:function(e){var n=e.nodes,r=e.arts,t=e.approxs,a=e.age,o=f(r.values,(function(e){var n,r,a=e.map((function(e){return{art:e,cont:t[0].conts[e.id]}})).sort((function(e,n){var r=e.cont;return n.cont-r})),i=null!==(n=null===(r=a[a.length-1])||void 0===r?void 0:r.cont)&&void 0!==n?n:0,o=a.reduce((function(e,n){return e+n.cont}),-i*a.length)/3,u=Math.max(1,a.findIndex((function(e){var n=e.cont;return(o-=n-i)<=0}))),s=a.splice(u).map((function(e){return e.art})),c=a.map((function(e){return e.art}));return{high:{arts:c,maxConts:t.map((function(e){return te(c,e)}))},low:{arts:s,maxConts:t.map((function(e){return te(s,e)}))}}})),u=Object.keys(o),s=this.filters,c={},l={};!function e(d){if(u.length){var p=u.pop(),h=o[p],v=h.high,m=h.low;m.arts.length&&(c[p]=m.arts,l[p]=m.maxConts,e(d*m.arts.length)),v.arts.length&&(c[p]=v.arts,l[p]=v.maxConts,e(d*v.arts.length)),u.push(p)}else{var g=t.map((function(e,n){return f(l,(function(e){return e[n]}))})),b={base:r.base,values:(0,i.Z)({},c)};s.push({nodes:n,arts:b,maxConts:g,approxs:t,age:a+1,count:d})}}(1)}},{key:"getApproxFilter",value:function(){return this.calculateFilter(this.filters.length-1),this.firstUncalculated>this.filters.length&&(this.firstUncalculated=this.filters.length),this.filters.pop()}},{key:"calculateFilter",value:function(e){var n=this,r=this.filters[e],t=r.nodes,a=r.arts,i=r.maxConts,o=r.approxs,u=r.age,s=r.count;if(!r.calculated){if(u<3||u%5===2){var c=C(t,this.min,a,this.maxBuilds,{},{pruneNodeRange:!0});t=c.nodes,a=c.arts,Object.values(a.values).every((function(e){return e.length}))&&(o=function(e,n){return oe(e,n).map((function(e){return{base:ae(n.base,e,e.$c),conts:l(Object.values(n.values).flat(),(function(n){return[n.id,ae(n.values,e,0)]}))}}))}(t,a),i=o.map((function(e){return f(a.values,(function(n){return te(n,e)}))})))}var d=i.map((function(e,r){return Object.values(e).reduce((function(e,n){return e+n}),o[r].base-n.min[r])})),p=f(a.values,(function(e,n){var r=d.map((function(e,r){return i[r][n]-e}));return e.filter((function(e){var n=e.id;return o.every((function(e,t){return e.conts[n]>r[t]}))}))})),h=L(a={base:a.base,values:p});h!==s&&(this.interim?this.interim.skipped+=s-h:this.interim={command:"interim",buildValues:void 0,tested:0,failed:0,skipped:s-h}),this.filters[e]={nodes:t,arts:a,maxConts:i,approxs:o,age:u,count:h,calculated:!0}}}}]),e}();function te(e,n){return Math.max.apply(Math,(0,a.Z)(e.map((function(e){var r=e.id;return n.conts[r]}))))}function ae(e,n,r){return Object.entries(e).reduce((function(e,r){var t,a=(0,u.Z)(r,2),i=a[0],o=a[1];return e+(null!==(t=n[i])&&void 0!==t?t:0)*o}),r)}function ie(){for(var e={},n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];for(var a=0,i=r;a<i.length;a++)for(var o=(0,u.Z)(i[a],2),s=o[0],c=o[1],l=0,f=Object.entries(c);l<f.length;l++){var d,p=(0,u.Z)(f[l],2),h=p[0],v=p[1];e[h]=(null!==(d=e[h])&&void 0!==d?d:0)+s*v}return e}function oe(e,n){var r=ie.apply(void 0,[[1,n.base]].concat((0,a.Z)(Object.values(n.values).map((function(e){return[1/e.length,ie.apply(void 0,(0,a.Z)(e.map((function(e){return[1,e.values]}))))]}))))),i=function(e){return ae(r,e,e.$c)},o=new Map;Z(e,(function(e){var n=e,r=n.operation;switch("mul"===r&&o.set(n,{min:NaN,max:NaN}),r){case"mul":case"min":case"max":case"threshold":case"res":case"sum_frac":n.operands.forEach((function(e){return o.set(e,{min:NaN,max:NaN})}))}}),(function(e){return e}));var s,c=W((0,a.Z)(o.keys()),function(e){return z([Object.fromEntries(Object.entries(e.base).map((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return[r,{min:t,max:t}]})))].concat((0,a.Z)(Object.values(e.values).map((function(e){return G(e)})))))}(n)),l=(0,t.Z)(c.entries());try{for(l.s();!(s=l.n()).done;){var f=(0,u.Z)(s.value,2),d=f[0],p=f[1];o.set(d,p)}}catch(w){l.e(w)}finally{l.f()}function v(e,n,r,t){return ie([1,{$c:r-e*n}],[e,t])}function m(e,n,r,t,a,i){return Math.abs(e-r)<1e-10?{$c:i?Math.max(n,t):Math.min(n,t)}:v((t-n)/(r-e),e,n,a)}var g="u",b="l";return function(e,n,r){var t=new Map;function a(e,n){var i=t.get(n);i||t.set(n,i=[new Set,new Map]);var o=i,s=(0,u.Z)(o,2),c=s[0],l=s[1],f=l.get(e);if(f)return f;if(c.has(e))throw new Error("Found cyclical dependency during formula mapping");c.add(e);var d=r(e,n,a);return l.set(e,d),c.delete(e),d}return e.map((function(e){return a(e,n)}))}(e,g,(function(e,n,r){var t,s=e,c=s.operation,l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return r(e,t)},f=n===g?b:g;if("o"===n){var d=o.get(s),p=d.min,w=d.max;if(p<0&&w>0)throw new le("Zero-crossing",c);return l(s,w<=0?b:g)}switch(c){case"const":return{$c:s.value};case"read":return(0,ne.Z)({$c:0},s.path[1],1);case"add":return ie.apply(void 0,(0,a.Z)(s.operands.map((function(e){return[1,l(e)]}))));case"min":case"max":var Z=M[c],y=s.operands.filter((function(e){return"const"!==e.operation})),x=(0,u.Z)(y,1)[0];if(1!==y.length)throw new le("Multivariate",c);var S=l(x),O=Z(s.operands.filter((function(e){return"const"===e.operation})).map((function(e){return e.value})));if("max"===c&&n===b||"min"===c&&n===g)return S;var j=o.get(x),E=j.min,F=j.max;return m(E,Z([E,O]),F,Z([F,O]),S,n===g);case"res":if(n!==g)throw new le("Unsupported direction",c);var T=M[c],A=(0,u.Z)(s.operands,1)[0],B=o.get(A),N=B.min,R=B.max,C=l(A,f);return N<0&&R<1.75?ie([1,{$c:1}],[-.5,C]):m(N,T([N]),R,T([R]),C,n===g);case"sum_frac":if(n!==g)throw new le("Unsupported direction",c);var D=(0,u.Z)(s.operands,2),P=D[0],U=D[1];if("const"!==U.operation)throw new le("Non-constant node",c);var K=l(P),z=U.value,G=o.get(P),W=G.min,q=G.max,H=Math.sqrt((W+z)*(q+z));if(W<=-z)throw new le("Unsupported pattern",c);return v(z/(z+H)/(z+H),H,H/(H+z),K);case"threshold":var L=(0,u.Z)(s.operands,4),V=L[0],_=L[1],I=L[2],Y=L[3];if("const"!==Y.operation||"const"!==_.operation)throw new le("Non-constant node",c);if("const"!==I.operation){if(0!==Y.value)throw new le("Unsupported pattern",c);var X={operation:"threshold",operands:k([V,_,1,Y]),info:t},$=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return{operation:"mul",operands:k(n)}}(X,I),J=o.get(I),Q=J.min,ee=J.max;return o.set(X,{min:0,max:1}),o.set($,{min:Math.min(Q,0),max:Math.max(ee,0)}),l($)}var re=o.get(V),te=re.min,ae=re.max,oe=_.value,ue=I.value,se=Y.value,ce=ue>se===(n===g);return v((ue-se)/(ce?oe-te:ae-oe),oe,ce?ue:se,l(V,ue>se?n:f));case"mul":var fe=o.get(s),de=fe.min,pe=fe.max;if(de<0&&pe>0)throw new le("Zero-crossing",c);if(de<0&&n!==b||pe>0&&n!==g)throw new le("Unsupported direction",c);for(var he=(0,a.Z)(s.operands),ve=[],me=1;he.length;){var ge=he.pop();"mul"===ge.operation?he.push.apply(he,(0,a.Z)(ge.operands)):"const"===ge.operation?me*=ge.value:ve.push(ge)}var be=ve.map((function(e){return l(e,"o")})),we=ve.map((function(e){return o.get(e)})),ke=be.map(i),Ze=ke.reduce((function(e,n,r){return e+(n>=0?we[r].max:we[r].min)/n}),0),ye=ke.reduce((function(e,n){return e*Ze*n/be.length}),me/Ze);return ie.apply(void 0,(0,a.Z)(be.map((function(e,n){return[ye/ke[n],e]}))));case"data":case"match":case"lookup":case"subscript":throw new le("Unsupported operation",c);default:h(c)}}))}var ue,se,ce,le=function(e){(0,J.Z)(r,e);var n=(0,Q.Z)(r);function r(e,t){return(0,Y.Z)(this,r),n.call(this,"Found ".concat(e," in ").concat(t," node when generating polynomial upper bound"))}return(0,X.Z)(r)}((0,ee.Z)(Error)),fe=function(){function e(n,r){var t=n.arts;(0,Y.Z)(this,e),this.arts=void 0,this.filters=[],this.arts=t}return(0,X.Z)(e,[{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"split",value:function(e,n){for(var r=this;this.filters.length;){var t=this.filters.pop();if(L(H(this.arts,t))<=n)return t;de(this.arts,t,n).forEach((function(e){return r.addFilter(e)}))}}}]),e}();function de(e,n,r){var t=H(e,n),o=T.map((function(e){return{slot:e,sets:new Set(t.values[e].map((function(e){return e.set})))}})).filter((function(e){return e.sets.size>1}));if(!o.length)return function(e,n,r){var t=H(e,n),a=L(t),o=T.map((function(e){return{slot:e,length:t.values[e].length}})).filter((function(e){return e.length>1})),u=o.reduce((function(e,n){return e.length<n.length?e:n})),s=u.slot,c=u.length,l=Math.ceil(a/r),f=Math.min(l,c),d=Array(f).fill(0).map((function(e){return new Set}));return t.values[s].forEach((function(e,n){var r=e.id;return d[n%f].add(r)})),d.map((function(e){return(0,i.Z)((0,i.Z)({},n),{},(0,ne.Z)({},s,{kind:"id",ids:e}))}))}(t,n,r);var u=o.reduce((function(e,n){return e.sets.size<n.sets.size?e:n})),s=u.sets,c=u.slot;return(0,a.Z)(s).map((function(e){return(0,i.Z)((0,i.Z)({},n),{},(0,ne.Z)({},c,{kind:"required",sets:new Set([e])}))}))}onmessage=function(e){var n,r=e.data,o=r.command;switch(o){case"setup":ue=r.id;var u="split".concat(ue),s="compute".concat(ue);try{se=new re(r,(function(e){return postMessage((0,i.Z)({id:ue,source:u},e))}))}catch(m){se=new fe(r,(function(e){return postMessage((0,i.Z)({id:ue,source:u},e))}))}ce=new $(r,(function(e){return postMessage((0,i.Z)({id:ue,source:s},e))})),n={command:"iterate"};break;case"split":r.filter&&se.addFilter(r.filter);var c=se.split(r.threshold,r.minCount);n={command:"split",filter:c};break;case"iterate":var l=r.threshold,f=r.filter;ce.compute(l,f),n={command:"iterate"};break;case"finalize":ce.refresh(!0);var d=ce,p=d.builds,v=d.plotData;n={command:"finalize",builds:p,plotData:v};break;case"count":if("break"===function(){var e,i=r.exclusion,o=ce.arts,u=V(I(i,(0,a.Z)(new Set(Object.values(o.values).flatMap((function(e){return e.map((function(e){return e.set}))}))))),o),s=r.arts.map((function(e){return 0})),c=(0,t.Z)(u);try{var l=function(){var n=e.value;r.arts.forEach((function(e,r){return s[r]+=L(H(e,n))}))};for(c.s();!(e=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}return n={command:"count",counts:s},"break"}())break;default:h(o)}postMessage((0,i.Z)({id:ue},n))}}},n={};function r(t){var a=n[t];if(void 0!==a)return a.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,r),i.exports}r.m=e,r.x=function(){var e=r.O(void 0,[676],(function(){return r(18349)}));return e=r.O(e)},function(){var e=[];r.O=function(n,t,a,i){if(!t){var o=1/0;for(l=0;l<e.length;l++){t=e[l][0],a=e[l][1],i=e[l][2];for(var u=!0,s=0;s<t.length;s++)(!1&i||o>=i)&&Object.keys(r.O).every((function(e){return r.O[e](t[s])}))?t.splice(s--,1):(u=!1,i<o&&(o=i));if(u){e.splice(l--,1);var c=a();void 0!==c&&(n=c)}}return n}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[t,a,i]}}(),r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(n,t){return r.f[t](e,n),n}),[]))},r.u=function(e){return"static/js/"+e+".1b7bd000.chunk.js"},r.miniCssF=function(e){},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/genshin-optimizer/",function(){var e={349:1};r.f.i=function(n,t){e[n]||importScripts(r.p+r.u(n))};var n=self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[],t=n.push.bind(n);n.push=function(n){var a=n[0],i=n[1],o=n[2];for(var u in i)r.o(i,u)&&(r.m[u]=i[u]);for(o&&o(r);a.length;)e[a.pop()]=1;t(n)}}(),function(){var e=r.x;r.x=function(){return r.e(676).then(e)}}();r.x()}();
//# sourceMappingURL=349.6df6db51.chunk.js.map