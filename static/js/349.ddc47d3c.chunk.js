!function(){"use strict";var e={18349:function(e,n,r){var t=r(37762),a=r(93433),i=r(1413),o=r(74165),u=r(29439);function s(e,n){if(e&&n)return!Array.isArray(n)&&console.error(n),n.reduce((function(e,n){return null===e||void 0===e?void 0:e[n]}),e)}function c(e,n){return Object.fromEntries(e.map((function(e,r){return[e,n(e,r)]})))}function l(e,n){return Object.fromEntries(e.map((function(e,r){return n(e,r)})))}function f(e,n){return Object.fromEntries(Object.entries(e).map((function(e,r){var t=(0,u.Z)(e,2),a=t[0],i=t[1];return[a,n(i,a,r)]})))}var d=(0,o.Z)().mark((function e(n,r){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n;case 1:if(!(t<=r)){e.next=7;break}return e.next=4,t;case 4:t++,e.next=1;break;case 7:case"end":return e.stop()}}),e)}));function h(e,n){return(0,a.Z)(d(e,n))}function p(e){throw new Error("Should not reach this with value ".concat(e))}var v=r(60136),m=r(29388),g=r(7112),b=r(4942),w=r(15671),k=r(43144);Z(NaN,{name:"TODO"}),x(1),x(0),Z("none");function Z(e,n){return"number"===typeof e?{operation:"const",operands:[],type:"number",value:e,info:n}:{operation:"const",operands:[],type:"string",value:e,info:n}}function x(e,n){return e>=Number.MAX_VALUE/100&&(e=1/0),e<=-Number.MAX_VALUE/100&&(e=-1/0),Z(e,(0,i.Z)({unit:"%"},n))}function y(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return{operation:"min",operands:O(n)}}function S(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return{operation:"max",operands:O(n)}}function M(e,n){return{operation:"read",operands:[],path:e,info:n,type:"number"}}function O(e){return e.map((function(e){return"object"===typeof e?e:Z(e)}))}function j(e,n,r){var t=new Set,a=new Set;e.forEach((function e(i){a.has(i)||(t.has(i)?console.error("Found cyclical dependency during formula traversal"):(t.add(i),n(i),i.operands.forEach(e),r(i),t.delete(i),a.add(i)))}))}function F(e,n,r){var t=new Set,a=new Map,o=new Map;function u(e){var s=a.get(e);if(s)return s;s=n(e);var c=o.get(s);return c||(t.has(s)?(console.error("Found cyclical dependency during formula mapping"),Z(NaN)):(t.add(s),c=r(function(e){var n=e.operands.map(u);return T(n,e.operands)?e:(0,i.Z)((0,i.Z)({},e),{},{operands:n})}(s),e),t.delete(s),a.set(e,c),o.set(s,c),c))}var s=e.map(u);return T(s,e)?e:s}function E(e,n,r){var t=new Map;function a(e,n){var i=t.get(n);i||t.set(n,i=[new Set,new Map]);var o=i,s=(0,u.Z)(o,2),c=s[0],l=s[1],f=l.get(e);if(f)return f;if(c.has(e))throw new Error("Found cyclical dependency during formula mapping");c.add(e);var d=r(e,n,a);return l.set(e,d),c.delete(e),d}return e.map((function(e){return a(e,n)}))}function T(e,n){return void 0===e?void 0===n:void 0!==n&&(e.length===n.length&&e.every((function(e,r){return e===n[r]})))}var A={min:function(e){return Math.min.apply(Math,(0,a.Z)(e))},max:function(e){return Math.max.apply(Math,(0,a.Z)(e))},add:function(e){return e.reduce((function(e,n){return e+n}),0)},mul:function(e){return e.reduce((function(e,n){return e*n}),1)}},B=(0,i.Z)((0,i.Z)({},A),{},{res:function(e){var n=(0,u.Z)(e,1)[0];return n<0?1-n/2:n>=.75?1/(4*n+1):1-n},sum_frac:function(e){return e[0]/e.reduce((function(e,n){return e+n}))},threshold:function(e){var n=(0,u.Z)(e,4),r=n[0],t=n[1],a=n[2],i=n[3];return r>=t?a:i}}),N=new Set(Object.keys(A));function R(e){return F(e,(function(e){return e}),(function(e){var n=e;if(N.has(e.operation)){var r=e,t=r.operation,a=!1,o=r.operands.flatMap((function(e){return e.operation===t?(a=!0,e.operands):[e]}));n=a?(0,i.Z)((0,i.Z)({},r),{},{operands:o}):r}return n}))}function C(e){function n(e){var n,r=new Map,a=(0,t.Z)(e);try{for(a.s();!(n=a.n()).done;){var i,o=n.value;r.set(o,(null!==(i=r.get(o))&&void 0!==i?i:0)+1)}}catch(u){a.e(u)}finally{a.f()}return r}for(var r={common:{counts:new Map,formulas:new Set,operation:"add"}},o=function(){for(var o,s=void 0,c={operation:r.common.operation,operands:(o=r.common.counts,(0,a.Z)(o).flatMap((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return Array(t).fill(r)})))},l=new Map,f=0,d=Object.keys(A);f<d.length;f++){var h=d[f];l.set(h,[])}if(e=F(e,(function(e){if(r.common.formulas.has(e)){var n=e,t=new Map(r.common.counts),a=n.operands.filter((function(e){var n=t.get(e);return!n||(t.set(e,n-1),!1)}));return a.length?(a.push(c),(0,i.Z)((0,i.Z)({},n),{},{operands:a})):c}return e}),(function(e){if(!N.has(e.operation))return e;var r=e;if(s){if(s.operation===r.operation){var a,i=n(r.operands),o=new Map,c=s.counts,f=0,d=(0,t.Z)(i.entries());try{for(d.s();!(a=d.n()).done;){var h,p=(0,u.Z)(a.value,2),v=p[0],m=p[1],g=Math.min(m,null!==(h=c.get(v))&&void 0!==h?h:0);g?(o.set(v,g),f+=g):o.delete(v)}}catch(C){d.e(C)}finally{d.f()}f>1&&(s.counts=o,s.formulas.add(r))}}else{var b,w=l.get(r.operation),k=n(r.operands),Z=(0,t.Z)(w);try{for(Z.s();!(b=Z.n()).done;){var x,y=(0,u.Z)(b.value,2),S=y[0],M=y[1],O=0,j=new Map,F=(0,t.Z)(M.entries());try{for(F.s();!(x=F.n()).done;){var E,T=(0,u.Z)(x.value,2),A=T[0],B=T[1],R=Math.min(B,null!==(E=k.get(A))&&void 0!==E?E:0);R&&(j.set(A,R),O+=R)}}catch(C){F.e(C)}finally{F.f()}if(O>1){s={counts:j,formulas:new Set([r,S]),operation:r.operation},l.clear();break}}}catch(C){Z.e(C)}finally{Z.f()}s||w.push([r,k])}return r})),!s)return"break";r.common=s};;){if("break"===o())break}return e}function D(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!1},o={data:[],processed:new Map},c=new Map([[o,new Map]]),l={data:[n],processed:new Map};return c.set(l,new Map),c.get(o).set(n,l),E(e,l,(function(e,n,l){var f,d,h=e.operation,v=function(e,n){return l(e,n)},m=function(e,n){return l(e,n)};switch(h){case"const":d=e;break;case"add":case"mul":case"max":case"min":var g=B[h],b=[],w=e.operands.filter((function(e){var r=v(e,n);return"const"!==r.operation||(b.push(r.value),!1)})).map((function(e){return v(e,n)})),k=g(b);if(isFinite(k)){if("mul"===h&&0===k){d=Z(k);break}}else if("mul"!==h&&("max"!==h||k>0)&&("min"!==h||k<0)){d=Z(k);break}k!==g([])&&w.push(Z(k)),d=w.length<=1?null!==(f=w[0])&&void 0!==f?f:Z(g([])):{operation:h,operands:w};break;case"res":case"sum_frac":var x=e.operands.map((function(e){return v(e,n)})),y=B[h];d=x.every((function(e){return"const"===e.operation}))?Z(y(x.map((function(e){return e.value})))):(0,i.Z)((0,i.Z)({},e),{},{operands:x});break;case"lookup":var S=m(e.operands[0],n);if("const"===S.operation){var M,O=null!==(M=e.table[S.value])&&void 0!==M?M:e.operands[1];if(O){d=l(O,n);break}}throw new Error("Unsupported ".concat(h," node while folding"));case"prio":var j=e.operands.find((function(e){var r=m(e,n);if("const"!==r.operation)throw new Error("Unsupported ".concat(h," node while folding"));return void 0!==r.value}));d=j?m(j,n):Z(void 0);break;case"small":var F,E,T=void 0,A=(0,t.Z)(e.operands);try{for(A.s();!(E=A.n()).done;){var N,R=E.value,C=m(R,n);if("const"!==C.operation)throw new Error("Unsupported ".concat(h," node while folding"));(void 0===(null===(N=T)||void 0===N?void 0:N.value)||void 0!==C.value&&C.value<T.value)&&(T=C)}}catch(Q){A.e(Q)}finally{A.f()}d=null!==(F=T)&&void 0!==F?F:Z(void 0);break;case"match":var D=e.operands.map((function(e){return l(e,n)})),P=(0,u.Z)(D,4),K=P[0],U=P[1],z=P[2],G=P[3];if("const"!==K.operation||"const"!==U.operation)throw new Error("Unsupported ".concat(h," node while folding"));d=K.value===U.value?z:G;break;case"threshold":var W=e.operands.map((function(e){return l(e,n)})),q=(0,u.Z)(W,4),H=q[0],L=q[1],V=q[2],_=q[3];d="const"===V.operation&&"const"===_.operation&&V.value===_.value?V:"const"===H.operation&&"const"===L.operation?H.value>=L.value?V:_:(0,i.Z)((0,i.Z)({},e),{},{operands:[H,L,V,_]});break;case"subscript":var I=v(e.operands[0],n);if("const"!==I.operation)throw new Error("Found non-constant subscript node while folding");d=Z(e.list[I.value]);break;case"read":var Y=n.data.map((function(n){return s(n,e.path)})).filter((function(e){return e}));if(0===Y.length)if(r(e)){var X=e.accu;d=void 0===X||"small"===X?"string"===e.type?Z(void 0):Z(NaN):Z(B[X]([]))}else d=e;else d=void 0===e.accu||1===Y.length?l(Y[Y.length-1],n):l({operation:e.accu,operands:Y},n);break;case"data":e.reset&&(n=o);var $=c.get(n),J=$.get(e.data);J||(J={data:[].concat((0,a.Z)(n.data),[e.data]),processed:new Map},c.set(J,new Map),$.set(e.data,J)),d=l(e.operands[0],J);break;default:p(h)}return d.info&&delete(d=(0,i.Z)({},d)).info,d}))}var P=["flower","plume","sands","goblet","circlet"],K=(["physical"].concat(["anemo","geo","electro","hydro","pyro","cryo","dendro"]),["Albedo","Aloy","Amber","AratakiItto","Barbara","Beidou","Bennett","Candace","Chongyun","Collei","Cyno","Diluc","Diona","Dori","Eula","Fischl","Ganyu","Gorou","HuTao","Jean","KaedeharaKazuha","Kaeya","KamisatoAyaka","KamisatoAyato","Keqing","Klee","KujouSara","KukiShinobu","Lisa","Mona","Nilou","Ningguang","Noelle","Qiqi","RaidenShogun","Razor","Rosaria","SangonomiyaKokomi","Sayu","Shenhe","ShikanoinHeizou","Sucrose","Tartaglia","Thoma","Tighnari","Venti","Xiangling","Xiao","Xingqiu","Xinyan","YaeMiko","Yanfei","Yelan","Yoimiya","YunJin","Zhongli"]),U=([].concat(K,["Traveler"]),["TravelerAnemo","TravelerGeo","TravelerElectro","TravelerDendro"]);[].concat(K,U),[].concat(K,["TravelerAnemoF","TravelerGeoF","TravelerElectroF","TravelerDendroF"],["TravelerAnemoM","TravelerGeoM","TravelerElectroM","TravelerDendroM"]),[].concat(["AmenomaKageuchi","AquilaFavonia","BlackcliffLongsword","CinnabarSpindle","CoolSteel","KagotsurubeIsshin","DarkIronSword","DullBlade","FavoniusSword","FesteringDesire","FilletBlade","FreedomSworn","HaranGeppakuFutsu","HarbingerOfDawn","IronSting","KeyOfKhajNisut","LionsRoar","MistsplitterReforged","PrimordialJadeCutter","PrototypeRancour","RoyalLongsword","SacrificialSword","SapwoodBlade","SilverSword","SkyriderSword","SkywardBlade","SummitShaper","SwordOfDescension","TheAlleyFlash","TheBlackSword","TheFlute","TravelersHandySword","XiphosMoonlight"],["Akuoumaru","BlackcliffSlasher","BloodtaintedGreatsword","DebateClub","FavoniusGreatsword","FerrousShadow","ForestRegalia","KatsuragikiriNagamasa","LithicBlade","LuxuriousSeaLord","MakhairaAquamarine","OldMercsPal","PrototypeArchaic","Rainslasher","RedhornStonethresher","RoyalGreatsword","SacrificialGreatsword","SerpentSpine","SkyriderGreatsword","SkywardPride","SnowTombedStarsilver","SongOfBrokenPines","TheBell","TheUnforged","WasterGreatsword","Whiteblind","WhiteIronGreatsword","WolfsGravestone"],["BeginnersProtector","BlackcliffPole","BlackTassel","CalamityQueller","CrescentPike","Deathmatch","DragonsBane","DragonspineSpear","EngulfingLightning","FavoniusLance","Halberd","IronPoint","KitainCrossSpear","LithicSpear","MissiveWindspear","Moonpiercer","PrimordialJadeWingedSpear","PrototypeStarglitter","RoyalSpear","SkywardSpine","StaffOfHoma","StaffOfTheScarletSands","TheCatch","VortexVanquisher","WavebreakersFin","WhiteTassel"],["AlleyHunter","AmosBow","AquaSimulacra","BlackcliffWarbow","CompoundBow","ElegyForTheEnd","EndOfTheLine","FadingTwilight","FavoniusWarbow","Hamayumi","HuntersBow","HuntersPath","KingsSquire","Messenger","MitternachtsWaltz","MouunsMoon","PolarStar","Predator","PrototypeCrescent","RavenBow","RecurveBow","RoyalBow","Rust","SacrificialBow","SeasonedHuntersBow","SharpshootersOath","SkywardHarp","Slingshot","TheStringless","TheViridescentHunt","ThunderingPulse","WindblumeOde"],["ApprenticesNotes","BlackcliffAgate","DodocoTales","EmeraldOrb","EverlastingMoonglow","EyeOfPerception","FavoniusCodex","Frostbearer","FruitOfFulfillment","HakushinRing","KagurasVerity","LostPrayerToTheSacredWinds","MagicGuide","MappaMare","MemoryOfDust","OathswornEye","OtherworldlyStory","PocketGrimoire","PrototypeAmber","RoyalGrimoire","SacrificialFragments","SkywardAtlas","SolarPearl","TheWidsith","ThrillingTalesOfDragonSlayers","TwinNephrite","WanderingEvenstar","WineAndSong"]);var z=(0,o.Z)().mark(Q),G=(0,o.Z)().mark(ne);function W(e,n,r,t,a,o){for(var u=o,s={pruneNodeRange:!0},c={pruneNodeRange:!0},l={reaffine:!0},f={pruneOrder:!0,pruneArtRange:!0,pruneNodeRange:!0},d=0;Object.values(u).some((function(e){return e}))&&d++<20;){if(u.pruneOrder){delete u.pruneOrder;var h=H(r,t,a);r!==h&&(r=h,u=(0,i.Z)((0,i.Z)({},u),s))}if(u.pruneArtRange){delete u.pruneArtRange;var p=L(e,r,n);r!==p&&(r=p,u=(0,i.Z)((0,i.Z)({},u),c))}if(u.pruneNodeRange){delete u.pruneNodeRange;var v=V(e,r);e!==v&&(e=v,u=(0,i.Z)((0,i.Z)({},u),l))}if(u.reaffine){delete u.reaffine;var m=q(e,r),g=m.nodes,b=m.arts;e===g&&r===b||(e=g,r=b,u=(0,i.Z)((0,i.Z)({},u),f))}}return{nodes:e,arts:r}}function q(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new Set,s=new Set;function l(e,n){n?o.add(e):e.operands.forEach((function(e){return o.has(e)&&s.add(e)}))}var d=new Set;if(j(e,(function(e){}),(function(e){var n=e.operation;switch(n){case"read":d.add(e.path[1]),l(e,!0);break;case"add":l(e,e.operands.every((function(e){return o.has(e)})));break;case"mul":var r=e.operands.filter((function(e){return"const"!==e.operation}));l(e,0===r.length||1===r.length&&o.has(r[0]));break;case"const":l(e,!0);break;case"res":case"threshold":case"sum_frac":case"max":case"min":l(e,!1);break;default:p(n)}})),(0,a.Z)(s).every((function(e){var n=e.operation;return"read"===n||"const"===n}))&&Object.keys(n.base).length===d.size)return{nodes:e,arts:n};var h=-1;function v(){for(;d.has("".concat(++h)););return"".concat(h)}e.forEach((function(e){return o.has(e)&&s.add(e)}));var m=(0,a.Z)(s).filter((function(e){return"const"!==e.operation})),g=new Map(m.map((function(e){return[e,r||"read"!==e.operation||"dyn"!==e.path[0]?(0,i.Z)((0,i.Z)({},M(["dyn","".concat(v())])),{},{accu:"add"}):e]})));function b(e){var n=D((0,a.Z)(g.keys()),{dyn:f(e,(function(e){return Z(e)}))},(function(e){return!0}));return Object.fromEntries((0,a.Z)(g.values()).map((function(e,r){return[e.path[1],n[r].value]})))}for(var w={nodes:e=F(e,(function(e){var n;return null!==(n=g.get(e))&&void 0!==n?n:e}),(function(e){return e})),arts:{base:b(n.base),values:c(P,(function(e){return n.values[e].map((function(e){return{id:e.id,set:e.set,values:b(e.values)}}))}))}},k=Object.entries(b({})),x=0,y=Object.values(w.arts.values);x<y.length;x++){var S,O=y[x],E=(0,t.Z)(O);try{for(E.s();!(S=E.n()).done;){var T,A=S.value.values,B=(0,t.Z)(k);try{for(B.s();!(T=B.n()).done;){var N=(0,u.Z)(T.value,2),R=N[0],C=N[1];A[R]-=C}}catch(K){B.e(K)}finally{B.f()}}}catch(K){E.e(K)}finally{E.f()}}return w}function H(e,n,r){var t,a=!1,i=!(null!==(t=r.rainbow)&&void 0!==t&&t.length),o=new Set(Object.entries(r).filter((function(e){var n=(0,u.Z)(e,2);n[0];return n[1].length})).map((function(e){return(0,u.Z)(e,1)[0]}))),s=new Set(Object.entries(r).filter((function(e){var n=(0,u.Z)(e,2),r=(n[0],n[1]);return r.includes(2)&&!r.includes(4)})).map((function(e){return(0,u.Z)(e,1)[0]}))),l=c(P,(function(r){var t=e.values[r],c=t.filter((function(e){var r=0;return t.every((function(t){var a=Object.entries(t.values).every((function(n){var r=(0,u.Z)(n,2),t=r[0];return r[1]>=e.values[t]})),c=Object.entries(t.values).some((function(n){var r=(0,u.Z)(n,2),t=r[0];return r[1]>e.values[t]}));return a&&(c||t.id>e.id)&&(i&&!o.has(t.set)&&!s.has(e.set)||e.set===t.set)&&r++,r<n}))}));return c.length!==t.length&&(a=!0),c}));return a?{base:e.base,values:l}:e}function L(e,n,r){for(var t=Object.fromEntries(Object.entries(n.base).map((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return[r,{min:t,max:t}]}))),a={arts:n},i=function(){var n=c(P,(function(e){return I(a.arts.values[e])})),i=c(P,(function(e){return _(Object.entries(n).map((function(n){return n[0]===e?t:n[1]})).filter((function(e){return e})))})),o=!1,u=c(P,(function(n){var t=a.arts.values[n].filter((function(t){var a=_([I([t]),i[n]]),o=Y(e,a);return e.every((function(e,n){var t;return o.get(e).max>=(null!==(t=r[n])&&void 0!==t?t:-1/0)}))}));return t.length!==a.arts.values[n].length&&(o=!0),t}));if(!o)return"break";a.arts={base:a.arts.base,values:u}};;){if("break"===i())break}return a.arts}function V(e,n){var r=Y(e,_([Object.fromEntries(Object.entries(n.base).map((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return[r,{min:t,max:t}]})))].concat((0,a.Z)(Object.values(n.values).map((function(e){return I(e)}))))));return F(e,(function(e){var n=r.get(e),t=n.min;if(t===n.max)return Z(t);var i=e.operation,o=e.operands.map((function(e){return r.get(e)}));switch(i){case"threshold":var s=(0,u.Z)(o,4),c=s[0],l=s[1],f=s[2],d=s[3];if(c.min>=l.max)return e.operands[2];if(c.max<l.min)return e.operands[3];if(f.max===f.min&&d.max===d.min&&f.min===d.min&&isFinite(f.min))return Z(f.max);break;case"min":var h=e.operands.filter((function(e,n){var r=o[n];return o.every((function(e,n){return r.min<=e.max}))}));if(h.length<o.length)return y.apply(void 0,(0,a.Z)(h));break;case"max":var p=e.operands.filter((function(e,n){var r=o[n];return o.every((function(e){return r.max>=e.min}))}));if(p.length<o.length)return S.apply(void 0,(0,a.Z)(p))}return e}),(function(e){return e}))}function _(e){var n={};return e.forEach((function(e){Object.entries(e).forEach((function(e){var r=(0,u.Z)(e,2),t=r[0],a=r[1];n[t]?(n[t].min+=a.min,n[t].max+=a.max):n[t]=(0,i.Z)({},a)}))})),n}function I(e){var n={};return e.length&&(Object.keys(e[0].values).filter((function(n){return e.every((function(e){return e.values[n]}))})).forEach((function(r){return n[r]={min:e[0].values[r],max:e[0].values[r]}})),e.forEach((function(e){for(var r=e.values,t=0,a=Object.entries(r);t<a.length;t++){var i=(0,u.Z)(a[t],2),o=i[0],s=i[1];n[o]?(n[o].max<s&&(n[o].max=s),n[o].min>s&&(n[o].min=s)):n[o]={min:0,max:s}}}))),n}function Y(e,n){var r=new Map;return j(e,(function(e){}),(function(e){var t,a,i=e.operation,o=e.operands.map((function(e){return r.get(e)}));switch(i){case"read":if("dyn"!==e.path[0])throw new Error("Found non-dyn path ".concat(e.path," while computing range"));a=null!==(t=n[e.path[1]])&&void 0!==t?t:{min:0,max:0};break;case"const":a=X([e.value]);break;case"add":case"min":case"max":a={min:B[i](o.map((function(e){return e.min}))),max:B[i](o.map((function(e){return e.max})))};break;case"res":a={min:B[i]([o[0].max]),max:B[i]([o[0].min])};break;case"mul":a=o.reduce((function(e,n){return X([e.min*n.min,e.min*n.max,e.max*n.min,e.max*n.max])}));break;case"threshold":a=o[0].min>=o[1].max?o[2]:o[0].max<o[1].min?o[3]:X([],[o[2],o[3]]);break;case"sum_frac":var s=(0,u.Z)(o,2),c=s[0],l=s[1],f={min:c.min+l.min,max:c.max+l.max};a=f.min<=0&&f.max>=0?c.min<=0&&c.max>=0?{min:NaN,max:NaN}:{min:-1/0,max:1/0}:X([c.min/f.min,c.min/f.max,c.max/f.min,c.max/f.max]);break;default:p(i)}r.set(e,a)})),r}function X(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Math.max.apply(Math,(0,a.Z)(e).concat((0,a.Z)(n.map((function(e){return e.max}))))),t=Math.min.apply(Math,(0,a.Z)(e).concat((0,a.Z)(n.map((function(e){return e.min})))));return{min:t,max:r}}function $(e,n){return{base:e.base,values:c(P,(function(r){var t=n[r];switch(t.kind){case"id":return e.values[r].filter((function(e){return t.ids.has(e.id)}));case"exclude":return e.values[r].filter((function(e){return!t.sets.has(e.set)}));case"required":return e.values[r].filter((function(e){return t.sets.has(e.set)}))}}))}}function J(e){return P.reduce((function(n,r){return n*e.values[r].length}),1)}function Q(e,n){var r,i,s,c,l,d,h;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:r=f(n.values,(function(e){return new Set(e.map((function(e){return e.set})))})),i=(0,t.Z)(e),o.prev=2,i.s();case 4:if((s=i.n()).done){o.next=19;break}c=s.value,l=function(){var e=(0,u.Z)(h[d],2),n=e[0],t=e[1],i=r[n];switch(t.kind){case"required":if((0,a.Z)(t.sets).every((function(e){return!i.has(e)})))return"continue|filter_loop";break;case"exclude":if((0,a.Z)(i).every((function(e){return t.sets.has(e)})))return"continue|filter_loop"}},d=0,h=Object.entries(c);case 8:if(!(d<h.length)){o.next=15;break}if("continue|filter_loop"!==l()){o.next=12;break}return o.abrupt("continue",17);case 12:d++,o.next=8;break;case 15:return o.next=17,c;case 17:o.next=4;break;case 19:o.next=24;break;case 21:o.prev=21,o.t0=o.catch(2),i.e(o.t0);case 24:return o.prev=24,i.f(),o.finish(24);case 27:case"end":return o.stop()}}),z,null,[[2,21,24,27]])}function ee(e){return new Set(null!==e&&void 0!==e&&e.includes(2)?e.includes(4)?[0,1]:[0,1,4,5]:null!==e&&void 0!==e&&e.includes(4)?[0,1,2,3]:[0,1,2,3,4,5])}function ne(e,n){var r,s,l,d,p,v,m,g,b,w,k,Z,x,y,S,M;return(0,o.Z)().wrap((function(O){for(;;)switch(O.prev=O.next){case 0:for(x=function(e){var n,u,c,l,f,d,p,v,m,g,b;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:b=function(e){var n,r,c,l,d,p,v,m,g,x,y,S,M,O;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=f.length-e,r=[],c=[],l=[],d=0,p=(0,t.Z)(s),o.prev=3,m=function(){var e=v.value,t=Z[e],i=k[e];if(!t)return"continue";h(1,n).every((function(e){return!t.has(i+e)}))?l.push(e):t.has(i)?h(0,n).some((function(e){return!t.has(i+e)}))&&r.push(e):(d+=(0,a.Z)(t).find((function(e){return e>i}))-i,c.push(e))},p.s();case 6:if((v=p.n()).done){o.next=12;break}if("continue"!==m()){o.next=10;break}return o.abrupt("continue",10);case 10:o.next=6;break;case 12:o.next=17;break;case 14:o.prev=14,o.t0=o.catch(3),p.e(o.t0);case 17:return o.prev=17,p.f(),o.finish(17);case 20:if(!(d>n)){o.next=22;break}return o.abrupt("return");case 22:if(e!==f.length){o.next=26;break}return o.next=25,(0,i.Z)({},w);case 25:return o.abrupt("return");case 26:if(d!==n){o.next=47;break}g=(0,t.Z)(c),o.prev=28,g.s();case 30:if((x=g.n()).done){o.next=38;break}return y=x.value,k[y]++,w[P[f[e]]]={kind:"required",sets:new Set([y])},o.delegateYield(b(e+1),"t1",35);case 35:k[y]--;case 36:o.next=30;break;case 38:o.next=43;break;case 40:o.prev=40,o.t2=o.catch(28),g.e(o.t2);case 43:return o.prev=43,g.f(),o.finish(43);case 46:return o.abrupt("return");case 47:S=0,M=[].concat(r,c);case 48:if(!(S<M.length)){o.next=57;break}return O=M[S],k[O]++,w[P[f[e]]]={kind:"required",sets:new Set([O])},o.delegateYield(b(e+1),"t3",53);case 53:k[O]--;case 54:S++,o.next=48;break;case 57:return w[P[f[e]]]={kind:"exclude",sets:new Set([].concat(c,l,r))},o.delegateYield(b(e+1),"t4",59);case 59:case"end":return o.stop()}}),u,null,[[3,14,17,20],[28,40,43,46]])},g=function(e){var r,a,i;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==l.length){n.next=3;break}return n.delegateYield(b(0),"t0",2);case 2:return n.abrupt("return",n.t0);case 3:r=(0,t.Z)(s),n.prev=4,i=(0,o.Z)().mark((function n(){var r,t,i,u,s;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.value,!c.has(r)){n.next=3;break}return n.abrupt("return","continue");case 3:if(t=l[e].length,i=Z[r],u=0,!i||i.has(t)){n.next=9;break}if(!((u=(null!==(s=h(t+1,5).find((function(e){return i.has(e)})))&&void 0!==s?s:6)-t)>m)){n.next=9;break}return n.abrupt("return","continue");case 9:return c.add(r),k[r]=l[e].length,l[e].forEach((function(e){return w[P[e]]={kind:"required",sets:new Set([r])}})),m-=u,n.delegateYield(g(e+1),"t0",14);case 14:m+=u,k[r]=0,c.delete(r);case 17:case"end":return n.stop()}}),n)})),r.s();case 7:if((a=r.n()).done){n.next=14;break}return n.delegateYield(i(),"t1",9);case 9:if("continue"!==n.t1){n.next=12;break}return n.abrupt("continue",12);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t2=n.catch(4),r.e(n.t2);case 19:return n.prev=19,r.f(),n.finish(19);case 22:case"end":return n.stop()}}),n,null,[[4,16,19,22]])},n=(0,o.Z)().mark(g),u=(0,o.Z)().mark(b),c=new Set,l=[],f=[],d=(0,t.Z)(e);try{for(d.s();!(p=d.n()).done;)v=p.value,l.push([]),5===v?f.push(l.length-1):l[v].push(l.length-1)}catch(x){d.e(x)}finally{d.f()}return l=l.filter((function(e){return e.length})).sort((function(e,n){return n.length-e.length})),m=f.length,r.delegateYield(g(0),"t0",10);case 10:case"end":return r.stop()}}),r)},v=function(e,n){if(!h(n+1,4).some((function(n){return 5!==e[n]})))return(e=(0,a.Z)(e))[n]=5,e.reduce((function(e,n){return 6*e+n}),0)},p=function(e,n,r){if(5!==e.length){var i,o=(0,t.Z)(n);try{var u=function(){var t=i.value;p([].concat((0,a.Z)(e),[t]),n,r.filter((function(e){return e!==t})))};for(o.s();!(i=o.n()).done;)u()}catch(s){o.e(s)}finally{o.f()}p([].concat((0,a.Z)(e),[e.length]),new Set([].concat((0,a.Z)(n),[e.length])),[].concat((0,a.Z)(r),[e.length]))}else l.has(r.length)&&d.push(e)},r=(0,o.Z)().mark(x),s=(0,a.Z)(new Set(n)),l=ee(e.rainbow),d=[],p([0],new Set([0]),[0]),m=function(e){var n,r=new Map,i=(0,t.Z)(d);try{for(i.s();!(n=i.n()).done;){var o,s=n.value,c=v(s,e);void 0!==c&&r.set(c,(null!==(o=r.get(c))&&void 0!==o?o:new Set(s.slice(0,e)).size+1)-1)}}catch(p){i.e(p)}finally{i.f()}var l,f=(0,t.Z)(r.entries());try{var h=function(){var n=(0,u.Z)(l.value,2),r=n[0];if(0===n[1]){var t=(0,a.Z)(d.find((function(n){return v(n,e)===r})));t[e]=5,d=d.filter((function(n){return v(n,e)!==r})),d.push(t)}};for(f.s();!(l=f.n()).done;)h()}catch(p){f.e(p)}finally{f.f()}},g=4;g>=0;g--)m(g);b={kind:"exclude",sets:new Set},w=c(P,(function(e){return b})),k=(0,i.Z)((0,i.Z)({},f(e,(function(e){return 0}))),c(s,(function(e){return 0}))),Z=f(e,ee),y=(0,t.Z)(d),O.prev=14,y.s();case 16:if((S=y.n()).done){O.next=21;break}return M=S.value,O.delegateYield(x(M),"t0",19);case 19:O.next=16;break;case 21:O.next=26;break;case 23:O.prev=23,O.t1=O.catch(14),y.e(O.t1);case 26:return O.prev=26,y.f(),O.finish(26);case 29:case"end":return O.stop()}}),G,null,[[14,23,26,29]])}var re=function(){function e(n,r){var t=n.arts,i=n.optimizationTarget,o=n.filters,u=n.maxBuilds;(0,w.Z)(this,e),this.min=void 0,this.nodes=void 0,this.arts=void 0,this.maxBuilds=void 0,this.filters=[],this.interim=void 0,this.firstUncalculated=0,this.callback=void 0,this.arts=t,this.min=[-1/0].concat((0,a.Z)(o.map((function(e){return e.min})))),this.nodes=[i].concat((0,a.Z)(o.map((function(e){return e.value})))),this.callback=r,this.maxBuilds=u,oe(this.nodes,t)}return(0,k.Z)(e,[{key:"addFilter",value:function(e){var n=$(this.arts,e),r=J(n);r&&this.filters.push({nodes:this.nodes,arts:n,maxConts:[],approxs:[],age:0,count:r})}},{key:"split",value:function(e,n){for(e>this.min[0]&&(this.min[0]=e,this.firstUncalculated=0,this.filters.forEach((function(e){return delete e.calculated}))),this.firstUncalculated<this.filters.length&&this.calculateFilter(this.firstUncalculated++);this.filters.length;){var r=this.getApproxFilter(),t=r.arts,a=r.count;if(this.reportInterim(!1),a){if(a<=n)return this.reportInterim(!0),f(t.values,(function(e){return{kind:"id",ids:new Set(e.map((function(e){return e.id})))}}));this.splitOldFilter(r)}}this.reportInterim(!0)}},{key:"reportInterim",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.interim&&(this.interim.skipped>1e6||!0===e)&&(this.callback(this.interim),this.interim=void 0)}},{key:"splitOldFilter",value:function(e){var n=e.nodes,r=e.arts,t=e.approxs,a=e.age,o=f(r.values,(function(e){var n,r,a=e.map((function(e){return{art:e,cont:t[0].conts[e.id]}})).sort((function(e,n){var r=e.cont;return n.cont-r})),i=null!==(n=null===(r=a[a.length-1])||void 0===r?void 0:r.cont)&&void 0!==n?n:0,o=a.reduce((function(e,n){return e+n.cont}),-i*a.length)/3,u=Math.max(1,a.findIndex((function(e){var n=e.cont;return(o-=n-i)<=0}))),s=a.splice(u).map((function(e){return e.art})),c=a.map((function(e){return e.art}));return{high:{arts:c,maxConts:t.map((function(e){return te(c,e)}))},low:{arts:s,maxConts:t.map((function(e){return te(s,e)}))}}})),u=Object.keys(o),s=this.filters,c={},l={};!function e(d){if(u.length){var h=u.pop(),p=o[h],v=p.high,m=p.low;m.arts.length&&(c[h]=m.arts,l[h]=m.maxConts,e(d*m.arts.length)),v.arts.length&&(c[h]=v.arts,l[h]=v.maxConts,e(d*v.arts.length)),u.push(h)}else{var g=t.map((function(e,n){return f(l,(function(e){return e[n]}))})),b={base:r.base,values:(0,i.Z)({},c)};s.push({nodes:n,arts:b,maxConts:g,approxs:t,age:a+1,count:d})}}(1)}},{key:"getApproxFilter",value:function(){return this.calculateFilter(this.filters.length-1),this.firstUncalculated>this.filters.length&&(this.firstUncalculated=this.filters.length),this.filters.pop()}},{key:"calculateFilter",value:function(e){var n=this,r=this.filters[e],t=r.nodes,a=r.arts,i=r.maxConts,o=r.approxs,u=r.age,s=r.count;if(!r.calculated){if(u<3||u%5===2){var c=W(t,this.min,a,this.maxBuilds,{},{pruneNodeRange:!0});t=c.nodes,a=c.arts,Object.values(a.values).every((function(e){return e.length}))&&(o=function(e,n){return oe(e,n).map((function(e){return{base:ae(n.base,e,e.$c),conts:l(Object.values(n.values).flat(),(function(n){return[n.id,ae(n.values,e,0)]}))}}))}(t,a),i=o.map((function(e){return f(a.values,(function(n){return te(n,e)}))})))}var d=i.map((function(e,r){return Object.values(e).reduce((function(e,n){return e+n}),o[r].base-n.min[r])})),h=f(a.values,(function(e,n){var r=d.map((function(e,r){return i[r][n]-e}));return e.filter((function(e){var n=e.id;return o.every((function(e,t){return e.conts[n]>r[t]}))}))})),p=J(a={base:a.base,values:h});p!==s&&(this.interim?this.interim.skipped+=s-p:this.interim={command:"interim",buildValues:void 0,tested:0,failed:0,skipped:s-p}),this.filters[e]={nodes:t,arts:a,maxConts:i,approxs:o,age:u,count:p,calculated:!0}}}}]),e}();function te(e,n){return Math.max.apply(Math,(0,a.Z)(e.map((function(e){var r=e.id;return n.conts[r]}))))}function ae(e,n,r){return Object.entries(e).reduce((function(e,r){var t,a=(0,u.Z)(r,2),i=a[0],o=a[1];return e+(null!==(t=n[i])&&void 0!==t?t:0)*o}),r)}function ie(){for(var e={},n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];for(var a=0,i=r;a<i.length;a++)for(var o=(0,u.Z)(i[a],2),s=o[0],c=o[1],l=0,f=Object.entries(c);l<f.length;l++){var d,h=(0,u.Z)(f[l],2),p=h[0],v=h[1];e[p]=(null!==(d=e[p])&&void 0!==d?d:0)+s*v}return e}function oe(e,n){var r=ie.apply(void 0,[[1,n.base]].concat((0,a.Z)(Object.values(n.values).map((function(e){return[1/e.length,ie.apply(void 0,(0,a.Z)(e.map((function(e){return[1,e.values]}))))]}))))),i=function(e){return ae(r,e,e.$c)},o=new Map;j(e,(function(e){var n=e.operation;switch("mul"===n&&o.set(e,{min:NaN,max:NaN}),n){case"mul":case"min":case"max":case"threshold":case"res":case"sum_frac":e.operands.forEach((function(e){return o.set(e,{min:NaN,max:NaN})}))}}),(function(e){return e}));var s,c=Y((0,a.Z)(o.keys()),function(e){return _([Object.fromEntries(Object.entries(e.base).map((function(e){var n=(0,u.Z)(e,2),r=n[0],t=n[1];return[r,{min:t,max:t}]})))].concat((0,a.Z)(Object.values(e.values).map((function(e){return I(e)})))))}(n)),l=(0,t.Z)(c.entries());try{for(l.s();!(s=l.n()).done;){var f=(0,u.Z)(s.value,2),d=f[0],h=f[1];o.set(d,h)}}catch(k){l.e(k)}finally{l.f()}function v(e,n,r,t){return ie([1,{$c:r-e*n}],[e,t])}function m(e,n,r,t,a,i){return Math.abs(e-r)<1e-10?{$c:i?Math.max(n,t):Math.min(n,t)}:v((t-n)/(r-e),e,n,a)}var g="u",w="l";return E(e,g,(function(e,n,r){var t,s=e.operation,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return r(e,t)},l=n===g?w:g;if("o"===n){var f=o.get(e),d=f.min,h=f.max;if(d<0&&h>0)throw new le("Zero-crossing",s);return c(e,h<=0?w:g)}switch(s){case"const":return{$c:e.value};case"read":return(0,b.Z)({$c:0},e.path[1],1);case"add":return ie.apply(void 0,(0,a.Z)(e.operands.map((function(e){return[1,c(e)]}))));case"min":case"max":var k=B[s],Z=e.operands.filter((function(e){return"const"!==e.operation})),x=(0,u.Z)(Z,1)[0];if(1!==Z.length)throw new le("Multivariate",s);var y=c(x),S=k(e.operands.filter((function(e){return"const"===e.operation})).map((function(e){return e.value})));if("max"===s&&n===w||"min"===s&&n===g)return y;var M=o.get(x),j=M.min,F=M.max;return m(j,k([j,S]),F,k([F,S]),y,n===g);case"res":if(n!==g)throw new le("Unsupported direction",s);var E=B[s],T=(0,u.Z)(e.operands,1)[0],A=o.get(T),N=A.min,R=A.max,C=c(T,l);return N<0&&R<1.75?ie([1,{$c:1}],[-.5,C]):m(N,E([N]),R,E([R]),C,n===g);case"sum_frac":if(n!==g)throw new le("Unsupported direction",s);var D=(0,u.Z)(e.operands,2),P=D[0],K=D[1];if("const"!==K.operation)throw new le("Non-constant node",s);var U=c(P),z=K.value,G=o.get(P),W=G.min,q=G.max,H=Math.sqrt((W+z)*(q+z));if(W<=-z)throw new le("Unsupported pattern",s);return v(z/(z+H)/(z+H),H,H/(H+z),U);case"threshold":var L=(0,u.Z)(e.operands,4),V=L[0],_=L[1],I=L[2],Y=L[3];if("const"!==Y.operation||"const"!==_.operation)throw new le("Non-constant node",s);if("const"!==I.operation){if(0!==Y.value)throw new le("Unsupported pattern",s);var X={operation:"threshold",operands:O([V,_,1,Y]),info:t},$=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return{operation:"mul",operands:O(n)}}(X,I),J=o.get(I),Q=J.min,ee=J.max;return o.set(X,{min:0,max:1}),o.set($,{min:Math.min(Q,0),max:Math.max(ee,0)}),c($)}var ne=o.get(V),re=ne.min,te=ne.max,ae=_.value,oe=I.value,ue=Y.value,se=oe>ue===(n===g);return v((oe-ue)/(se?ae-re:te-ae),ae,se?oe:ue,c(V,oe>ue?n:l));case"mul":var ce=o.get(e),fe=ce.min,de=ce.max;if(fe<0&&de>0)throw new le("Zero-crossing",s);if(fe<0&&n!==w||de>0&&n!==g)throw new le("Unsupported direction",s);for(var he=(0,a.Z)(e.operands),pe=[],ve=1;he.length;){var me=he.pop();"mul"===me.operation?he.push.apply(he,(0,a.Z)(me.operands)):"const"===me.operation?ve*=me.value:pe.push(me)}var ge=pe.map((function(e){return c(e,"o")})),be=pe.map((function(e){return o.get(e)})),we=ge.map(i),ke=we.reduce((function(e,n,r){return e+(n>=0?be[r].max:be[r].min)/n}),0),Ze=we.reduce((function(e,n){return e*ke*n/ge.length}),ve/ke);return ie.apply(void 0,(0,a.Z)(ge.map((function(e,n){return[Ze/we[n],e]}))));default:p(s)}}))}var ue,se,ce,le=function(e){(0,v.Z)(r,e);var n=(0,m.Z)(r);function r(e,t){return(0,w.Z)(this,r),n.call(this,"Found ".concat(e," in ").concat(t," node when generating polynomial upper bound"))}return(0,k.Z)(r)}((0,g.Z)(Error)),fe=function(){function e(n,r){var t=this,a=n.arts,o=n.optimizationTarget,u=n.filters,s=n.plotBase,c=n.maxBuilds;(0,w.Z)(this,e),this.builds=[],this.buildValues=void 0,this.plotData=void 0,this.threshold=-1/0,this.maxBuilds=void 0,this.min=void 0,this.arts=void 0,this.nodes=void 0,this.callback=void 0,this.interimReport=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.refresh(n),t.callback((0,i.Z)({command:"interim",buildValues:t.buildValues},e)),t.buildValues=void 0,e.tested=0,e.failed=0,e.skipped=0},this.arts=a,this.min=u.map((function(e){return e.min})),this.maxBuilds=c,this.callback=r,this.nodes=u.map((function(e){return e.value})),this.nodes.push(o),s&&(this.plotData={},this.nodes.push(s)),this.nodes=function(e,n){var r=D(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!1});return C(r=R(r))}(this.nodes,{},(function(e){return!1}))}return(0,k.Z)(e,[{key:"compute",value:function(e,n){this.threshold>e&&(this.threshold=e);var r=this.min,t=this.interimReport,i=this,o=$(this.arts,n),s=J(o),c=this.builds.length,l=this.nodes,f=W(l,r,o,this.maxBuilds,{},{pruneArtRange:!0,pruneNodeRange:!0});l=f.nodes,o=f.arts;var d=Object.values(o.values).sort((function(e,n){return e.length-n.length})),h=function(e,n,r,t){var i='\n"use strict";\n// copied from the code above\nfunction res(res) {\n  if (res < 0) return 1 - res / 2\n  else if (res >= 0.75) return 1 / (res * 4 + 1)\n  return 1 - res\n}\nconst x0=0',o=1,s=new Map;return j(e,(function(e){}),(function(e){var c=e.operation,l=e.operands,f="x".concat(o++),d=l.map((function(e){return s.get(e)}));switch(s.set(e,f),c){case"read":var h=r(e),v=new Array(t).fill(null).map((function(e,n){return"(b[".concat(n,'].values["').concat(h,'"] ?? 0)')}));n[h]&&0!==n[h]&&(v=[n[h].toString()].concat((0,a.Z)(v))),i+=",".concat(f,"=").concat(v.join("+"));break;case"const":s.set(e,"(".concat(e.value,")"));break;case"add":case"mul":i+=",".concat(f,"=").concat(d.join("add"===c?"+":"*"));break;case"min":case"max":i+=",".concat(f,"=Math.").concat(c,"(").concat(d,")");break;case"threshold":var m=(0,u.Z)(d,4),g=m[0],b=m[1],w=m[2],k=m[3];i+=",".concat(f,"=(").concat(g,">=").concat(b,")?").concat(w,":").concat(k);break;case"res":i+=",".concat(f,"=res(").concat(d[0],")");break;case"sum_frac":i+=",".concat(f,"=").concat(d[0],"/(").concat(d[0],"+").concat(d[1],")");break;default:p(c)}})),i+=";\nreturn [".concat(e.map((function(e){return s.get(e)})),"]"),new Function("b",i)}(l,o.base,(function(e){return e.path[1]}),d.length),v=Array(d.length),m={tested:0,failed:0,skipped:s-J(o)};!function e(n){if(n<0){var a=h(v);if(r.every((function(e,n){return e<=a[n]}))){var o,u=a[r.length],s=i.builds,c=i.plotData;if(u>=i.threshold&&(o={value:u,artifactIds:v.map((function(e){return e.id}))},s.push(o)),c){var l=a[r.length+1];(!c[l]||c[l].value<u)&&(o||(o={value:u,artifactIds:v.map((function(e){return e.id}))}),o.plot=l,c[l]=o)}}else m.failed+=1}else d[n].forEach((function(r){v[n]=r,e(n-1)})),0===n&&(m.tested+=d[0].length,m.tested>65536&&t(m))}(d.length-1),t(m,this.builds.length>c)}},{key:"refresh",value:function(e){var n,r,i=this.maxBuilds;(Object.keys(null!==(n=this.plotData)&&void 0!==n?n:{}).length>=1e5&&(this.plotData=function(e){for(var n=.01,r=new Set(e.flatMap((function(e){return Object.values(e).map((function(e){return Math.round(e.plot/n)}))})));r.size>1500;)n*=2,r=new Set((0,a.Z)(r).map((function(e){return Math.round(e/2)})));var i,o={},u=(0,t.Z)(e);try{for(u.s();!(i=u.n()).done;)for(var s=i.value,c=0,l=Object.values(s);c<l.length;c++){var f=l[c],d=Math.round(f.plot/n)*n;(!o[d]||o[d].value<f.value)&&(o[d]=f)}}catch(h){u.e(h)}finally{u.f()}return o}([this.plotData])),this.builds.length>=1e3||e)&&(this.builds=this.builds.sort((function(e,n){return n.value-e.value})).slice(0,i),this.buildValues=this.builds.map((function(e){return e.value})),this.threshold=Math.max(this.threshold,null!==(r=this.buildValues[i-1])&&void 0!==r?r:-1/0))}}]),e}(),de=function(){function e(n,r){var t=n.arts;(0,w.Z)(this,e),this.arts=void 0,this.filters=[],this.arts=t}return(0,k.Z)(e,[{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"split",value:function(e,n){for(var r=this;this.filters.length;){var t=this.filters.pop();if(J($(this.arts,t))<=n)return t;he(this.arts,t,n).forEach((function(e){return r.addFilter(e)}))}}}]),e}();function he(e,n,r){var t=$(e,n),o=P.map((function(e){return{slot:e,sets:new Set(t.values[e].map((function(e){return e.set})))}})).filter((function(e){return e.sets.size>1}));if(!o.length)return function(e,n,r){var t=$(e,n),a=J(t),o=P.map((function(e){return{slot:e,length:t.values[e].length}})).filter((function(e){return e.length>1})),u=o.reduce((function(e,n){return e.length<n.length?e:n})),s=u.slot,c=u.length,l=Math.ceil(a/r),f=Math.min(l,c),d=Array(f).fill(0).map((function(e){return new Set}));return t.values[s].forEach((function(e,n){var r=e.id;return d[n%f].add(r)})),d.map((function(e){return(0,i.Z)((0,i.Z)({},n),{},(0,b.Z)({},s,{kind:"id",ids:e}))}))}(t,n,r);var u=o.reduce((function(e,n){return e.sets.size<n.sets.size?e:n})),s=u.sets,c=u.slot;return(0,a.Z)(s).map((function(e){return(0,i.Z)((0,i.Z)({},n),{},(0,b.Z)({},c,{kind:"required",sets:new Set([e])}))}))}onmessage=function(e){var n,r=e.data,o=r.command;switch(o){case"setup":ue=r.id;var u="split".concat(ue),s="compute".concat(ue);try{se=new re(r,(function(e){return postMessage((0,i.Z)({id:ue,source:u},e))}))}catch(m){se=new de(r,(function(e){return postMessage((0,i.Z)({id:ue,source:u},e))}))}ce=new fe(r,(function(e){return postMessage((0,i.Z)({id:ue,source:s},e))})),n={command:"iterate"};break;case"split":r.filter&&se.addFilter(r.filter);var c=se.split(r.threshold,r.minCount);n={command:"split",filter:c};break;case"iterate":var l=r.threshold,f=r.filter;ce.compute(l,f),n={command:"iterate"};break;case"finalize":ce.refresh(!0);var d=ce,h=d.builds,v=d.plotData;n={command:"finalize",builds:h,plotData:v};break;case"count":if("break"===function(){var e,i=r.exclusion,o=ce.arts,u=Q(ne(i,(0,a.Z)(new Set(Object.values(o.values).flatMap((function(e){return e.map((function(e){return e.set}))}))))),o),s=r.arts.map((function(e){return 0})),c=(0,t.Z)(u);try{var l=function(){var n=e.value;r.arts.forEach((function(e,r){return s[r]+=J($(e,n))}))};for(c.s();!(e=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}return n={command:"count",counts:s},"break"}())break;default:p(o)}postMessage((0,i.Z)({id:ue},n))}}},n={};function r(t){var a=n[t];if(void 0!==a)return a.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,r),i.exports}r.m=e,r.x=function(){var e=r.O(void 0,[676],(function(){return r(18349)}));return e=r.O(e)},function(){var e=[];r.O=function(n,t,a,i){if(!t){var o=1/0;for(l=0;l<e.length;l++){t=e[l][0],a=e[l][1],i=e[l][2];for(var u=!0,s=0;s<t.length;s++)(!1&i||o>=i)&&Object.keys(r.O).every((function(e){return r.O[e](t[s])}))?t.splice(s--,1):(u=!1,i<o&&(o=i));if(u){e.splice(l--,1);var c=a();void 0!==c&&(n=c)}}return n}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[t,a,i]}}(),r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(n,t){return r.f[t](e,n),n}),[]))},r.u=function(e){return"static/js/"+e+".1b7bd000.chunk.js"},r.miniCssF=function(e){},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/genshin-optimizer/",function(){var e={349:1};r.f.i=function(n,t){e[n]||importScripts(r.p+r.u(n))};var n=self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[],t=n.push.bind(n);n.push=function(n){var a=n[0],i=n[1],o=n[2];for(var u in i)r.o(i,u)&&(r.m[u]=i[u]);for(o&&o(r);a.length;)e[a.pop()]=1;t(n)}}(),function(){var e=r.x;r.x=function(){return r.e(676).then(e)}}();r.x()}();
//# sourceMappingURL=349.ddc47d3c.chunk.js.map