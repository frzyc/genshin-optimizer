{"version":3,"sources":["Util/WeaponSort.ts","Weapon/WeaponDisplay.tsx","Components/Card/CardLight.tsx","Components/Card/CardDark.tsx","Components/DropdownMenu/DropdownButton.tsx","Components/StarDisplay.tsx","Components/CloseButton.tsx","Components/ModalWrapper.tsx","Components/Character/CharacterDropdownButton.tsx","Components/SolidToggleButtonGroup.tsx","ReactHooks/useForceUpdate.tsx","Components/ConditionalWrapper.tsx","Components/Character/ThumbSide.tsx","Components/Character/LocationName.tsx","Components/ToggleButton/WeaponToggle.tsx","ReactHooks/useWeapon.tsx","Util/SortByFilters.ts","Components/SortByButton.tsx","Components/Weapon/WeaponSelectionModal.tsx","Weapon/WeaponCard.tsx"],"names":["weaponSortKeys","WeaponDisplayCard","lazy","initialState","editWeaponId","sortType","ascending","rarity","weaponType","maxNumToDisplay","filterReducer","state","action","filterInit","initial","dbStorage","get","WeaponDisplay","props","database","useContext","DatabaseContext","useReducer","stateDisplatch","useState","newWeaponModalShow","setnewWeaponModalShow","useForceUpdate","dbDirty","forceUpdate","scrollRef","useRef","invScrollRef","pageIdex","setpageIdex","useEffect","ReactGA","pageview","followAnyWeapon","set","weaponSheets","usePromise","WeaponSheet","getAll","deleteWeapon","useCallback","key","a","weapon","_getWeapon","name","i18next","t","window","confirm","removeWeapon","editWeapon","setTimeout","current","scrollIntoView","behavior","newWeapon","weaponKey","createWeapon","initialWeapon","sortConfigs","useMemo","level","getValue","wp","tieBreaker","weaponSortConfigs","filterConfigs","filter","includes","weaponFilterConfigs","weapons","_getWeapons","totalWeaponNum","length","weaponIdList","filterFunction","sort","sortFunction","map","id","numPages","Math","ceil","currentPageIndex","clamp","weaponIdsToShow","slice","totalShowing","setPage","e","value","resetEditWeapon","Box","sx","mt","mb","ref","weaponId","footer","onClose","CardDark","p","pb","Grid","container","spacing","item","WeaponToggle","height","onChange","size","flexGrow","SolidToggleButtonGroup","newVal","allRarities","star","ToggleButton","stars","SortByButton","sortKeys","onChangeAsc","alignItems","Pagination","count","page","Typography","color","fallback","xs","Skeleton","variant","width","minHeight","md","lg","xl","display","flexDirection","CardContent","textAlign","WeaponSelectionModal","show","onHide","onSelect","justifyContent","Button","onClick","borderRadius","icon","faPlus","className","sm","WeaponCard","onDelete","onEdit","canEquip","CardLight","styled","Card","backgroundColor","theme","palette","contentLight","main","contentDark","DropdownButton","title","children","anchorEl","setAnchorEl","open","Boolean","handleClick","event","currentTarget","handleClose","endIcon","aria-controls","aria-haspopup","aria-expanded","undefined","MenuListProps","StarIcon","faStar","Stars","colored","component","Array","keys","_","i","CloseButton","large","useTranslation","startIcon","minWidth","ScrollModal","Modal","overflow","paddingTop","paddingBottom","ModalContainer","Container","padding","pointerEvents","ModalWrapper","containerProps","CharacterDropdownButton","unSelectText","unSelectIcon","inventory","noUnselect","characterSheets","CharacterSheet","characterSheet","characterKeys","_getCharKeys","ck","thumbImg","src","thumbImgSide","selected","disabled","noWrap","CharacterMenuItemArray","selectedCharacterKey","characterKey","ToggleButtonGroup","shouldForwardProp","prop","baseColor","selectedColor","contrastText","dark","stateDirty","update","ConditionalWrapper","condition","wrapper","falseWrapper","ThumbSide","lineHeight","verticalAlign","marginTop","marginLeft","marginRight","marginBottom","LocationName","location","nameWIthIcon","cb","exclusive","allWeaponTypeKeys","wt","Assets","weaponTypes","useWeapon","weaponID","setWeapon","followWeapon","sortby","configs","Sort","b","config","aV","bV","localeCompare","filterOption","diff","filterOptions","obj","Object","entries","every","optionKey","optionVal","i18nKey","faSortAmountDownAlt","faSortAmountUp","propWeaponFilter","weaponFilter","setWeaponfilter","Set","allWeaponKeys","wKey","py","weaponSheet","img","px","cs","weaponTypeKey","actionWrapperFunc","equipOnChar","charKey","setWeaponLocation","ascension","refinement","lock","weaponMainVal","getMainStatValue","toFixed","Stat","fixedUnit","weaponSubKey","getSubStatKey","weaponSubVal","getSubStatValue","statMap","passiveName","push","imgAwaken","avatar","fontSize","titleTypographyProps","updateWeapon","flexWrap","pl","ascensionMaxLevel","maxWidth","alignContent","statKey","statVal","unit","getStatUnit","StatIcon","getStatName","flexShrink","mr","faEdit","faTrashAlt"],"mappings":"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","file":"static/js/18.2659a34b.chunk.js","sourcesContent":["import { WeaponKey } from \"../Types/consts\";\r\nimport { ICachedWeapon } from \"../Types/weapon\";\r\nimport WeaponSheet from \"../Weapon/WeaponSheet\";\r\nimport { FilterConfigs, SortConfigs } from \"./SortByFilters\";\r\nexport const weaponSortKeys = [\"level\", \"rarity\"]\r\nexport type WeaponSortKey = typeof weaponSortKeys[number]\r\n\r\nexport function weaponSortConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): SortConfigs<WeaponSortKey, ICachedWeapon> {\r\n  return {\r\n    level: {\r\n      getValue: wp => wp.level ?? 0,\r\n      tieBreaker: \"rarity\"\r\n    },\r\n    rarity: {\r\n      getValue: wp => weaponSheets?.[wp.key]?.rarity,\r\n      tieBreaker: \"level\"\r\n    }\r\n  }\r\n}\r\nexport function weaponFilterConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): FilterConfigs<\"rarity\" | \"weaponType\", ICachedWeapon> {\r\n  return {\r\n    rarity: (wp, filter) => filter.includes(weaponSheets?.[wp.key]?.rarity),\r\n    weaponType: (wp, filter) => !filter || (filter === weaponSheets?.[wp.key]?.weaponType),\r\n  }\r\n}","import { faPlus } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { Box, Button, CardContent, Grid, Pagination, Skeleton, ToggleButton, Typography } from '@mui/material';\r\nimport i18next from 'i18next';\r\nimport React, { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useReducer, useRef, useState } from 'react';\r\nimport ReactGA from 'react-ga';\r\nimport CardDark from '../Components/Card/CardDark';\r\nimport SolidToggleButtonGroup from '../Components/SolidToggleButtonGroup';\r\nimport SortByButton from '../Components/SortByButton';\r\nimport { Stars } from '../Components/StarDisplay';\r\nimport WeaponToggle from '../Components/ToggleButton/WeaponToggle';\r\nimport WeaponSelectionModal from '../Components/Weapon/WeaponSelectionModal';\r\nimport { DatabaseContext } from '../Database/Database';\r\nimport { dbStorage } from '../Database/DBStorage';\r\nimport useForceUpdate from '../ReactHooks/useForceUpdate';\r\nimport usePromise from '../ReactHooks/usePromise';\r\nimport { allRarities, WeaponKey, WeaponTypeKey } from '../Types/consts';\r\nimport { filterFunction, sortFunction } from '../Util/SortByFilters';\r\nimport { clamp } from '../Util/Util';\r\nimport { weaponFilterConfigs, weaponSortConfigs, weaponSortKeys } from '../Util/WeaponSort';\r\nimport WeaponCard from './WeaponCard';\r\nimport WeaponSheet from './WeaponSheet';\r\nimport { initialWeapon } from './WeaponUtil';\r\n\r\n//lazy load the weapon display\r\nconst WeaponDisplayCard = lazy(() => import('./WeaponDisplayCard'))\r\n\r\nconst initialState = () => ({\r\n  editWeaponId: \"\",\r\n  sortType: weaponSortKeys[0],\r\n  ascending: false,\r\n  rarity: [5, 4],\r\n  weaponType: \"\" as WeaponTypeKey | \"\",\r\n  maxNumToDisplay: 30,\r\n})\r\nexport type stateType = ReturnType<typeof initialState>\r\n\r\nfunction filterReducer(state: stateType, action): stateType {\r\n  return { ...state, ...action }\r\n}\r\nfunction filterInit(initial = initialState()): stateType {\r\n  return { ...initial, ...(dbStorage.get(\"WeaponDisplay.state\") ?? {}) }\r\n}\r\n\r\nexport default function WeaponDisplay(props) {\r\n  const database = useContext(DatabaseContext)\r\n  const [state, stateDisplatch] = useReducer(filterReducer, initialState(), filterInit)\r\n  const [newWeaponModalShow, setnewWeaponModalShow] = useState(false)\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  const scrollRef = useRef<HTMLDivElement>(null)\r\n  const invScrollRef = useRef<HTMLDivElement>(null)\r\n  const [pageIdex, setpageIdex] = useState(0)\r\n  //set follow, should run only once\r\n  useEffect(() => {\r\n    ReactGA.pageview('/weapon')\r\n    return database.followAnyWeapon(forceUpdate)\r\n  }, [forceUpdate, database])\r\n\r\n  //save to db\r\n  useEffect(() => {\r\n    dbStorage.set(\"WeaponDisplay.state\", state)\r\n  }, [state])\r\n\r\n  const weaponSheets = usePromise(WeaponSheet.getAll(), [])\r\n\r\n  const deleteWeapon = useCallback(async (key) => {\r\n    const weapon = database._getWeapon(key)\r\n    if (!weapon) return\r\n    const name = i18next.t(`weapon_${weapon.key}_gen:name`)\r\n\r\n    if (!window.confirm(`Are you sure you want to remove ${name}?`)) return\r\n    database.removeWeapon(key)\r\n    if (state.editWeaponId === key)\r\n      stateDisplatch({ editWeaponId: \"\" })\r\n  }, [state.editWeaponId, stateDisplatch, database])\r\n\r\n  const editWeapon = useCallback(key => {\r\n    stateDisplatch({ editWeaponId: key })\r\n    setTimeout(() => {\r\n      scrollRef.current?.scrollIntoView({ behavior: \"smooth\" })\r\n    }, 500);\r\n  }, [stateDisplatch, scrollRef])\r\n\r\n  const newWeapon = useCallback(\r\n    (weaponKey: WeaponKey) => {\r\n      editWeapon(database.createWeapon(initialWeapon(weaponKey)))\r\n    },\r\n    [database, editWeapon])\r\n\r\n  const { sortType, ascending, weaponType, rarity } = state\r\n  const sortConfigs = useMemo(() => weaponSheets && weaponSortConfigs(weaponSheets), [weaponSheets])\r\n  const filterConfigs = useMemo(() => weaponSheets && weaponFilterConfigs(weaponSheets), [weaponSheets])\r\n  const { weaponIdList, totalWeaponNum } = useMemo(() => {\r\n    const weapons = database._getWeapons()\r\n    const totalWeaponNum = weapons.length\r\n    if (!sortConfigs || !filterConfigs) return { weaponIdList: [], totalWeaponNum }\r\n    const weaponIdList = weapons.filter(filterFunction({ weaponType, rarity }, filterConfigs))\r\n      .sort(sortFunction(sortType, ascending, sortConfigs)).map(weapon => weapon.id);\r\n    return dbDirty && { weaponIdList, totalWeaponNum }\r\n  }, [dbDirty, database, sortConfigs, filterConfigs, sortType, ascending, rarity, weaponType])\r\n\r\n  const { weaponIdsToShow, numPages, currentPageIndex } = useMemo(() => {\r\n    const numPages = Math.ceil(weaponIdList.length / state.maxNumToDisplay)\r\n    const currentPageIndex = clamp(pageIdex, 0, numPages - 1)\r\n    return { weaponIdsToShow: weaponIdList.slice(currentPageIndex * state.maxNumToDisplay, (currentPageIndex + 1) * state.maxNumToDisplay), numPages, currentPageIndex }\r\n  }, [weaponIdList, pageIdex, state.maxNumToDisplay])\r\n\r\n  //for pagination\r\n  const totalShowing = weaponIdList.length !== totalWeaponNum ? `${weaponIdList.length}/${totalWeaponNum}` : `${totalWeaponNum}`\r\n  const setPage = useCallback(\r\n    (e, value) => {\r\n      invScrollRef.current?.scrollIntoView({ behavior: \"smooth\" })\r\n      setpageIdex(value - 1);\r\n    },\r\n    [setpageIdex, invScrollRef],\r\n  )\r\n\r\n  const resetEditWeapon = useCallback(() => stateDisplatch({ editWeaponId: \"\" }), [stateDisplatch])\r\n\r\n  const { editWeaponId } = state\r\n  return <Box sx={{\r\n    mt: 1,\r\n    // select all excluding last\r\n    \"> div\": { mb: 1 },\r\n  }}>\r\n    {/* editor/character detail display */}\r\n    {!!editWeaponId && <Box ref={scrollRef} >\r\n      <WeaponDisplayCard\r\n        weaponId={editWeaponId}\r\n        footer\r\n        onClose={resetEditWeapon}\r\n      />\r\n    </Box>}\r\n    <CardDark ref={invScrollRef} sx={{ p: 2, pb: 1 }}>\r\n      <Grid container spacing={1} sx={{ mb: 1 }}>\r\n        <Grid item>\r\n          <WeaponToggle sx={{ height: \"100%\" }} onChange={weaponType => stateDisplatch({ weaponType })} value={weaponType} size=\"small\" />\r\n        </Grid>\r\n        <Grid item flexGrow={1}>\r\n          <SolidToggleButtonGroup sx={{ height: \"100%\" }} onChange={(e, newVal) => stateDisplatch({ rarity: newVal })} value={rarity} size=\"small\">\r\n            {allRarities.map(star => <ToggleButton key={star} value={star}><strong>{star}{' '}</strong><Stars stars={1} /></ToggleButton>)}\r\n          </SolidToggleButtonGroup>\r\n        </Grid>\r\n        <Grid item >\r\n          <SortByButton sx={{ height: \"100%\" }} sortKeys={weaponSortKeys}\r\n            value={sortType} onChange={sortType => stateDisplatch({ sortType })}\r\n            ascending={ascending} onChangeAsc={ascending => stateDisplatch({ ascending })}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n      <Grid container alignItems=\"flex-end\">\r\n        <Grid item flexGrow={1}>\r\n          <Pagination count={numPages} page={currentPageIndex + 1} onChange={setPage} />\r\n        </Grid>\r\n        <Grid item>\r\n          <Typography color=\"text.secondary\">\r\n            {/* <Trans t={t} i18nKey=\"showingNum\" count={numShowing} value={total} > */}\r\n            Showing <b>{weaponIdsToShow.length}</b> out of {totalShowing} Weapons\r\n            {/* </Trans> */}\r\n          </Typography>\r\n        </Grid>\r\n      </Grid>\r\n    </CardDark>\r\n    <Grid container spacing={1}>\r\n      <Suspense fallback={<Grid item xs={12}><Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 500 }} /></Grid>}>\r\n        {!editWeaponId && <Grid item xs={6} md={4} lg={4} xl={3}>\r\n          <CardDark sx={{ height: \"100%\", width: \"100%\", minHeight: 300, display: \"flex\", flexDirection: \"column\" }}>\r\n            <CardContent>\r\n              <Typography sx={{ textAlign: \"center\" }}>Add New Weapon</Typography>\r\n            </CardContent>\r\n            <WeaponSelectionModal show={newWeaponModalShow} onHide={() => setnewWeaponModalShow(false)} onSelect={newWeapon} />\r\n            <Box sx={{\r\n              flexGrow: 1,\r\n              display: \"flex\",\r\n              justifyContent: \"center\",\r\n              alignItems: \"center\"\r\n            }}\r\n            >\r\n              <Button onClick={() => setnewWeaponModalShow(true)} sx={{\r\n                borderRadius: \"1em\"\r\n              }}>\r\n                <Typography variant=\"h1\"><FontAwesomeIcon icon={faPlus} className=\"fa-fw\" /></Typography>\r\n              </Button>\r\n            </Box>\r\n          </CardDark>\r\n        </Grid>}\r\n        {weaponIdsToShow.map(weaponId =>\r\n          <Grid item key={weaponId} xs={12} sm={6} md={4} lg={4} xl={3} >\r\n            <WeaponCard\r\n              weaponId={weaponId}\r\n              onDelete={deleteWeapon}\r\n              onEdit={editWeapon}\r\n              canEquip\r\n            />\r\n          </Grid>)}\r\n      </Suspense>\r\n    </Grid>\r\n  </Box>\r\n}","import { Card, styled } from \"@mui/material\";\r\n\r\nconst CardLight = styled(Card)(({ theme }) => ({\r\n  backgroundColor: theme.palette.contentLight.main\r\n}));\r\n\r\nexport default CardLight","import { Card, styled } from \"@mui/material\";\r\n\r\nconst CardDark = styled(Card)(({ theme }) => ({\r\n  backgroundColor: theme.palette.contentDark.main\r\n}));\r\n\r\nexport default CardDark","import { KeyboardArrowDown } from \"@mui/icons-material\";\r\nimport { Button, ButtonProps, Menu, Skeleton } from \"@mui/material\";\r\nimport { Suspense, useCallback, useState } from \"react\";\r\n\r\nexport type DropdownButtonProps = Omit<ButtonProps, \"title\"> & {\r\n  title: React.ReactNode,\r\n  id?: string,\r\n  children: React.ReactNode\r\n}\r\nexport default function DropdownButton({ title, children, id = \"dropdownbtn\", ...props }: DropdownButtonProps) {\r\n  const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\r\n  const open = Boolean(anchorEl);\r\n  const handleClick = useCallback(\r\n    (event: React.MouseEvent<HTMLButtonElement>) => setAnchorEl(event.currentTarget),\r\n    [setAnchorEl],\r\n  )\r\n  const handleClose = useCallback(\r\n    () => setAnchorEl(null),\r\n    [setAnchorEl],\r\n  )\r\n\r\n  return <Suspense fallback={<Button endIcon={<KeyboardArrowDown />}{...props}><Skeleton width={50} /></Button>} >\r\n    <Button\r\n      {...props}\r\n      id={id}\r\n      aria-controls=\"basic-menu\"\r\n      aria-haspopup=\"true\"\r\n      aria-expanded={open ? 'true' : undefined}\r\n      onClick={handleClick}\r\n      endIcon={<KeyboardArrowDown />}\r\n    >\r\n      {title}\r\n    </Button>\r\n    <Menu\r\n      id=\"basic-menu\"\r\n      anchorEl={anchorEl}\r\n      open={open}\r\n      onClose={handleClose}\r\n      MenuListProps={{\r\n        'aria-labelledby': id,\r\n      }}\r\n      onClick={handleClose}\r\n    >\r\n      {/* set Skeleton to be really high so the taller dropdowns can still be placed properly... */}\r\n      <Suspense fallback={<Skeleton width=\"100%\" height=\"1000\" />}>\r\n        {children}\r\n      </Suspense>\r\n    </Menu>\r\n  </Suspense>\r\n}","import { faStar } from '@fortawesome/free-solid-svg-icons'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { Typography } from '@mui/material'\r\nimport { Rarity } from '../Types/consts'\r\n\r\nconst StarIcon = () => <FontAwesomeIcon icon={faStar} />\r\nconst Stars = ({ stars, colored = false }: { stars: Rarity, colored?: boolean }) =>\r\n  <Typography color={colored ? \"warning.main\" : undefined} component=\"span\">\r\n    {stars ? [...Array(stars).keys()].map((_, i) => <StarIcon key={i} />) : null}\r\n  </Typography>\r\n\r\nexport {\r\n  StarIcon,\r\n  Stars\r\n}\r\n","import { Close } from \"@mui/icons-material\";\r\nimport { Button, ButtonProps } from \"@mui/material\";\r\nimport { useTranslation } from \"react-i18next\";\r\ntype CloseButtonProps = ButtonProps & {\r\n  large?: boolean\r\n}\r\nexport default function CloseButton({ large = false, ...props }: CloseButtonProps) {\r\n  const { t } = useTranslation(\"ui\")\r\n  if (large)\r\n    return <Button color=\"error\" startIcon={<Close />} {...props} >{t`close`}</Button>\r\n  return <Button color=\"error\" sx={{ p: 1, minWidth: 0 }} {...props} >\r\n    <Close />\r\n  </Button>\r\n}","import { CardContent, Container, ContainerProps, Modal, ModalProps, Skeleton, styled } from \"@mui/material\"\r\nimport { Suspense } from \"react\"\r\nimport CardLight from \"./Card/CardLight\"\r\n\r\nconst ScrollModal = styled(Modal)(({ theme }) => ({\r\n  overflow: \"scroll\",\r\n  paddingTop: theme.spacing(2),\r\n  paddingBottom: theme.spacing(2),\r\n\r\n}))\r\nconst ModalContainer = styled(Container)(({ theme }) => ({\r\n  padding: 0,\r\n  minHeight: \"100%\",\r\n  display: \"flex\", flexDirection: \"column\", justifyContent: \"center\",\r\n  pointerEvents: \"none\",\r\n  \"& > *\": {\r\n    pointerEvents: \"auto\"\r\n  }\r\n}))\r\n\r\ntype ModalWrapperProps = ModalProps & {\r\n  containerProps?: ContainerProps\r\n}\r\nexport default function ModalWrapper({ children, containerProps, ...props }: ModalWrapperProps) {\r\n  return <ScrollModal {...props}>\r\n    <ModalContainer {...containerProps}>\r\n      <Suspense fallback={<CardLight><CardContent><Skeleton variant=\"rectangular\" width=\"100%\" height={300} /></CardContent></CardLight>}>\r\n        {children}\r\n      </Suspense>\r\n    </ModalContainer>\r\n  </ScrollModal>\r\n}","import { BusinessCenter, Replay } from \"@mui/icons-material\";\r\nimport { Divider, ListItemIcon, MenuItem, Typography } from \"@mui/material\";\r\nimport { useContext } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport CharacterSheet from \"../../Character/CharacterSheet\";\r\nimport { DatabaseContext } from \"../../Database/Database\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport { CharacterKey } from \"../../Types/consts\";\r\nimport DropdownButton, { DropdownButtonProps } from \"../DropdownMenu/DropdownButton\";\r\nimport ThumbSide from \"./ThumbSide\";\r\n\r\nexport type CharacterDropdownButtonProps = Omit<DropdownButtonProps, \"title\" | \"onChange\" | \"children\"> & {\r\n  value: CharacterKey | \"\"\r\n  onChange: (ck: CharacterKey | \"\") => void\r\n  filter?: (cs: CharacterSheet, ck: CharacterKey) => boolean\r\n  inventory?: boolean\r\n  noUnselect?: boolean,\r\n  unSelectText?: Displayable,\r\n  unSelectIcon?: Displayable,\r\n}\r\n\r\nexport default function CharacterDropdownButton({ value, onChange, unSelectText, unSelectIcon, inventory = false, noUnselect = false, filter = () => true, ...props }: CharacterDropdownButtonProps) {\r\n  const { t } = useTranslation(\"ui\");\r\n  const database = useContext(DatabaseContext)\r\n  const characterSheets = usePromise(CharacterSheet.getAll(), [])\r\n  const characterSheet = usePromise(CharacterSheet.get(value), [value])\r\n  const characterKeys = database._getCharKeys().filter(ck => characterSheets?.[ck] && filter(characterSheets[ck], ck)).sort()\r\n  return <DropdownButton\r\n    {...props}\r\n    title={characterSheet?.name ?? (inventory ? t`inventory` : (unSelectText ?? t`unselect`))}\r\n    color={value ? \"success\" : \"primary\"}\r\n    startIcon={characterSheet?.thumbImg ? <ThumbSide src={characterSheet.thumbImgSide} /> : (inventory ? <BusinessCenter /> : (unSelectIcon ?? <Replay />))}>\r\n    {!noUnselect && (inventory ? <MenuItem onClick={() => onChange(\"\")} selected={value === \"\"} disabled={value === \"\"}>\r\n      <ListItemIcon>\r\n        <BusinessCenter />\r\n      </ListItemIcon>\r\n      <Typography variant=\"inherit\" noWrap>\r\n        {t`inventory`}\r\n      </Typography>\r\n    </MenuItem> : <MenuItem onClick={() => onChange(\"\")} selected={value === \"\"} disabled={value === \"\"}>\r\n      <ListItemIcon>\r\n        <Replay />\r\n      </ListItemIcon>\r\n      <Typography variant=\"inherit\" noWrap>\r\n        {t`unselect`}\r\n      </Typography>\r\n    </MenuItem>)}\r\n    {!noUnselect && <Divider key=\"div\" />}\r\n    {!!characterSheets && CharacterMenuItemArray(characterSheets, characterKeys, onChange, value)}\r\n  </DropdownButton >\r\n}\r\n\r\n// Returning an array instead of Fragment because MUI Menu doesn't like fragments.\r\nexport function CharacterMenuItemArray(characterSheets: StrictDict<CharacterKey, CharacterSheet>, characterKeys: CharacterKey[], onChange: (ck: CharacterKey) => void, selectedCharacterKey: CharacterKey | \"\" = \"\") {\r\n  return characterKeys.map(characterKey =>\r\n    <MenuItem onClick={() => onChange(characterKey)} key={characterKey} selected={selectedCharacterKey === characterKey} disabled={selectedCharacterKey === characterKey} >\r\n      <ListItemIcon>\r\n        <ThumbSide src={characterSheets[characterKey].thumbImgSide} />\r\n      </ListItemIcon>\r\n      <Typography variant=\"inherit\" noWrap>\r\n        {characterSheets?.[characterKey]?.name}\r\n      </Typography>\r\n    </MenuItem>)\r\n}","import { ButtonProps, styled, ToggleButtonGroup, ToggleButtonGroupProps } from \"@mui/material\";\r\n\r\nexport type SolidToggleButtonGroupProps = SolidToggleButtonGroupPropsPartial & ToggleButtonGroupProps\r\ntype SolidToggleButtonGroupPropsPartial = {\r\n  baseColor?: ButtonProps[\"color\"];\r\n  selectedColor?: ButtonProps[\"color\"];\r\n}\r\n\r\nconst SolidToggleButtonGroup = styled(ToggleButtonGroup, {\r\n  shouldForwardProp: (prop) => prop !== \"baseColor\" && prop !== \"selectedColor\"\r\n})<SolidToggleButtonGroupPropsPartial>(({ theme, baseColor = \"primary\", selectedColor = \"success\" }) => ({\r\n  '& .MuiToggleButtonGroup-grouped': {\r\n    '&': {\r\n      backgroundColor: theme.palette[baseColor].main,\r\n      color: theme.palette[baseColor].contrastText,\r\n    },\r\n    '&:hover': {\r\n      backgroundColor: theme.palette[baseColor].dark,\r\n    },\r\n    '&.Mui-selected': {\r\n      backgroundColor: theme.palette[selectedColor].main,\r\n      color: theme.palette[selectedColor].contrastText,\r\n    },\r\n    '&.Mui-selected:hover': {\r\n      backgroundColor: theme.palette[selectedColor].dark,\r\n    },\r\n    '&.Mui-disabled': {\r\n      backgroundColor: theme.palette[baseColor].dark,\r\n    },\r\n    '&.Mui-selected.Mui-disabled': {\r\n      backgroundColor: theme.palette[selectedColor].dark,\r\n    },\r\n  },\r\n}));\r\n\r\nexport default SolidToggleButtonGroup","import { useCallback, useState } from \"react\"\r\n\r\nexport default function useForceUpdate(): [object, () => void] {\r\n  const [stateDirty, update] = useState({})\r\n  const forceUpdateHook = useCallback(() => update({}), [])\r\n  return [stateDirty, forceUpdateHook]\r\n}","import { ReactNode } from \"react\";\r\n\r\ntype Prop = {\r\n  condition: boolean,\r\n  wrapper: (children: ReactNode) => ReactNode\r\n  falseWrapper?: (children: ReactNode) => ReactNode\r\n  children: ReactNode\r\n}\r\n// Wrap children with element provided by wrapper func when condition is true.\r\nexport default function ConditionalWrapper({ condition, wrapper, falseWrapper, children }: Prop) {\r\n  return (condition ? wrapper(children) : (falseWrapper ? falseWrapper(children) : children)) as JSX.Element;\r\n}","import { styled } from \"@mui/system\";\r\n\r\nconst ThumbSide = styled(\"img\")(({ theme }) => ({\r\n  display: \"inline-block\",\r\n  width: \"auto\",\r\n  height: `2.3em`,\r\n  lineHeight: 1,\r\n  verticalAlign: \"text-bottom\",\r\n  marginTop: theme.spacing(-3),\r\n  marginLeft: theme.spacing(-1.25),\r\n  marginRight: theme.spacing(-1),\r\n  marginBottom: theme.spacing(-1),\r\n}))\r\n\r\nexport default ThumbSide","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { Typography } from \"@mui/material\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport CharacterSheet from \"../../Character/CharacterSheet\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\n\r\nexport default function LocationName({ location }) {\r\n  const { t } = useTranslation(\"ui\");\r\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\r\n  return <Typography component=\"span\">\r\n    {characterSheet?.name ? characterSheet.nameWIthIcon : <span><BusinessCenter sx={{ verticalAlign: \"text-bottom\" }} /> {t`inventory`}</span>}\r\n  </Typography>\r\n\r\n}","import { ToggleButton } from \"@mui/material\";\r\nimport { useCallback } from \"react\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport { allWeaponTypeKeys, WeaponTypeKey } from \"../../Types/consts\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport SolidToggleButtonGroup, { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\r\ntype WeaponToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\r\n  onChange: (value: WeaponTypeKey | \"\") => void\r\n  value: WeaponTypeKey | \"\"\r\n}\r\nexport default function WeaponToggle({ value, onChange, ...props }: WeaponToggleProps) {\r\n  const cb = useCallback((e, newVal) => onChange(newVal || \"\"), [onChange])\r\n  return <SolidToggleButtonGroup exclusive onChange={cb} value={value || allWeaponTypeKeys} {...props}>\r\n    {allWeaponTypeKeys.map(wt => <ToggleButton key={wt} value={wt}>\r\n      <ImgIcon src={Assets.weaponTypes?.[wt]} size={2} />\r\n    </ToggleButton>)}\r\n  </SolidToggleButtonGroup>\r\n}","import { useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../Database/Database\";\r\n\r\nexport default function useWeapon(weaponID: string | undefined = \"\") {\r\n  const database = useContext(DatabaseContext)\r\n  const [weapon, setWeapon] = useState(database._getWeapon(weaponID))\r\n  useEffect(() => setWeapon(database._getWeapon(weaponID)), [database, weaponID])\r\n  useEffect(() =>\r\n    weaponID ? database.followWeapon(weaponID, setWeapon) : undefined,\r\n    [weaponID, setWeapon, database])\r\n  return weapon\r\n}","type SortConfig<T> = {\r\n  getValue: (id: T) => number | string\r\n  tieBreaker?: string\r\n}\r\nexport type SortConfigs<Keys extends string, T> = Record<Keys, SortConfig<T>>\r\n\r\nexport function sortFunction<Keys extends string, T>(sortby: string, ascending: boolean, configs: SortConfigs<Keys, T>) {\r\n  function Sort(a: T, b: T, ascending: boolean, config: SortConfig<T>) {\r\n    const aV = config.getValue(a)\r\n    const bV = config.getValue(b)\r\n    let diff = 0\r\n    if (typeof aV === \"string\" && typeof bV === \"string\")\r\n      diff = aV.localeCompare(bV)\r\n    else\r\n      diff = ((bV as number) - (aV as number))\r\n    return (ascending ? -1 : 1) * diff\r\n  }\r\n  return (a: T, b: T) => {\r\n    if (!configs[sortby]) return 0\r\n    const filterOption = configs[sortby]\r\n    let diff = Sort(a, b, ascending, filterOption)\r\n    if (!diff && filterOption.tieBreaker && configs[filterOption.tieBreaker])\r\n      diff = Sort(a, b, ascending, configs[filterOption.tieBreaker])\r\n    return diff\r\n  }\r\n}\r\n\r\ntype FilterConfig<T> = (obj: T, filter: any) => boolean\r\nexport type FilterConfigs<Keys extends string, T> = Record<Keys, FilterConfig<T>>\r\nexport function filterFunction<Keys extends string, T>(filterOptions: Record<Keys, any>, filterConfigs: FilterConfigs<Keys, T>) {\r\n  return (obj: T) => Object.entries(filterOptions).every(([optionKey, optionVal]) => filterConfigs[optionKey as any](obj, optionVal))\r\n}","import { faSortAmountDownAlt, faSortAmountUp } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { Button, ButtonGroup, ButtonGroupProps, MenuItem } from \"@mui/material\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport DropdownButton from \"./DropdownMenu/DropdownButton\";\r\n\r\ntype SortByButtonProps = ButtonGroupProps & {\r\n  sortKeys: string[]\r\n  value: string\r\n  onChange: (value: string) => void\r\n  ascending: boolean\r\n  onChangeAsc: (value: boolean) => void\r\n}\r\n// Assumes that all the sortKeys has corresponding translations in ui.json sortMap\r\nexport default function SortByButton({ sortKeys, value, onChange, ascending, onChangeAsc, ...props }: SortByButtonProps) {\r\n  const { t } = useTranslation(\"ui\")\r\n  return <ButtonGroup {...props} >\r\n    <DropdownButton title={<Trans t={t} i18nKey=\"sortByFormat\" value={t(`sortMap.${value}`) as any}>Sort By: {{ value: t(`sortMap.${value}`) }}</Trans>}>\r\n      {sortKeys.map(key =>\r\n        <MenuItem key={key} selected={value === key} disabled={value === key} onClick={() => onChange(key)}>{t(`sortMap.${key}`) as any}</MenuItem>)}\r\n    </DropdownButton>\r\n    <Button onClick={() => onChangeAsc(!ascending)} startIcon={<FontAwesomeIcon icon={ascending ? faSortAmountDownAlt : faSortAmountUp} className=\"fa-fw\" />}>\r\n      {ascending ? <Trans t={t} i18nKey=\"ascending\" >Ascending</Trans> : <Trans t={t} i18nKey=\"descending\" >Descending</Trans>}\r\n    </Button>\r\n  </ButtonGroup>\r\n}","import { Box, CardActionArea, CardContent, Divider, Grid, Typography } from \"@mui/material\"\r\nimport { useEffect, useState } from \"react\"\r\nimport Assets from \"../../Assets/Assets\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { allWeaponKeys, WeaponKey, WeaponTypeKey } from \"../../Types/consts\"\r\nimport WeaponSheet from \"../../Weapon/WeaponSheet\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport CardLight from \"../Card/CardLight\"\r\nimport CloseButton from \"../CloseButton\"\r\nimport ImgIcon from \"../Image/ImgIcon\"\r\nimport ModalWrapper from \"../ModalWrapper\"\r\nimport { Stars } from \"../StarDisplay\"\r\nimport WeaponToggle from \"../ToggleButton/WeaponToggle\"\r\n\r\ntype WeaponSelectionModalProps = {\r\n  show: boolean,\r\n  onHide: () => void,\r\n  onSelect: (wKey: WeaponKey) => void,\r\n  filter?: (sheet: WeaponSheet) => boolean,\r\n  weaponFilter?: WeaponTypeKey,\r\n}\r\n\r\nexport default function WeaponSelectionModal({ show, onHide, onSelect, filter = () => true, weaponFilter: propWeaponFilter }: WeaponSelectionModalProps) {\r\n  const weaponSheets = usePromise(WeaponSheet.getAll(), [])\r\n  const [weaponFilter, setWeaponfilter] = useState<WeaponTypeKey | \"\">(propWeaponFilter ?? \"\")\r\n\r\n  useEffect(() => propWeaponFilter && setWeaponfilter(propWeaponFilter), [propWeaponFilter])\r\n\r\n  const weaponIdList = !weaponSheets ? [] : [...new Set(allWeaponKeys)].filter(wKey => filter(weaponSheets[wKey]))\r\n    .filter(wKey => {\r\n      if (weaponFilter && weaponFilter !== weaponSheets?.[wKey]?.weaponType) return false\r\n      return true\r\n    })\r\n    .sort((a, b) => (weaponSheets?.[b]?.rarity ?? 0) - (weaponSheets?.[a]?.rarity ?? 0))\r\n\r\n  if (!weaponSheets) return null\r\n\r\n  return <ModalWrapper open={show} onClose={onHide}>\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container>\r\n          <Grid item flexGrow={1}>\r\n            <WeaponToggle value={weaponFilter} onChange={setWeaponfilter} disabled={!!propWeaponFilter} size=\"small\" />\r\n          </Grid >\r\n          <Grid item>\r\n            <CloseButton onClick={onHide} />\r\n          </Grid >\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent><Grid container spacing={1}>\r\n        {weaponIdList.map(weaponKey => {\r\n          const weaponSheet = weaponSheets[weaponKey]\r\n          return <Grid item key={weaponKey} lg={3} md={4}>\r\n            <CardLight sx={{ height: \"100%\" }} >\r\n              <CardActionArea onClick={() => { onHide(); onSelect(weaponKey) }} sx={{ display: \"flex\" }}>\r\n                <Box component=\"img\" src={weaponSheet.img} sx={{ width: 100, height: \"auto\" }} className={` grad-${weaponSheet.rarity}star`} />\r\n                <Box sx={{ flexGrow: 1, px: 1 }}>\r\n                  <Typography variant=\"subtitle1\">{weaponSheet.name}</Typography>\r\n                  <Typography><ImgIcon src={Assets.weaponTypes?.[weaponSheet.weaponType]} /> <Stars stars={weaponSheet.rarity} colored /></Typography>\r\n                </Box>\r\n              </CardActionArea>\r\n            </CardLight>\r\n          </Grid>\r\n        })}\r\n      </Grid></CardContent>\r\n      <Divider />\r\n      <CardContent sx={{ py: 1 }}>\r\n        <CloseButton large onClick={onHide} />\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { Lock, LockOpen } from \"@mui/icons-material\"\r\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, CardHeader, Grid, IconButton, Skeleton, Typography } from \"@mui/material\"\r\nimport { Suspense, useCallback, useContext } from \"react\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport CharacterSheet from \"../Character/CharacterSheet\"\r\nimport CardLight from \"../Components/Card/CardLight\"\r\nimport CharacterDropdownButton from '../Components/Character/CharacterDropdownButton'\r\nimport LocationName from \"../Components/Character/LocationName\"\r\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\r\nimport ImgIcon from \"../Components/Image/ImgIcon\"\r\nimport { Stars } from \"../Components/StarDisplay\"\r\nimport StatIcon from \"../Components/StatIcon\"\r\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\r\nimport { DatabaseContext } from \"../Database/Database\"\r\nimport usePromise from \"../ReactHooks/usePromise\"\r\nimport useWeapon from \"../ReactHooks/useWeapon\"\r\nimport Stat from \"../Stat\"\r\nimport { CharacterKey } from \"../Types/consts\"\r\nimport WeaponSheet from \"./WeaponSheet\"\r\n\r\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean }\r\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false }: WeaponCardProps) {\r\n  const database = useContext(DatabaseContext)\r\n  const databaseWeapon = useWeapon(weaponId)\r\n  const weapon = databaseWeapon\r\n  const weaponSheet = usePromise(weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\r\n\r\n  const filter = useCallback(\r\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\r\n    [weaponSheet],\r\n  )\r\n\r\n  const actionWrapperFunc = useCallback(\r\n    children => <CardActionArea onClick={() => onClick?.(weaponId)} sx={{ height: \"100%\" }}>{children}</CardActionArea>,\r\n    [onClick, weaponId],\r\n  )\r\n\r\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => database.setWeaponLocation(weaponId, charKey), [database, weaponId],)\r\n  if (!weapon || !weaponSheet) return null;\r\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\r\n\r\n\r\n  const weaponTypeKey = weaponSheet.weaponType\r\n  const weaponMainVal = weaponSheet.getMainStatValue(level, ascension).toFixed(Stat.fixedUnit(\"atk\"))\r\n  const weaponSubKey = weaponSheet.getSubStatKey()\r\n  const weaponSubVal = weaponSheet.getSubStatValue(level, ascension).toFixed(Stat.fixedUnit(weaponSubKey))\r\n  const weaponPassiveName = weaponSheet?.passiveName\r\n  const statMap = [[\"weaponATK\", weaponMainVal]]\r\n  weaponPassiveName && statMap.push([weaponSubKey, weaponSubVal])\r\n  const img = ascension < 2 ? weaponSheet?.img : weaponSheet?.imgAwaken\r\n\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\r\n    <ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}>\r\n      <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\r\n        <div className={`grad-${weaponSheet.rarity}star`} >\r\n          <CardHeader title={weaponSheet.name} avatar={<ImgIcon sx={{ fontSize: \"2em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />} titleTypographyProps={{ variant: \"h6\" }}\r\n            action={!onClick && <IconButton color=\"primary\" onClick={() => database.updateWeapon({ lock: !lock }, id)}>\r\n              {lock ? <Lock /> : <LockOpen />}\r\n            </IconButton>} />\r\n          <Grid container sx={{ flexWrap: \"nowrap\", pl: 2 }}>\r\n            <Grid item flexGrow={1}>\r\n              <Typography component=\"span\" variant=\"h4\">Lv. {level}</Typography>\r\n              <Typography component=\"span\" variant=\"h4\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\r\n              <Typography variant=\"h6\">Refinement <strong>{refinement}</strong></Typography>\r\n              <Typography><Stars stars={weaponSheet.rarity} colored /></Typography>\r\n            </Grid>\r\n            {/* use flex-end here to align the image to the bottom. */}\r\n            <Grid item container maxWidth=\"40%\" alignContent=\"flex-end\" sx={{ mt: -3 }}>\r\n              <Box component=\"img\" src={img} width=\"100%\" height=\"auto\" />\r\n            </Grid>\r\n          </Grid>\r\n        </div>\r\n        <CardContent>\r\n          {statMap.map(([statKey, statVal]) => {\r\n            let unit = Stat.getStatUnit(statKey)\r\n            return <Box key={statKey} sx={{ display: \"flex\" }}>\r\n              <Typography flexGrow={1}>{StatIcon[statKey]} {Stat.getStatName(statKey)}</Typography>\r\n              <Typography>{statVal + unit}</Typography>\r\n            </Box>\r\n          })}\r\n        </CardContent>\r\n        {/* grow to fill the 100% heigh */}\r\n        <Box flexGrow={1} />\r\n        <CardContent sx={{ py: 1 }}>\r\n          <Grid container sx={{ flexWrap: \"nowrap\" }} >\r\n            <Grid item xs=\"auto\" flexShrink={1}>\r\n              {canEquip ? <CharacterDropdownButton size=\"small\" noUnselect inventory value={location} onChange={equipOnChar} filter={filter} /> : <LocationName location={location} />}\r\n            </Grid>\r\n            <Grid item flexGrow={1} sx={{ mr: 1 }} />\r\n            <Grid item xs=\"auto\">\r\n              <ButtonGroup sx={{ height: \"100%\" }}>\r\n                {!!onEdit && <Button color=\"info\" size=\"small\" onClick={() => onEdit(id)} >\r\n                  <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\r\n                </Button>}\r\n                {!!onDelete && <Button color=\"error\" size=\"small\" onClick={() => onDelete(id)} disabled={!!location || lock} >\r\n                  <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\r\n                </Button>}\r\n              </ButtonGroup>\r\n            </Grid>\r\n          </Grid>\r\n        </CardContent>\r\n\r\n      </CardLight>\r\n    </ConditionalWrapper>\r\n  </Suspense>\r\n}"],"sourceRoot":""}