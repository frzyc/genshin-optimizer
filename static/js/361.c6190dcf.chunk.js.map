{"version":3,"file":"static/js/361.c6190dcf.chunk.js","mappings":"odA2BMA,GAAgBC,EAAAA,EAAAA,IAAkB,OAAIC,EAAAA,KAC7B,SAASC,EAAT,GAA4I,IAA5GC,EAA2G,EAA3GA,KAA2G,IAArGC,UAAAA,OAAqG,MAAzF,EAAyF,EAAtFC,EAAsF,EAAtFA,OAAQC,EAA8E,EAA9EA,SAA8E,IAApEC,OAAAA,OAAoE,MAA3D,kBAAM,CAAN,EAA2D,EAA/CC,EAA+C,EAA/CA,iBACjGC,GAAMC,EAAAA,EAAAA,GAAe,CAAC,cAAe,oBAArCD,EACFE,GAAeC,EAAAA,EAAAA,IAAW,kBAAMC,EAAAA,EAAAA,MAAN,GAA0B,IAC1D,GAAwCC,EAAAA,EAAAA,UAA0BN,EAAmB,CAACA,IAAJ,OAA4BO,EAAAA,KAA9G,eAAOC,EAAP,KAAqBC,EAArB,KAEQC,GAAaC,EAAAA,EAAAA,YAAWC,EAAAA,GAAxBF,SACR,GAA0BJ,EAAAA,EAAAA,UAASI,EAASG,cAAcC,OAA1D,eAAOC,EAAP,KAAcC,EAAd,MACAC,EAAAA,EAAAA,YAAU,kBAAMP,EAASG,cAAcK,QAAO,SAACC,EAAGC,GAAJ,OAAeJ,EAASI,EAAxB,GAApC,GAAsE,CAACV,KAEjFO,EAAAA,EAAAA,YAAU,kBAAMjB,GAAoBS,EAAgB,CAACT,GAA3C,GAA+D,CAACA,IAE1E,OAAoCM,EAAAA,EAAAA,UAAS,IAA7C,eAAOe,EAAP,KAAmBC,EAAnB,KACMC,GAAqBC,EAAAA,EAAAA,kBAAiBH,GAEpCI,EAAWV,EAAXU,OACFC,EAAgBvB,EAAoBwB,EAAAA,GAAAA,QAAqB,SAAAC,GAAI,OAAI7B,EAAOI,EAAayB,GAAxB,IAChE7B,QAAO,SAAA6B,GAAI,OAAIpB,EAAaqB,SAAS1B,EAAayB,GAAME,WAA7C,IACX/B,QAAO,SAAA6B,GAAI,OAAKL,GAAsBtB,EAAE,mBAAD,OAAoB2B,IAAQG,cAAcF,SAASN,EAAmBQ,cAAlG,IACXhC,QAAO,SAAA6B,GAAI,OAAIH,EAAOI,SAAS1B,EAAayB,GAAMH,OAAvC,IACXO,MAAK,SAACC,EAAGC,GAAJ,OAAU/B,EAAa+B,GAAGT,OAAStB,EAAa8B,GAAGR,MAAnD,IAJ6B,GAMrC,OAAKtB,GAEE,SAAC,IAAD,CAAcgC,KAAMxC,EAAMyC,QAASvC,EAAnC,UACL,UAAC,IAAD,YACE,SAAC,IAAD,CAAawC,GAAI,CAAEC,GAAI,GAAvB,UACE,UAAC,KAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,WACE,SAAC,KAAD,CAAMC,MAAI,EAAV,UACE,SAAC,IAAD,CAAcC,MAAOlC,EAAcmC,SAAUlC,EAAiBmC,WAAY5C,EAAkB6C,KAAK,aAEnG,SAAC,KAAD,CAAMJ,MAAI,EAAV,UACE,SAAC,IAAD,CAAwBJ,GAAI,CAAES,OAAQ,QAAUJ,MAAOjB,EAAQoB,KAAK,QAApE,SACGpD,EAAAA,GAAAA,KAAgB,SAAAsD,GAAI,OAAI,SAAC,IAAD,CAAyBL,MAAOK,EAAMC,QAAS,kBAAMtC,EAASG,cAAcoC,IAAI,CAAExB,OAAQlC,EAAckC,EAAQsB,IAAjE,EAA/C,UAA0H,UAAC,IAAD,CAAKG,QAAQ,OAAOC,IAAK,EAAzB,WAA4B,4BAASJ,KAAc,SAAC,IAAD,CAAcK,MAAO,QAA/KL,EAAvB,SAGzB,SAAC,KAAD,CAAMN,MAAI,EAACY,SAAU,EAArB,UACE,SAAC,IAAD,CACEC,WAAS,EACTT,KAAK,QACLH,MAAOrB,EACPsB,SAAU,SAACY,GAAD,OAAyCjC,EAAciC,EAAEC,OAAOd,MAAhE,EACVe,MAAOxD,EAAE,cACToC,GAAI,CAAES,OAAQ,QACdY,WAAY,CACVrB,GAAI,CAAES,OAAQ,cAIpB,SAAC,KAAD,CAAML,MAAI,EAAV,UACE,SAAC,IAAD,CAAaO,QAASnD,YAI5B,SAAC,IAAD,KACA,SAAC,IAAD,WAAa,SAAC,KAAD,CAAM0C,WAAS,EAACC,QAAS,EAAzB,SACVd,EAAaiC,KAAI,SAAAC,GAAc,IAAD,EACvBC,EAAc1D,EAAayD,GACjC,OAAO,SAAC,KAAD,CAAMnB,MAAI,EAAiBqB,GAAI,EAAGC,GAAI,EAAtC,UACL,SAAC,IAAD,CAAW1B,GAAI,CAAES,OAAQ,QAAzB,UACE,UAAC,IAAD,CAAgBE,QAAS,WAAQnD,IAAUC,EAAS8D,EAAY,EAAEvB,GAAI,CAAEa,QAAS,QAAjF,WACE,SAAC,IAAD,CAAKc,UAAU,MAAMC,IAAKJ,EAAYK,OAAOtE,GAAYyC,GAAI,CAAE8B,MAAO,IAAKrB,OAAQ,QAAUsB,UAAS,gBAAWP,EAAYpC,OAAvB,WACtG,UAAC,IAAD,CAAKY,GAAI,CAAEgB,SAAU,EAAGgB,GAAI,GAA5B,WACE,SAAC,IAAD,CAAYC,QAAQ,YAApB,SAAiCT,EAAYU,QAC7C,UAAC,IAAD,YAAY,SAAC,IAAD,CAASN,IAAG,UAAEO,EAAAA,EAAAA,mBAAF,aAAE,EAAqBX,EAAY/B,cAA3D,KAA2E,SAAC,IAAD,CAAcsB,MAAOS,EAAYpC,OAAQgD,SAAO,gBAN5Gb,EAWxB,SAEH,SAAC,IAAD,KACA,SAAC,IAAD,CAAavB,GAAI,CAAEC,GAAI,GAAvB,UACE,SAAC,IAAD,CAAaoC,OAAK,EAAC1B,QAASnD,WAnDR,IAuD3B,C","sources":["Components/Weapon/WeaponSelectionModal.tsx"],"sourcesContent":["import { Box, CardActionArea, CardContent, Divider, Grid, TextField, ToggleButton, Typography } from \"@mui/material\"\r\nimport { ChangeEvent, useContext, useDeferredValue, useEffect, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../../Assets/Assets\"\r\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\"\r\nimport { DatabaseContext } from \"../../Database/Database\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { allRarities, allWeaponKeys, allWeaponTypeKeys, WeaponKey, WeaponTypeKey } from \"../../Types/consts\"\r\nimport { handleMultiSelect } from \"../../Util/MultiSelect\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport CardLight from \"../Card/CardLight\"\r\nimport CloseButton from \"../CloseButton\"\r\nimport ImgIcon from \"../Image/ImgIcon\"\r\nimport ModalWrapper from \"../ModalWrapper\"\r\nimport SolidToggleButtonGroup from \"../SolidToggleButtonGroup\"\r\nimport { StarsDisplay } from \"../StarDisplay\"\r\nimport WeaponToggle from \"../ToggleButton/WeaponToggle\"\r\n\r\ntype WeaponSelectionModalProps = {\r\n  show: boolean,\r\n  ascension?: number,\r\n  onHide: () => void,\r\n  onSelect: (wKey: WeaponKey) => void,\r\n  filter?: (sheet: WeaponSheet) => boolean,\r\n  weaponTypeFilter?: WeaponTypeKey,\r\n}\r\n\r\nconst rarityHandler = handleMultiSelect([...allRarities])\r\nexport default function WeaponSelectionModal({ show, ascension = 0, onHide, onSelect, filter = () => true, weaponTypeFilter }: WeaponSelectionModalProps) {\r\n  const { t } = useTranslation([\"page_weapon\", \"weaponNames_gen\"])\r\n  const weaponSheets = usePromise(() => WeaponSheet.getAll, [])\r\n  const [weaponFilter, setWeaponfilter] = useState<WeaponTypeKey[]>(weaponTypeFilter ? [weaponTypeFilter] : [...allWeaponTypeKeys])\r\n\r\n  const { database } = useContext(DatabaseContext)\r\n  const [state, setState] = useState(database.displayWeapon.get())\r\n  useEffect(() => database.displayWeapon.follow((r, dbMeta) => setState(dbMeta)), [database])\r\n\r\n  useEffect(() => weaponTypeFilter && setWeaponfilter([weaponTypeFilter]), [weaponTypeFilter])\r\n\r\n  const [searchTerm, setSearchTerm] = useState(\"\")\r\n  const deferredSearchTerm = useDeferredValue(searchTerm)\r\n\r\n  const { rarity } = state\r\n  const weaponIdList = !weaponSheets ? [] : allWeaponKeys.filter(wKey => filter(weaponSheets(wKey)))\r\n    .filter(wKey => weaponFilter.includes(weaponSheets(wKey).weaponType))\r\n    .filter(wKey => !deferredSearchTerm || t(`weaponNames_gen:${wKey}`).toLowerCase().includes(deferredSearchTerm.toLowerCase()))\r\n    .filter(wKey => rarity.includes(weaponSheets(wKey).rarity))\r\n    .sort((a, b) => weaponSheets(b).rarity - weaponSheets(a).rarity)\r\n\r\n  if (!weaponSheets) return null\r\n\r\n  return <ModalWrapper open={show} onClose={onHide}>\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container spacing={1}>\r\n          <Grid item>\r\n            <WeaponToggle value={weaponFilter} onChange={setWeaponfilter} disabled={!!weaponTypeFilter} size=\"small\" />\r\n          </Grid >\r\n          <Grid item>\r\n            <SolidToggleButtonGroup sx={{ height: \"100%\" }} value={rarity} size=\"small\">\r\n              {allRarities.map(star => <ToggleButton key={star} value={star} onClick={() => database.displayWeapon.set({ rarity: rarityHandler(rarity, star) })}><Box display=\"flex\" gap={1}><strong>{star}</strong><StarsDisplay stars={1} /></Box></ToggleButton>)}\r\n            </SolidToggleButtonGroup>\r\n          </Grid>\r\n          <Grid item flexGrow={1}>\r\n            <TextField\r\n              autoFocus\r\n              size=\"small\"\r\n              value={searchTerm}\r\n              onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setSearchTerm(e.target.value)}\r\n              label={t(\"weaponName\")}\r\n              sx={{ height: \"100%\" }}\r\n              InputProps={{\r\n                sx: { height: \"100%\" }\r\n              }}\r\n            />\r\n          </Grid>\r\n          <Grid item>\r\n            <CloseButton onClick={onHide} />\r\n          </Grid >\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent><Grid container spacing={1}>\r\n        {weaponIdList.map(weaponKey => {\r\n          const weaponSheet = weaponSheets(weaponKey)\r\n          return <Grid item key={weaponKey} lg={3} md={4}>\r\n            <CardLight sx={{ height: \"100%\" }} >\r\n              <CardActionArea onClick={() => { onHide(); onSelect(weaponKey) }} sx={{ display: \"flex\" }}>\r\n                <Box component=\"img\" src={weaponSheet.getImg(ascension)} sx={{ width: 100, height: \"auto\" }} className={` grad-${weaponSheet.rarity}star`} />\r\n                <Box sx={{ flexGrow: 1, px: 1 }}>\r\n                  <Typography variant=\"subtitle1\">{weaponSheet.name}</Typography>\r\n                  <Typography><ImgIcon src={Assets.weaponTypes?.[weaponSheet.weaponType]} /> <StarsDisplay stars={weaponSheet.rarity} colored /></Typography>\r\n                </Box>\r\n              </CardActionArea>\r\n            </CardLight>\r\n          </Grid>\r\n        })}\r\n      </Grid></CardContent>\r\n      <Divider />\r\n      <CardContent sx={{ py: 1 }}>\r\n        <CloseButton large onClick={onHide} />\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n"],"names":["rarityHandler","handleMultiSelect","allRarities","WeaponSelectionModal","show","ascension","onHide","onSelect","filter","weaponTypeFilter","t","useTranslation","weaponSheets","usePromise","WeaponSheet","useState","allWeaponTypeKeys","weaponFilter","setWeaponfilter","database","useContext","DatabaseContext","displayWeapon","get","state","setState","useEffect","follow","r","dbMeta","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","rarity","weaponIdList","allWeaponKeys","wKey","includes","weaponType","toLowerCase","sort","a","b","open","onClose","sx","py","container","spacing","item","value","onChange","disabled","size","height","star","onClick","set","display","gap","stars","flexGrow","autoFocus","e","target","label","InputProps","map","weaponKey","weaponSheet","lg","md","component","src","getImg","width","className","px","variant","name","Assets","colored","large"],"sourceRoot":""}