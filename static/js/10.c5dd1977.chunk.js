(this["webpackJsonpgenshin-optimizer"]=this["webpackJsonpgenshin-optimizer"]||[]).push([[10],{209:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return nt}));var n=a(2),r=a(82),i=a(81),c=a(85),s=a(98),l=a(96),o=a(84),d=a(23),u=a(0),j=a.n(u),f=a(193),b=a(201),h=a(200),m=a(32),O=a(41),x=a(30),g=a(159),v=a(157),y=a(103),S=a(1),p=a(3),k=a(5),C=a.n(k),N=(a(59),a(24)),I=a(6),B=a(52),A=a(54),w=a(13),F={variant:void 0,active:!1,disabled:!1},K=j.a.forwardRef((function(t,e){var a=t.bsPrefix,n=t.active,r=t.disabled,i=t.className,c=t.variant,s=t.action,l=t.as,o=t.eventKey,d=t.onClick,f=Object(p.a)(t,["bsPrefix","active","disabled","className","variant","action","as","eventKey","onClick"]);a=Object(I.a)(a,"list-group-item");var b=Object(u.useCallback)((function(t){if(r)return t.preventDefault(),void t.stopPropagation();d&&d(t)}),[r,d]);return j.a.createElement(A.a,Object(S.a)({ref:e},f,{eventKey:Object(w.b)(o,f.href),as:l||(s?f.href?"a":"button":"div"),onClick:b,className:C()(i,a,n&&"active",r&&"disabled",c&&a+"-"+c,s&&a+"-action")}))}));K.defaultProps=F,K.displayName="ListGroupItem";var E=K,T={variant:void 0,horizontal:void 0},M=j.a.forwardRef((function(t,e){var a,n=Object(N.a)(t,{activeKey:"onSelect"}),r=n.className,i=n.bsPrefix,c=n.variant,s=n.horizontal,l=n.as,o=void 0===l?"div":l,d=Object(p.a)(n,["className","bsPrefix","variant","horizontal","as"]),u=Object(I.a)(i,"list-group");return a=s?!0===s?"horizontal":"horizontal-"+s:null,j.a.createElement(B.a,Object(S.a)({ref:e},d,{as:o,className:C()(r,u,c&&u+"-"+c,a&&u+"-"+a)}))}));M.defaultProps=T,M.displayName="ListGroup",M.Item=E;var P=M,_=a(206),D=a(55),G=a(17);function W(){return new Worker(a.p+"static/js/BuildWorker.2dd1fa20.worker.js")}var U=a(93),z=a(95),H=a(89),R=a(151),J=a(90),L=a(153),V=a(127),q=a(101),Q=a(107),X=a(87),Y=a(115),Z=a(86),$=a(99),tt=a(88),et=a(94),at=function(){function t(){Object(i.a)(this,t)}return Object(c.a)(t,null,[{key:"splitArtifactsBySlot",value:function(t){var e={},a=function(a){e[a]=Object.values(t).filter((function(t){return t.slotKey===a}))};for(var n in q.d)a(n);return e}},{key:"generateAllPossibleArtifactSetPerm",value:function(t){var e=t.filter((function(t){return t.key})).map((function(t){return t.key}));t.reduce((function(t,e){return e.key?t+e.num:t}),0)<5&&e.push("Other");var a=[],n=U.a.getArtifactSlotKeys();return function r(i,c){if(i>=n.length){var s={};Object.values(c).forEach((function(t){s[t]?s[t]+=1:s[t]=1}));var l,o=!0,d=Object(et.a)(t);try{for(d.s();!(l=d.n()).done;){var u=l.value;if(u.key&&(!s[u.key]||s[u.key]<u.num)){o=!1;break}}}catch(f){d.e(f)}finally{d.f()}o&&a.push(c)}else{var j=n[i];e.forEach((function(t){("Other"===t||q.c[t]&&q.c[t].pieces&&Object.keys(q.c[t].pieces).includes(j))&&(c[j]=t,r(i+1,Object(tt.a)({},c)))}))}}(0,{}),a}},{key:"calculateTotalBuildNumber",value:function(t,e,a){var n=a.filter((function(t){return t.key})).map((function(t){return t.key})),i={};return Object.entries(t).forEach((function(t){var e=Object(r.a)(t,2),a=e[0],c=e[1],s={};c.forEach((function(t){n.includes(t.setKey)?s[t.setKey]=(s[t.setKey]||0)+1:s.Other=(s.Other||0)+1})),i[a]=s})),e.reduce((function(t,e){return t+Object.entries(e).reduce((function(t,e){var a=Object(r.a)(e,2),n=a[0],c=a[1];return i[n]&&i[n][c]?t*i[n][c]:0}),1)}),0)}}]),t}(),nt=function(t){Object(s.a)(a,t);var e=Object(l.a)(a);function a(t){var c;if(Object(i.a)(this,a),(c=e.call(this,t)).forceUpdateBuildDisplay=function(){return c.forceUpdate()},c.statsDisplayKeys=function(){return["hp","atk","def","ele_mas","crit_rate","crit_dmg","heal_bonu","ener_rech","phy_dmg","ele_dmg","phy_atk","ele_atk"]},c.splitArtifacts=function(){if(!c.state.selectedCharacterId)return{};var t=z.a.getArtifactDatabase();if(Object.entries(t).forEach((function(e){var a=Object(r.a)(e,2),n=a[0],i=a[1];i.lock&&delete t[n],c.state.selectedCharacterId&&i.location&&i.location!==c.state.selectedCharacterId&&delete t[n]})),c.state.setFilters.every((function(t){return t.key}))){var e=c.state.setFilters.map((function(t){return t.key}));Object.entries(t).forEach((function(a){var n=Object(r.a)(a,2),i=n[0],c=n[1];e.includes(c.setKey)&&delete t[i]}))}var n=at.splitArtifactsBySlot(t);return a.artifactsSlotsToSelectMainStats.forEach((function(t,e){return c.state.mainStat[e]&&(n[t]=n[t].filter((function(t){return t.mainStatKey===c.state.mainStat[e]})))})),n},c.changeMainStat=function(t,e){c.setState((function(a){var n=Object(Z.e)(a.mainStat);return n[t]=e,{mainStat:n}}))},c.changeSetFilterKey=function(t,e,a){return c.setState((function(n){var r=n.setFilters[t].key;if(r!==e){var i=n.artifactConditionals?n.artifactConditionals.filter((function(t){return t.setKey!==r})):[],c=n.setFilters,s=0;return a&&a[0]&&(s=parseInt(a[0])),c[t]={key:e,num:s},{setFilters:c,artifactConditionals:i}}}))},c.dropdownitemsForStar=function(t,e){return U.a.getArtifactSetsByMaxStarEntries(t).map((function(t){var a=Object(r.a)(t,2),i=a[0],s=a[1];if(c.state.setFilters.some((function(t){return t.key===i})))return!1;var l=Object.keys(U.a.getArtifactSets(i)),o=c.state.setFilters.reduce((function(t,a,n){return a.key&&n!==e?t+a.num:t}),0);return!l.every((function(t){return parseInt(t)+o>5}))&&Object(n.jsx)(f.a.Item,{onClick:function(){return c.changeSetFilterKey(e,i,l)},children:s.name},i)}))},c.generateBuilds=function(t,e){c.setState({generatingBuilds:!0,builds:[]});var a=c.state,n=a.setFilters,r=a.asending,i=a.buildFilterKey,s=a.maxBuildsToShow,l=a.artifactConditionals,o=J.a.getCharacter(c.state.selectedCharacterId),d=$.a.createWeaponBundle(o),u=H.a.calculateCharacterWithWeaponStats(o,d),j=U.a.getAllArtifactSetEffectsObj(l),f=Object(Z.e)(t);Object.values(f).forEach((function(t){t.forEach((function(t){t.mainStatVal=U.a.getMainStatValue(t.mainStatKey,t.numStars,t.level)}))}));var b={splitArtifacts:f,artifactSetPerms:e,initialStats:u,artifactSetEffects:j,setFilters:n,maxBuildsToShow:s,buildFilterKey:i,asending:r},h=new W;h.onmessage=function(a){G.a.timing({category:"Build Generation",variable:"timing",value:a.data.timing,label:at.calculateTotalBuildNumber(t,e,c.state.setFilters)});var n=a.data.builds.map((function(t){return H.a.calculateBuildWithObjs(l,u,t.artifacts)}));c.setState({builds:n,generatingBuilds:!1})},h.postMessage(b)},c.BuildGeneratorEditorCard=function(t){var e=J.a.getCharacterDatabase(),i=J.a.getCharacter(c.state.selectedCharacterId),s=i?i.name:"Character Name",l=c.state.setFilters.reduce((function(t,e){return e.key?t+e.num:t}),0),u=c.splitArtifacts(),j=at.generateAllPossibleArtifactSetPerm(c.state.setFilters),S=at.calculateTotalBuildNumber(u,j,c.state.setFilters),p=0===S?Object(n.jsx)(b.a,{variant:"warning",className:"mb-0",children:Object(n.jsxs)("span",{children:["Current configuration will not generate any builds for ",Object(n.jsx)("b",{children:s}),". Please change your Artifact configurations, or add/unlock more Artifacts."]})}):S>c.state.maxBuildsToGenerate?Object(n.jsx)(b.a,{variant:"danger",className:"mb-0",children:Object(n.jsxs)("span",{children:["Current configuration will generate ",Object(n.jsx)("b",{children:S})," builds for ",Object(n.jsx)("b",{children:s}),". Please restrict artifact configuration to reduce builds to less than ",c.state.maxBuildsToGenerate,", or your browser might crash."]})}):Object(n.jsx)(b.a,{variant:"success",className:"mb-0",children:Object(n.jsxs)("span",{children:["Current configuration will generate ",Object(n.jsx)("b",{children:S})," builds for ",Object(n.jsx)("b",{children:s}),"."]})}),k=Object(n.jsxs)(h.a,{title:c.state.selectedCharacterId?s:"Select Character",children:[Object(n.jsx)(f.a.Item,{onClick:function(){return c.setState({selectedCharacterId:"",builds:[]})},children:"No Character"}),Object.values(e).map((function(t,e){return Object(n.jsx)(f.a.Item,{onClick:function(){return c.setState({selectedCharacterId:t.id,builds:[]})},children:t.name},t.name+e)}))]});return Object(n.jsxs)(m.a,{bg:"darkcontent",text:"lightfont",children:[Object(n.jsx)(m.a.Header,{children:"Build Generator"}),Object(n.jsxs)(m.a.Body,{children:[Object(n.jsxs)(O.a,{children:[Object(n.jsxs)(x.a,{xs:12,lg:6,className:"mb-2",children:[c.state.selectedCharacterId?Object(n.jsx)(R.a,{header:k,characterId:c.state.selectedCharacterId,bg:"lightcontent",footer:!1,cardClassName:"mb-2"}):Object(n.jsx)(m.a,{bg:"lightcontent",text:"lightfont",className:"mb-2",children:Object(n.jsx)(m.a.Header,{children:k})}),Object(n.jsxs)(m.a,{bg:"lightcontent",text:"lightfont",children:[Object(n.jsx)(m.a.Header,{children:"Artifact Main Stat (Optional)"}),Object(n.jsx)(m.a.Body,{children:a.artifactsSlotsToSelectMainStats.map((function(t,e){return Object(n.jsxs)("div",{className:"text-inline mb-1 d-flex justify-content-between",children:[Object(n.jsx)("h6",{className:"d-inline mr-2",children:U.a.getArtifactSlotNameWithIcon(t)}),Object(n.jsxs)(h.a,{title:c.state.mainStat[e]?X.a.getStatNameWithPercent(c.state.mainStat[e]):"Select a mainstat",className:"d-inline",children:[Object(n.jsx)(f.a.Item,{onClick:function(){return c.changeMainStat(e,"")},children:"No MainStat"}),q.d[t].stats.map((function(t){return Object(n.jsx)(f.a.Item,{onClick:function(){return c.changeMainStat(e,t)},children:X.a.getStatNameWithPercent(t)},t)}))]})]},t)}))})]})]}),Object(n.jsx)(x.a,{xs:12,lg:6,className:"mb-2",children:Object(n.jsx)(O.a,{children:c.state.setFilters.map((function(t,e){var a=t.key,i=t.num,s=c.state.artifactConditionals;return Object(n.jsx)(x.a,{className:"mb-2",xs:12,children:Object(n.jsxs)(m.a,{className:"h-100",bg:"lightcontent",text:"lightfont",children:[Object(n.jsx)(m.a.Header,{children:Object(n.jsxs)(g.a,{children:[Object(n.jsxs)(h.a,{as:g.a,title:U.a.getArtifactSetName(t.key,"Set (Optional)"),children:[Object(n.jsx)(f.a.Item,{onClick:function(){return c.changeSetFilterKey(e,"")},children:"Unselect Artifact"}),Object(n.jsx)(f.a.ItemText,{children:"Max Rarity \ud83d\udfca\ud83d\udfca\ud83d\udfca\ud83d\udfca\ud83d\udfca"}),c.dropdownitemsForStar(5,e),Object(n.jsx)(f.a.Divider,{}),Object(n.jsx)(f.a.ItemText,{children:"Max Rarity \ud83d\udfca\ud83d\udfca\ud83d\udfca\ud83d\udfca"}),c.dropdownitemsForStar(4,e),Object(n.jsx)(f.a.Divider,{}),Object(n.jsx)(f.a.ItemText,{children:"Max Rarity \ud83d\udfca\ud83d\udfca\ud83d\udfca"}),c.dropdownitemsForStar(3,e)]}),Object(n.jsx)(h.a,{as:g.a,title:"".concat(t.num,"-set"),disabled:!t.key||l>=5,children:t.key&&U.a.getArtifactSetEffectsObj(t.key)&&Object.keys(U.a.getArtifactSetEffectsObj(t.key)).map((function(a){var r=c.state.setFilters.reduce((function(e,a){return a.key&&a.key!==t.key?e+a.num:e}),0);return parseInt(a)+r<=5&&Object(n.jsx)(f.a.Item,{onClick:function(){return c.setState((function(t){var n=Object(Z.e)(t.setFilters);return n[e].num=parseInt(a),{setFilters:n}}))},children:"".concat(a,"-set")},a)}))})]})}),t.key?Object(n.jsx)(m.a.Body,{children:Object(n.jsx)(O.a,{children:Object.keys(U.a.getArtifactSets(a)).filter((function(t){return parseInt(t)<=i})).map((function(t){var e=U.a.getArtifactSetNumStats(a,t),i=0,l=U.a.getArtifactSetEffectConditional(a,t);if(l){i=Y.a.getConditionalNum(s,a,t);var o=U.a.getArtifactConditionalStats(a,t,i);o&&(e||(e={}),Object.entries(o).forEach((function(t){var a=Object(r.a)(t,2),n=a[0],i=a[1];return e[n]=(e[n]||0)+i})))}var d=Object(n.jsx)(V.a,{conditional:l,conditionalNum:i,setConditional:function(e){return c.setState((function(n){return{artifactConditionals:Y.a.setConditional(n.artifactConditionals,a,t,e)}}))},defEle:Object(n.jsxs)(v.a,{variant:"success",children:[t,"-Set"]})});return Object(n.jsxs)(x.a,{xs:12,className:"mb-2",children:[Object(n.jsxs)("h6",{children:[d," ",U.a.getArtifactSetEffectText(a,t)]}),e?Object(n.jsx)(O.a,{children:Object.entries(e).map((function(t){var e=Object(r.a)(t,2),a=e[0],i=e[1];return Object(n.jsxs)(x.a,{xs:12,children:[X.a.getStatName(a),": ",i,X.a.getStatUnit(a)]},a)}))}):null]},t)}))})}):null]})},e)}))})})]}),Object(n.jsx)(O.a,{className:"mb-2",children:Object(n.jsx)(x.a,{children:c.state.selectedCharacterId&&p})}),Object(n.jsxs)(O.a,{className:"d-flex justify-content-between",children:[Object(n.jsx)(x.a,{xs:"auto",children:Object(n.jsx)(y.a,{className:"h-100",disabled:!c.state.selectedCharacterId||S>c.state.maxBuildsToGenerate||c.state.generatingBuilds,variant:c.state.selectedCharacterId&&S<=c.state.maxBuildsToGenerate?"success":"danger",onClick:function(){return setTimeout((function(){c.generateBuilds(u,j)}),0)},children:Object(n.jsx)("span",{children:"Generate Builds"})})}),Object(n.jsx)(x.a,{xs:"auto",children:Object(n.jsxs)(g.a,{children:[Object(n.jsx)(h.a,{disabled:!c.state.selectedCharacterId,title:"Sort by ".concat(X.a.getStatNameWithPercent(c.state.buildFilterKey)),as:g.a,children:c.state.selectedCharacterId&&c.statsDisplayKeys().map((function(t){return"ele_dmg"!==t&&"ele_atk"!==t||(t="".concat(H.a.getElementalKey(i.characterKey),"_").concat(t)),Object(n.jsx)(f.a.Item,{onClick:function(){return c.setState({buildFilterKey:t})},children:X.a.getStatNameWithPercent(t)},t)}))}),Object(n.jsx)(y.a,{onClick:function(){return c.setState((function(t){return{asending:!t.asending}}))},children:Object(n.jsx)(d.a,{icon:c.state.asending?o.u:o.v,className:"fa-fw"})})]})})]})]})]})},c.ArtifactDisplayItem=function(t){var e=t.build,a=t.character;return Object(n.jsx)("div",{children:Object(n.jsxs)(P.Item,{variant:t.index%2?"customdark":"customdarker",className:"text-white",action:!0,onClick:function(){return c.setState({modalBuild:e})},children:[Object(n.jsx)(O.a,{children:Object(n.jsx)(x.a,{children:Object.entries(e.setToSlots).sort((function(t,e){var a=Object(r.a)(t,2),n=(a[0],a[1]),i=Object(r.a)(e,2);i[0];return i[1].length-n.length})).map((function(t){var e=Object(r.a)(t,2),a=e[0],i=e[1];return Object(n.jsxs)(v.a,{variant:"primary",className:"mr-2",children:[i.map((function(t){return U.a.getArtifactSlotIcon(t)}))," ",U.a.getArtifactSetName(a)]},a)}))})}),Object(n.jsx)(O.a,{children:c.statsDisplayKeys().map((function(t){var r;"ele_dmg"!==t&&"ele_atk"!==t||(t="".concat(H.a.getElementalKey(a.characterKey),"_").concat(t));var i=X.a.getStatUnit(t);return Object(n.jsx)(x.a,{className:"text-nowrap",xs:12,sm:6,md:4,lg:3,children:Object(n.jsxs)("span",{children:[X.a.getStatName(t),": ",Object(n.jsxs)("span",{className:"text-warning",children:[null===(r=e.finalStats[t])||void 0===r?void 0:r.toFixed(X.a.fixedUnit(t)),i]})]})},t)}))})]})})},c.BuildModal=function(t){var e=t.build,a=t.character;return e?Object(n.jsx)(_.a,{show:null!==c.state.modalBuild,onHide:function(){return c.setState({modalBuild:null})},size:"xl",dialogAs:D.a,className:"pt-3 pb-3",children:Object(n.jsx)(L.a,{characterToEdit:a,newBuild:e,onClose:function(){return c.setState({modalBuild:null})},forceUpdate:c.forceUpdateBuildDisplay})}):null},Object(Q.a)(),c.state=a.getInitialState(),t.location.selectedCharacterId)c.state=a.getInitialState(),t.location.selectedCharacterId&&(c.state.selectedCharacterId=t.location.selectedCharacterId);else{var s=Object(Z.i)("BuildsDisplay.state");if(s){var l=J.a.getCharacter(s.selectedCharacterId);s&&l&&(c.state=s)}}return G.a.pageview("/build"),c}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(){var t=Object(Z.e)(this.state);t.builds=[],delete t.generatingBuilds,delete t.modalBuild,Object(Z.j)("BuildsDisplay.state",t)}},{key:"render",value:function(){var t=this,e=J.a.getCharacter(this.state.selectedCharacterId),a=e?e.name:"Character Name";return Object(n.jsxs)(D.a,{children:[Object(n.jsx)(this.BuildModal,{build:this.state.modalBuild,character:e}),Object(n.jsx)(O.a,{className:"mt-2 mb-2",children:Object(n.jsx)(x.a,{children:Object(n.jsx)(this.BuildGeneratorEditorCard,{})})}),Object(n.jsx)(O.a,{className:"mb-2",children:Object(n.jsx)(x.a,{children:Object(n.jsxs)(m.a,{bg:"darkcontent",text:"lightfont",children:[Object(n.jsx)(m.a.Header,{children:this.state.selectedCharacterId?"Showing ".concat(this.state.builds.length," Builds generated for ").concat(a):"Select a character to generate builds."}),Object(n.jsx)(P,{children:this.state.builds.map((function(a,r){return r<t.state.maxBuildsToShow&&Object(n.jsx)(t.ArtifactDisplayItem,{build:a,character:e,index:r},Object.values(a.artifactIds).join("_"))}))})]})})})]})}}]),a}(j.a.Component);nt.initialState={builds:[],generatingBuilds:!1,selectedCharacterId:"",sandsMainKey:"",gobletMainKey:"",circletMainkey:"",setFilters:[{key:"",num:0},{key:"",num:0},{key:"",num:0}],artifactConditionals:[],mainStat:["","",""],buildFilterKey:"atk",asending:!1,modalBuild:null,maxBuildsToShow:100,maxBuildsToGenerate:5e5},nt.maxBuildsToShowList=[100,50,25,5],nt.maxBuildsToGenerateList=[5e4,1e4,5e3,1e3,500,100],nt.getInitialState=function(){return JSON.parse(JSON.stringify(nt.initialState))},nt.artifactsSlotsToSelectMainStats=["sands","goblet","circlet"]}}]);
//# sourceMappingURL=10.c5dd1977.chunk.js.map