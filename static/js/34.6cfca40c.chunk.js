"use strict";(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[34],{96034:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ze}});var s,a,r,o,i,c,l,d,x,u,h,j,p,g,Z=n(39504),f=n(20890),m=n(94721),b=n(10757),v=n(22020),y=n(76899),C=n(3992),w=n(29439),D=n(30168),I=n(53174),k=n(74223),S=n(80184),K=(0,k.Z)((0,S.jsx)("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),P=(0,k.Z)((0,S.jsx)("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload"),z=n(72456),M=(0,k.Z)((0,S.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),O=n(61889),G=n(24518),H=n(81918),W=n(52791),B=n(72791),V=n(71310),F=n(10600),N=n(82095),T=n(9321),_=n(38147),L=n(23741),R=n(24711),$=n(12761),E=n(60393),J=n(74165),A=n(15861),U=n(54483),Y=(0,k.Z)((0,S.jsx)("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H15v-8h5V8l-6-6zm-1 7V3.5L18.5 9H13zm4 12.66V16h5.66v2h-2.24l2.95 2.95-1.41 1.41L19 19.41v2.24h-2z"}),"FileOpen"),q=n(9912),Q=n(72247),X=n(66934),ee=n(68870),te=n(40165),ne=(0,X.ZP)("input")({display:"none"});function se(e){var t,n=e.onReplace,d=(0,B.useContext)(_.t).database,x=(0,v.$)("settings").t,u=(0,B.useState)(""),h=(0,w.Z)(u,2),j=h[0],p=h[1],g=(0,B.useState)(""),m=(0,w.Z)(g,2),b=m[0],k=m[1],K=(0,B.useState)(""),P=(0,w.Z)(K,2),z=P[0],M=P[1],H=(0,B.useState)(!1),W=(0,w.Z)(H,2),F=W[0],N=W[1],T=(0,B.useState)(!1),R=(0,w.Z)(T,2),$=R[0],E=R[1],X=null!==(t=(0,B.useMemo)((function(){if(j){var e;try{if("object"!==typeof(e=JSON.parse(j)))return void M("uploadCard.error.jsonParse")}catch(a){return void M("uploadCard.error.jsonParse")}if("GOOD"===e.format){var t=new L.NI;t.copyFrom(d.storage);var n=new _.M(t),s=n.importGOOD(e,F,$);return s?{importResult:s,importedDatabase:n}:void M("uploadCard.error.goInvalid")}M("uploadCard.error.unknown")}}),[j,d,F,$]))&&void 0!==t?t:{},se=X.importResult,re=X.importedDatabase,ie=function(){var e=(0,A.Z)((0,J.Z)().mark((function e(t){var n,s;return(0,J.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files[0],t.target.value=null,n&&k(n.name),(s=new FileReader).onload=function(){return p(s.result)},s.readAsText(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,S.jsxs)(V.Z,{children:[(0,S.jsx)(Z.Z,{sx:{py:1},children:(0,S.jsx)(y.c,{t:x,i18nKey:"settings:uploadCard.title"})}),(0,S.jsxs)(Z.Z,{children:[(0,S.jsxs)(O.ZP,{container:!0,spacing:2,sx:{mb:1},children:[(0,S.jsx)(O.ZP,{item:!0,children:(0,S.jsxs)("label",{htmlFor:"icon-button-file",children:[(0,S.jsx)(ne,{accept:".json",id:"icon-button-file",type:"file",onChange:ie}),(0,S.jsx)(G.Z,{component:"span",color:"info",startIcon:(0,S.jsx)(Y,{}),children:x(s||(s=(0,D.Z)(["uploadCard.buttons.open"])))})]})}),(0,S.jsx)(O.ZP,{item:!0,flexGrow:1,children:(0,S.jsx)(C.Z,{sx:{px:2,py:1},children:(0,S.jsx)(f.Z,{children:b?(0,S.jsxs)("span",{children:[(0,S.jsx)(U.G,{icon:I.w49})," ",b]}):(0,S.jsxs)("span",{children:[(0,S.jsx)(U.G,{icon:I.acZ})," ",(0,S.jsx)(y.c,{t:x,i18nKey:"settings:uploadCard.hint"})]})})})})]}),(0,S.jsxs)(ee.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,S.jsx)(te.Z,{title:(0,S.jsx)(f.Z,{children:x($?a||(a=(0,D.Z)(["uploadCard.tooltip.ignoreDup"])):r||(r=(0,D.Z)(["uploadCard.tooltip.detectdup"])))}),placement:"top",arrow:!0,children:(0,S.jsx)(ee.Z,{sx:{flexGrow:1,flexBasis:"10em"},children:(0,S.jsx)(G.Z,{fullWidth:!0,disabled:!j,color:$?"primary":"success",onClick:function(){return E(!$)},startIcon:$?(0,S.jsx)(q.Z,{}):(0,S.jsx)(Q.Z,{}),children:x(o||(o=(0,D.Z)(["uploadCard.buttons.detectDups"])))})})}),(0,S.jsx)(te.Z,{title:(0,S.jsx)(f.Z,{children:x(F?i||(i=(0,D.Z)(["uploadCard.tooltip.keepNotInImport"])):c||(c=(0,D.Z)(["uploadCard.tooltip.delNotInImport"])))}),placement:"top",arrow:!0,children:(0,S.jsx)(ee.Z,{sx:{flexGrow:1,flexBasis:"10em"},children:(0,S.jsx)(G.Z,{fullWidth:!0,disabled:!j,color:F?"primary":"success",onClick:function(){return N(!F)},startIcon:F?(0,S.jsx)(q.Z,{}):(0,S.jsx)(Q.Z,{}),children:x(l||(l=(0,D.Z)(["uploadCard.buttons.delNotInImport"])))})})})]}),(0,S.jsx)(f.Z,{gutterBottom:!0,variant:"caption",children:(0,S.jsx)(y.c,{t:x,i18nKey:"settings:uploadCard.hintPaste"})}),(0,S.jsx)(ee.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",mb:2,resize:"vertical"},value:j,onChange:function(e){return p(e.target.value)}}),se&&re?(0,S.jsx)(ae,{importResult:se,importedDatabase:re}):x(z)]}),(0,S.jsx)(oe,{importedDatabase:re,reset:function(){p(""),k(""),n()}})]})}function ae(e){var t=e.importResult,n=t.source,s=t.artifacts,a=t.characters,r=t.weapons,o=e.importedDatabase,i=(0,v.$)("settings").t;return(0,S.jsxs)(C.Z,{children:[(0,S.jsx)(Z.Z,{sx:{py:1},children:(0,S.jsxs)(f.Z,{children:[(0,S.jsx)(y.c,{t:i,i18nKey:"uploadCard.dbSource"}),(0,S.jsxs)("strong",{children:[" ",n]})]})}),(0,S.jsx)(m.Z,{}),(0,S.jsx)(Z.Z,{children:(0,S.jsxs)(O.ZP,{container:!0,spacing:2,children:[(0,S.jsx)(O.ZP,{item:!0,flexGrow:1,children:(0,S.jsx)(re,{result:s,dbTotal:o.arts.values.length,type:"arts"})}),(0,S.jsx)(O.ZP,{item:!0,flexGrow:1,children:(0,S.jsx)(re,{result:r,dbTotal:o.weapons.values.length,type:"weapons"})}),(0,S.jsx)(O.ZP,{item:!0,flexGrow:1,children:(0,S.jsx)(re,{result:a,dbTotal:o.chars.values.length,type:"chars"})})]})})]})}function re(e){var t,n=e.result,s=e.dbTotal,a=e.type,r=(0,v.$)("settings").t,o=n.import;return(0,S.jsxs)(V.Z,{children:[(0,S.jsx)(Z.Z,{sx:{py:1},children:(0,S.jsxs)(f.Z,{children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.".concat(a)})," ",o]})}),(0,S.jsx)(m.Z,{}),(0,S.jsxs)(Z.Z,{children:[(0,S.jsxs)(f.Z,{children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.new"})," ",(0,S.jsx)("strong",{children:n.new.length})," / ",o]}),(0,S.jsxs)(f.Z,{children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.unchanged"})," ",(0,S.jsx)("strong",{children:n.unchanged.length})," / ",o]}),(0,S.jsxs)(f.Z,{children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.upgraded"})," ",(0,S.jsx)("strong",{children:n.upgraded.length})," / ",o]}),!!n.remove.length&&(0,S.jsxs)(f.Z,{color:"warning.main",children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.removed"})," ",(0,S.jsx)("strong",{children:n.remove.length})]}),!!n.notInImport&&(0,S.jsxs)(f.Z,{children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.notInImport"})," ",(0,S.jsx)("strong",{children:n.notInImport})]}),(0,S.jsxs)(f.Z,{children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.dbTotal"})," ",(0,S.jsx)("strong",{children:n.beforeMerge})," -> ",(0,S.jsx)("strong",{children:s})]}),!(null===(t=n.invalid)||void 0===t||!t.length)&&(0,S.jsxs)("div",{children:[(0,S.jsxs)(f.Z,{color:"error.main",children:[(0,S.jsx)(y.c,{t:r,i18nKey:"count.invalid"})," ",(0,S.jsx)("strong",{children:n.invalid.length})," / ",o]}),(0,S.jsx)(ee.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",resize:"vertical"},value:JSON.stringify(n.invalid,void 0,2),disabled:!0})]})]})]})}function oe(e){var t=e.importedDatabase,n=e.reset,s=(0,B.useContext)(_.t),a=s.database,r=s.setDatabase,o=(0,v.$)("settings").t,i=(0,B.useCallback)((function(){t&&(a.clear(),a.storage.copyFrom(t.storage),r(new _.M(a.storage)),n())}),[a,t,n,r]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(m.Z,{}),(0,S.jsx)(Z.Z,{sx:{py:1},children:(0,S.jsx)(G.Z,{color:t?"success":"error",disabled:!t,onClick:i,startIcon:(0,S.jsx)(U.G,{icon:I.Y9i}),children:(0,S.jsx)(y.c,{t:o,i18nKey:"settings:uploadCard.replaceDatabase"})})})]})}function ie(){var e=(0,B.useContext)(_.t),t=parseInt(e.database.storage.getString("dbIndex")||"1"),n=(0,v.$)(["settings"]).t;return(0,S.jsxs)(V.Z,{children:[(0,S.jsx)(Z.Z,{sx:{py:1},children:(0,S.jsx)(f.Z,{variant:"subtitle1",children:n(d||(d=(0,D.Z)(["DatabaseCard.title"])))})}),(0,S.jsx)(m.Z,{}),(0,S.jsx)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,S.jsx)(O.ZP,{container:!0,spacing:2,columns:{xs:1,md:2},children:(0,E.w6)(1,4).map((function(n){return(0,S.jsx)(O.ZP,{item:!0,xs:1,children:n===t?(0,S.jsx)(le,{index:n}):(0,S.jsx)(ce,{index:n,children:(0,S.jsx)(le,{index:n,databaseContextObj:e})})},n)}))})})]})}function ce(e){var t=e.index,n=e.children,s=(0,B.useState)((function(){var e,n="extraDatabase_".concat(t),s=new L.Bc(n),a=JSON.parse(null!==(e=localStorage.getItem(n))&&void 0!==e?e:'{ "dbIndex": "'.concat(t,'" }'));s.setStorage(a),s.removeForKeys((function(e){return e.startsWith("extraDatabase_")}));var r=new _.M(s);return s.saveStorage(),r})),a=(0,w.Z)(s,2),r=a[0],o=a[1];return(0,S.jsx)(_.t.Provider,{value:{database:r,setDatabase:o},children:n})}function le(e){var t=e.index,n=e.databaseContextObj,s=(0,B.useContext)(_.t),a=s.database,r=s.setDatabase,o=(0,$.Z)(),i=o.name,c=o.lastEdit,l=!n,d=(0,R.Z)(),b=(0,w.Z)(d,3),k=b[0],V=b[1],E=b[2],J=(0,v.$)(["settings"]).t,A=a.chars.keys.length,U=a.arts.values.length,Y=a.weapons.values.length,q=Boolean(A||U||Y),Q=(0,B.useCallback)((function(){return navigator.clipboard.writeText(JSON.stringify(a.exportGOOD())).then((function(){return alert("Copied database to clipboard.")})).catch(console.error)}),[a]),X=(0,B.useCallback)((function(){(E(),l)||a.storage.saveStorage()}),[E,l,a.storage]),ee=(0,B.useCallback)((function(){if(window.confirm('Are you sure you want to delete "'.concat(i,'"?')))if(l)a.clear(),r(new _.M(a.storage));else{var e=a.storage.databaseName,t=new L.Bc(e);t.setStorage({}),r(new _.M(t)),localStorage.removeItem(e)}}),[a,l,i,r]),te=(0,B.useCallback)((function(){var e=(new Date).toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),t=JSON.stringify(a.exportGOOD()),n="".concat(i.trim().replaceAll(" ","_"),"_").concat(e,".json"),s=document.createElement("a");s.download=n,s.href="data:".concat("application/json;charset=utf-8",",").concat(encodeURIComponent(t)),s.target="_blank",document.body.appendChild(s),s.click(),document.body.removeChild(s)}),[a,i]),ne=(0,B.useCallback)((function(){if(n){var e=parseInt(n.database.storage.getString("dbIndex")||"1"),s=new L.Bc("extraDatabase_".concat(e),n.database.storage);s.removeForKeys((function(e){return e.startsWith("extraDatabase_")})),s.saveStorage();var r=a.storage.databaseName;localStorage.removeItem(r),n.database.clear(),n.database.storage.copyFrom(a.storage),n.database.storage.set("dbIndex",t),n.setDatabase(new _.M(n.database.storage))}}),[n,a,t]),ae=(0,B.useState)(i),re=(0,w.Z)(ae,2),oe=re[0],ie=re[1];(0,B.useEffect)((function(){return ie(i)}),[i]);var ce=(0,B.useCallback)((function(){a.dbMeta.set({name:oe}),!l&&"saveStorage"in a.storage&&a.storage.saveStorage()}),[oe,a,l]),le=(0,B.useCallback)((function(e){return"Enter"===e.key&&ce()}),[ce]);return(0,S.jsxs)(C.Z,{sx:{height:"100%",boxShadow:l?"0px 0px 0px 2px green inset":void 0},children:[(0,S.jsxs)(Z.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,S.jsx)(F.el,{value:oe,sx:{borderRadius:1,px:1,flexGrow:1},onChange:function(e){return ie(e.target.value)},onBlur:ce,onKeyDown:le}),!l&&(0,S.jsx)(G.Z,{startIcon:(0,S.jsx)(K,{}),onClick:ne,color:"warning",children:J(x||(x=(0,D.Z)(["DatabaseCard.button.swap"])))}),(0,S.jsx)(H.Z,{color:l?"success":"secondary",label:l?J(u||(u=(0,D.Z)(["DatabaseCard.currentDB"]))):"".concat(J(h||(h=(0,D.Z)(["DatabaseCard.title"])))," ").concat(t)})]}),(0,S.jsx)(m.Z,{}),(0,S.jsx)(Z.Z,{children:(0,S.jsxs)(W.Z,{display:"flex",gap:2,children:[(0,S.jsxs)(W.Z,{flexGrow:1,children:[(0,S.jsxs)(f.Z,{noWrap:!0,children:[(0,S.jsx)(y.c,{t:J,i18nKey:"count.chars"})," ",(0,S.jsx)("strong",{children:A})]}),(0,S.jsxs)(f.Z,{noWrap:!0,children:[(0,S.jsx)(y.c,{t:J,i18nKey:"count.arts"})," ",(0,S.jsx)("strong",{children:U})]}),(0,S.jsxs)(f.Z,{noWrap:!0,children:[(0,S.jsx)(y.c,{t:J,i18nKey:"count.weapons"})," ",(0,S.jsx)("strong",{children:Y})]}),!!c&&(0,S.jsx)(f.Z,{noWrap:!0,children:(0,S.jsx)("strong",{children:new Date(c).toLocaleString()})})]}),(0,S.jsx)(W.Z,{children:(0,S.jsxs)(O.ZP,{container:!0,spacing:1,columns:{xs:2},children:[(0,S.jsx)(O.ZP,{item:!0,xs:1,children:(0,S.jsx)(G.Z,{fullWidth:!0,disabled:!q,color:"info",onClick:Q,startIcon:(0,S.jsx)(N.Z,{icon:I.Yjj}),children:(0,S.jsx)(y.c,{t:J,i18nKey:"DatabaseCard.button.copy"})})}),(0,S.jsxs)(O.ZP,{item:!0,xs:1,children:[(0,S.jsx)(T.Z,{open:k,onClose:E,children:(0,S.jsx)(se,{onReplace:X})}),(0,S.jsx)(G.Z,{fullWidth:!0,component:"span",color:"info",startIcon:(0,S.jsx)(P,{}),onClick:V,children:J(j||(j=(0,D.Z)(["DatabaseCard.button.upload"])))})]}),(0,S.jsx)(O.ZP,{item:!0,xs:1,children:(0,S.jsx)(G.Z,{fullWidth:!0,disabled:!q,onClick:te,startIcon:(0,S.jsx)(z.Z,{}),children:J(p||(p=(0,D.Z)(["DatabaseCard.button.download"])))})}),(0,S.jsx)(O.ZP,{item:!0,xs:1,children:(0,S.jsx)(G.Z,{fullWidth:!0,disabled:!q,color:"error",onClick:ee,startIcon:(0,S.jsx)(M,{}),children:J(g||(g=(0,D.Z)(["DatabaseCard.button.delete"])))})})]})})]})})]})}var de=n(23786),xe=n(33890),ue=n(25617),he=n(72828);function je(){var e=(0,v.$)().t;return(0,S.jsxs)(V.Z,{children:[(0,S.jsxs)(Z.Z,{sx:{py:1},children:[e("settings:languageCard.selectLanguage")," ",(0,S.jsx)(ue.Z,{color:"warning",children:e("ui:underConstruction")})]}),(0,S.jsx)(m.Z,{}),(0,S.jsx)(Z.Z,{children:(0,S.jsx)(ge,{})})]})}var pe={chs:"\u7b80\u4f53\u4e2d\u6587",cht:"\u7e41\u9ad4\u4e2d\u6587",de:"Deutsch",en:"English",es:"espa\xf1ol",fr:"fran\xe7ais",id:"Bahasa Indonesia",ja:"\u65e5\u672c\u8a9e",ko:"\ud55c\uad6d\uc5b4",pt:"Portugu\xeas",ru:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a",th:"\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22",vi:"Ti\u1ebfng Vi\u1ec7t"};function ge(){var e=(0,v.$)(["ui","settings"]),t=e.t,n=e.i18n,s=function(e){return function(){return n.changeLanguage(e)}},a=n.languages[0];return(0,S.jsx)(xe.Z,{fullWidth:!0,title:t("settings:languageCard.languageFormat",{language:t("languages:".concat(a))}),children:he.C.map((function(e){return(0,S.jsxs)(de.Z,{selected:a===e,disabled:a===e,onClick:s(e),children:[(0,S.jsx)(y.c,{i18nKey:"languages:".concat(e)}),e!==a?" (".concat(pe[e],")"):""]},e)}))})}function Ze(){var e=(0,v.$)(["settings"]).t;return b.ZP.send({hitType:"pageview",page:"/setting"}),(0,S.jsxs)(C.Z,{sx:{my:1},children:[(0,S.jsx)(Z.Z,{sx:{py:1},children:(0,S.jsx)(f.Z,{variant:"subtitle1",children:(0,S.jsx)(y.c,{t:e,i18nKey:"title"})})}),(0,S.jsx)(m.Z,{}),(0,S.jsxs)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,S.jsx)(je,{}),(0,S.jsx)(ie,{})]})]})}},72247:function(e,t,n){var s=n(74223),a=n(80184);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox")},9912:function(e,t,n){var s=n(74223),a=n(80184);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank")},72456:function(e,t,n){var s=n(74223),a=n(80184);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download")}}]);
//# sourceMappingURL=34.6cfca40c.chunk.js.map